Script started on 2024-10-23 15:50:09+03:00 [TERM="xterm-256color" TTY="/dev/pts/0" COLUMNS="204" LINES="55"]
[?2004h]0;rsshabanov@MSK-01: ~/codeby-devops/exam/src[01;32mrsshabanov@MSK-01[00m:[01;34m~/codeby-devops/exam/src[00m$ htopsudo apt-get install htophtop[K[Kdf -h
[?2004lFilesystem                         Size  Used Avail Use% Mounted on
tmpfs                              593M  2.2M  590M   1% /run
/dev/mapper/ubuntu--vg-ubuntu--lv  121G   40G   77G  34% /
tmpfs                              2.9G     0  2.9G   0% /dev/shm
tmpfs                              5.0M  4.0K  5.0M   1% /run/lock
tmpfs                              2.9G     0  2.9G   0% /run/qemu
/dev/sda2                          2.0G  323M  1.5G  18% /boot
ubuntu                             477G  338G  139G  71% /media/sf_ubuntu
tmpfs                              1.0M     0  1.0M   0% /var/snap/lxd/common/ns
tmpfs                              593M  136K  592M   1% /run/user/1000
/dev/sr0                            52M   52M     0 100% /media/rsshabanov/VBox_GAs_7.0.20
[?2004h]0;rsshabanov@MSK-01: ~/codeby-devops/exam/src[01;32mrsshabanov@MSK-01[00m:[01;34m~/codeby-devops/exam/src[00m$ unmount [7m/media/rsshabanov/VBox_GAs_7.0.20[27m/media/rsshabanov/VBox_GAs_7.0.20
[?2004lbash: unmount: command not found
[?2004h]0;rsshabanov@MSK-01: ~/codeby-devops/exam/src[01;32mrsshabanov@MSK-01[00m:[01;34m~/codeby-devops/exam/src[00m$ umount [7m/media/rsshabanov/VBox_GAs_7.0.20[27m/media/rsshabanov/VBox_GAs_7.0.20
[?2004l[?2004h]0;rsshabanov@MSK-01: ~/codeby-devops/exam/src[01;32mrsshabanov@MSK-01[00m:[01;34m~/codeby-devops/exam/src[00m$ df -g
[?2004ldf: invalid option -- 'g'
Try 'df --help' for more information.
[?2004h]0;rsshabanov@MSK-01: ~/codeby-devops/exam/src[01;32mrsshabanov@MSK-01[00m:[01;34m~/codeby-devops/exam/src[00m$ df -h
[?2004lFilesystem                         Size  Used Avail Use% Mounted on
tmpfs                              593M  1.9M  591M   1% /run
/dev/mapper/ubuntu--vg-ubuntu--lv  121G   40G   77G  34% /
tmpfs                              2.9G     0  2.9G   0% /dev/shm
tmpfs                              5.0M  4.0K  5.0M   1% /run/lock
tmpfs                              2.9G     0  2.9G   0% /run/qemu
/dev/sda2                          2.0G  323M  1.5G  18% /boot
ubuntu                             477G  338G  139G  71% /media/sf_ubuntu
tmpfs                              1.0M     0  1.0M   0% /var/snap/lxd/common/ns
tmpfs                              593M  136K  592M   1% /run/user/1000
[?2004h]0;rsshabanov@MSK-01: ~/codeby-devops/exam/src[01;32mrsshabanov@MSK-01[00m:[01;34m~/codeby-devops/exam/src[00m$ [7mpython3 -m venv ansible-venv[27m
[7msource ansible-venv/bin/activate[27m
[7mpip install ansible[27m
[7mansible-galaxy collection install kubernetes.core[27m[A[A[Apython3 -m venv ansible-venv
source ansible-venv/bin/activate
pip install ansible
ansible-galaxy collection install kubernetes.core
[?2004lThe virtual environment was not created successfully because ensurepip is not
available.  On Debian/Ubuntu systems, you need to install the python3-venv
package using the following command.

    apt install python3.10-venv

You may need to use sudo with that command.  After installing the python3-venv
package, recreate your virtual environment.

Failing command: /home/rsshabanov/codeby-devops/exam/src/ansible-venv/bin/python3

bash: ansible-venv/bin/activate: No such file or directory
Defaulting to user installation because normal site-packages is not writeable
Requirement already satisfied: ansible in /home/rsshabanov/.local/lib/python3.10/site-packages (10.5.0)
Requirement already satisfied: ansible-core~=2.17.5 in /home/rsshabanov/.local/lib/python3.10/site-packages (from ansible) (2.17.5)
Requirement already satisfied: resolvelib<1.1.0,>=0.5.3 in /home/rsshabanov/.local/lib/python3.10/site-packages (from ansible-core~=2.17.5->ansible) (1.0.1)
Requirement already satisfied: jinja2>=3.0.0 in /usr/lib/python3/dist-packages (from ansible-core~=2.17.5->ansible) (3.0.3)
Requirement already satisfied: packaging in /usr/lib/python3/dist-packages (from ansible-core~=2.17.5->ansible) (21.3)
Requirement already satisfied: cryptography in /usr/lib/python3/dist-packages (from ansible-core~=2.17.5->ansible) (3.4.8)
Requirement already satisfied: PyYAML>=5.1 in /usr/lib/python3/dist-packages (from ansible-core~=2.17.5->ansible) (5.4.1)
Starting galaxy collection install process
Nothing to do. All requested collections are already installed. If you want to reinstall them, consider using `--force`.
[?2004h]0;rsshabanov@MSK-01: ~/codeby-devops/exam/src[01;32mrsshabanov@MSK-01[00m:[01;34m~/codeby-devops/exam/src[00m$ 
[?2004l[?2004h]0;rsshabanov@MSK-01: ~/codeby-devops/exam/src[01;32mrsshabanov@MSK-01[00m:[01;34m~/codeby-devops/exam/src[00m$ 
[?2004l[?2004h]0;rsshabanov@MSK-01: ~/codeby-devops/exam/src[01;32mrsshabanov@MSK-01[00m:[01;34m~/codeby-devops/exam/src[00m$ 
[?2004l[?2004h]0;rsshabanov@MSK-01: ~/codeby-devops/exam/src[01;32mrsshabanov@MSK-01[00m:[01;34m~/codeby-devops/exam/src[00m$ cat Jenkinsfile 
[?2004lpipeline {
    agent any

    environment {
        appVersion = readFile('exam/src/VERSION').trim()
    }

    stages {
        stage('Checkout') {
            steps {
                git branch: 'exam', url: 'https://github.com/Roma-uuu/codeby-devops.git'
            }
        }
        stage('Build') {
            steps {
                dir('exam/src') {
                    sh 'mvn clean package -Dcheckstyle.skip=true'
                }
            }
        }
        stage('Test Docker Access') {
            steps {
                sh 'docker info'
            }
        }
        stage('Build and Push Docker Image') {
            steps {
                dir('exam/src') {
                    script {
                        echo "Building Docker image with tag: ${appVersion}"
                        withCredentials([usernamePassword(credentialsId: 'dockerhub-credentials', usernameVariable: 'DOCKERHUB_USERNAME', passwordVariable: 'DOCKERHUB_TOKEN')]) {
                            sh """
                            echo $DOCKERHUB_TOKEN | docker login -u $DOCKERHUB_USERNAME --password-stdin
                            docker build -t apkerigz/devops:${appVersion} .
                            docker push apkerigz/devops:${appVersion}
                            """
                        }
                    }
                }
            }
        }
        stage('Deploy using Helm') {
            steps {
                withCredentials([string(credentialsId: 'k8s-sa-token', variable: 'K8S_TOKEN')]) {
                    dir('exam/src/mychart') {
                        script {
                            echo "Deploying Helm chart with image tag: ${appVersion}"
                            sh """
                            helm upgrade --install petclinic-app . \
                                --set image.repository=apkerigz/devops \
                                --set image.tag=${appVersion} \
                                --kube-token=$K8S_TOKEN
                            """
                        }
                    }
                }
            }
        }
        stage('Run Ansible Playbook') {
            steps {
                dir('exam/src') {
                    script {
                        // Ð”Ð¾Ð±Ð°Ð²Ð»ÑÐµÐ¼ ÑƒÑÑ‚Ð°Ð½Ð¾Ð²ÐºÑƒ ÐºÐ¾Ð»Ð»ÐµÐºÑ†Ð¸Ð¸ Ð¿ÐµÑ€ÐµÐ´ Ð·Ð°Ð¿ÑƒÑÐºÐ¾Ð¼ Ð¿Ð»ÐµÐ¹Ð±ÑƒÐºÐ°
                        sh 'ansible-galaxy collection install kubernetes.core'
                        // Ð—Ð°Ð¿ÑƒÑÐº ÑÐ°Ð¼Ð¾Ð³Ð¾ Ð¿Ð»ÐµÐ¹Ð±ÑƒÐºÐ°
                        sh 'ansible-playbook -i inventory monitoring_playbook.yml --ask-become-pass'
                    }
                }
            }
        }
    }
}
[?2004h]0;rsshabanov@MSK-01: ~/codeby-devops/exam/src[01;32mrsshabanov@MSK-01[00m:[01;34m~/codeby-devops/exam/src[00m$ [7mansible-config dump | grep COLLECTIONS_PATHS[27m
[A[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[Cansible-config dump | grep COLLECTIONS_PATHS
[A
[?2004l[01;31m[KCOLLECTIONS_PATHS[m[K(default) = ['/home/rsshabanov/.ansible/collections', '/usr/share/ansible/collections']
[?2004h]0;rsshabanov@MSK-01: ~/codeby-devops/exam/src[01;32mrsshabanov@MSK-01[00m:[01;34m~/codeby-devops/exam/src[00m$ ls -la [7mrsshabanov@MSK-01:~/codeby-devops/exam/src$ ansible-config dump | grep COLLECTIONS_PATHS[27m
[7mCOLLECTIONS_PATHS(default) = ['/home/rsshabanov/.ansible/collections', '/usr/share/ansible/collections'][27m
[A[A[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[Crsshabanov@MSK-01:~/codeby-devops/exam/src$ ansible-config dump | grep COLLECTIONS_PATHS
COLLECTIONS_PATHS(default) = ['/home/rsshabanov/.ansible/collections', '/usr/share/ansible/collections']
[A[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[1P[1P[1P[1P[1P[1P[1P[1P[1P[1P[1P[1P[1P[1P[1P[1P[1P[1P[1P[1P[1P[1P[1P[1P[1P[1P[1P[1P[1P[1P[1P[A[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C/home/rsshabanov/.ansible/collections', '/usr/share/ansible/collections']                                                                 [A[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C/home/rsshabanov/.ansible/collections', '/usr/share/ansible/collect[1Pions'][A]0;rsshabanov@MSK-01: ~/codeby-devops/exam/src[01;32mrsshabanov@MSK-01[00m:[01;34m~/codeby-devops/exam/src[00m$ [C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C/home/rsshabanov/.ansible/collections', '/usr/share/ansible/collecti[1Pons'][A]0;rsshabanov@MSK-01: ~/codeby-devops/exam/src[01;32mrsshabanov@MSK-01[00m:[01;34m~/codeby-devops/exam/src[00m$ [C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C/home/rsshabanov/.ansible/collections', '/usr/share/ansible/collectio[1Pns'][A]0;rsshabanov@MSK-01: ~/codeby-devops/exam/src[01;32mrsshabanov@MSK-01[00m:[01;34m~/codeby-devops/exam/src[00m$ [C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C/home/rsshabanov/.ansible/collections', '/usr/share/ansible/collection[1Ps'][A]0;rsshabanov@MSK-01: ~/codeby-devops/exam/src[01;32mrsshabanov@MSK-01[00m:[01;34m~/codeby-devops/exam/src[00m$ [C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C/home/rsshabanov/.ansible/collections', '/usr/share/ansible/collections[1P'][A]0;rsshabanov@MSK-01: ~/codeby-devops/exam/src[01;32mrsshabanov@MSK-01[00m:[01;34m~/codeby-devops/exam/src[00m$ [C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C/home/rsshabanov/.ansible/collections', '/usr/share/ansible/collections'[1P][A]0;rsshabanov@MSK-01: ~/codeby-devops/exam/src[01;32mrsshabanov@MSK-01[00m:[01;34m~/codeby-devops/exam/src[00m$ [C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C/home/rsshabanov/.ansible/collections', '/usr/share/ansible/collections'] [A]0;rsshabanov@MSK-01: ~/codeby-devops/exam/src[01;32mrsshabanov@MSK-01[00m:[01;34m~/codeby-devops/exam/src[00m$ [C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C/home/rsshabanov/.ansible/collections', '/usr/share/ansible/collections']  [A]0;rsshabanov@MSK-01: ~/codeby-devops/exam/src[01;32mrsshabanov@MSK-01[00m:[01;34m~/codeby-devops/exam/src[00m$ [C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[1P

[K[A[A[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[1P[1P[1P[1P[1P[1P[1P[1P[1P[1P[1P[1P[1P[1P[1P[1P[1P[1P[1P[1P[1P[1P[1P[1P[1P[1P[1P[1P[1P[1P[1P[1P[1P[1P[1P[1P[1P[1P[1P[1P[1P[1P[1P[1P[1P[1P[1P[1P[1P[1P[1P[1P[1P[1P[1P[1P[1P[1P[1P[1P[1P[1P[1P[1P[1P[1P[1P[1P[1P[1P[1P[1P[1P[1P[1P[1P[1P[1P[1P[1P[1P[1P[1P[1P[1P[1P[1@l[1@s[1@ [1@-[1@l[1@a[1@ [C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[1P[1P '/usr/share/ansible/collections'][1P'/usr/share/ansible/collections'][1P/usr/share/ansible/collections'][1Pusr/share/ansible/collections'][1Psr/share/ansible/collections'][1Pr/share/ansible/collections'][1P/share/ansible/collections'][1Pshare/ansible/collections'][1Phare/ansible/collections'][1Pare/ansible/collections'][1Pre/ansible/collections'][1Pe/ansible/collections'][1P/ansible/collections'][1Pansible/collections'][1Pnsible/collections'][1Psible/collections'][1Pible/collections'][1Pble/collections'][1Ple/collections'][1Pe/collections'][1P/collections'][1Pcollections'][1Pollections'][1Pllections'][C[1Pections'][1Pections'][1Pctions'][1Ptions'][1Pions'][1Pons'][1Pns'][1Ps'][1P'][1P] 
[K[A[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C
[?2004ltotal 12
drwxrwxr-x 3 rsshabanov rsshabanov 4096 Oct 21 19:28 [0m[01;34m.[0m
drwxrwxr-x 6 rsshabanov rsshabanov 4096 Oct 22 12:33 [01;34m..[0m
drwxrwxr-x 4 rsshabanov rsshabanov 4096 Oct 22 12:33 [01;34mansible_collections[0m
[?2004h]0;rsshabanov@MSK-01: ~/codeby-devops/exam/src[01;32mrsshabanov@MSK-01[00m:[01;34m~/codeby-devops/exam/src[00m$ ls -la /home/rsshabanov/.ansible/collections/ansible_collections/
[?2004ltotal 16
drwxrwxr-x 4 rsshabanov rsshabanov 4096 Oct 22 12:33 [0m[01;34m.[0m
drwxrwxr-x 3 rsshabanov rsshabanov 4096 Oct 21 19:28 [01;34m..[0m
drwxrwxr-x 3 rsshabanov rsshabanov 4096 Oct 22 12:33 [01;34mkubernetes[0m
drwxr-xr-x 2 rsshabanov rsshabanov 4096 Oct 22 12:33 [01;34mkubernetes.core-5.0.0.info[0m
[?2004h]0;rsshabanov@MSK-01: ~/codeby-devops/exam/src[01;32mrsshabanov@MSK-01[00m:[01;34m~/codeby-devops/exam/src[00m$ sudo nano ansible.cfg
[?2004l[sudo] password for rsshabanov: 
[?2004h[?1049h[22;0;0t[1;55r(B[m[4l[?7h[39;49m[?1h=[?1h=[?25l[39;49m(B[m[H[2J[53;97H(B[0;7m[ New File ](B[m[H(B[0;7m  GNU nano 6.2                                                                                     ansible.cfg                                                                                              [1;203H(B[m[54d(B[0;7m^G(B[m Help[54;18H(B[0;7m^O(B[m Write Out     (B[0;7m^W(B[m Where Is[52G(B[0;7m^K(B[m Cut[54;69H(B[0;7m^T(B[m Execute[86G(B[0;7m^C(B[m Location[103G(B[0;7mM-U(B[m Undo[54;120H(B[0;7mM-A(B[m Set Mark     (B[0;7mM-](B[m To Bracket   (B[0;7mM-Q(B[m Previous     (B[0;7m^B(B[m Back[54;188H(B[0;7m^â—‚(B[m Prev Word[55d(B[0;7m^X(B[m Exit[55;18H(B[0;7m^R(B[m Read File     (B[0;7m^\(B[m Replace[52G(B[0;7m^U(B[m Paste[55;69H(B[0;7m^J(B[m Justify[86G(B[0;7m^/(B[m Go To Line    (B[0;7mM-E(B[m Redo[55;120H(B[0;7mM-6(B[m Copy[55;137H(B[0;7m^Q(B[m Where Was     (B[0;7mM-W(B[m Next[55;171H(B[0;7m^F(B[m Forward[188G(B[0;7m^â–¸(B[m Next Word[2d[?12l[?25h[?25l[1;112H(B[0;7m*[53d(B[m[K[1;203H[2d(B[0;1m[32m[defaults][3d[39m(B[mcollections_paths = /home/rsshabanov/.ansible/collections:/usr/share/ansible/collections[4d[?12l[?25h[?25l[?12l[?25h[3;89H[?25l[53d(B[0;7mSave modified buffer?                                                                                                                                                                                       [54;1H Y(B[m Yes[K[55d(B[0;7m N(B[m No  [55;17H(B[0;7m^C(B[m Cancel[K[53;23H[?12l[?25h[?25l[54d(B[0;7m^G(B[m Help[54;52H(B[0;7mM-D(B[m DOS Format[54;103H(B[0;7mM-A(B[m Append[54;154H(B[0;7mM-B(B[m Backup File[55d(B[0;7m^C(B[m Cancel[17G         [55;52H(B[0;7mM-M(B[m Mac Format[55;103H(B[0;7mM-P(B[m Prepend[55;154H(B[0;7m^T(B[m Browse[53d(B[0;7mFile Name to Write: ansible.cfg(B[m[?12l[?25h[?25l[53;95H[1K (B[0;7m[ Writing... ](B[m[K[1;112H(B[0;7m [203G(B[m[53;94H(B[0;7m[ Wrote 2 lines ](B[m[J[55d[?12l[?25h[55;1H[?1049l[23;0;0t[?1l>[?2004l[?2004h]0;rsshabanov@MSK-01: ~/codeby-devops/exam/src[01;32mrsshabanov@MSK-01[00m:[01;34m~/codeby-devops/exam/src[00m$ sudo nano Jenkinsfile 
[?2004l[?2004h[?1049h[22;0;0t[1;55r(B[m[4l[?7h[39;49m[?1h=[?1h=[?25l[39;49m(B[m[H[2J[53;96H(B[0;7m[ Reading... ](B[m[53;94H(B[0;7m[ Read 72 lines ](B[m[H(B[0;7m  GNU nano 6.2                                                                                     Jenkinsfile                                                                                              [1;203H(B[m[54d(B[0;7m^G(B[m Help[54;18H(B[0;7m^O(B[m Write Out     (B[0;7m^W(B[m Where Is[52G(B[0;7m^K(B[m Cut[54;69H(B[0;7m^T(B[m Execute[86G(B[0;7m^C(B[m Location[103G(B[0;7mM-U(B[m Undo[54;120H(B[0;7mM-A(B[m Set Mark     (B[0;7mM-](B[m To Bracket   (B[0;7mM-Q(B[m Previous     (B[0;7m^B(B[m Back[54;188H(B[0;7m^â—‚(B[m Prev Word[55d(B[0;7m^X(B[m Exit[55;18H(B[0;7m^R(B[m Read File     (B[0;7m^\(B[m Replace[52G(B[0;7m^U(B[m Paste[55;69H(B[0;7m^J(B[m Justify[86G(B[0;7m^/(B[m Go To Line    (B[0;7mM-E(B[m Redo[55;120H(B[0;7mM-6(B[m Copy[55;137H(B[0;7m^Q(B[m Where Was     (B[0;7mM-W(B[m Next[55;171H(B[0;7m^F(B[m Forward[188G(B[0;7m^â–¸(B[m Next Word[2dpipeline {[3;5Hagent any[5;5Henvironment {[6;9HappVersion = readFile('exam/src/VERSION').trim()[7;5H}[9dstages {[10;9Hstage('Checkout') {[11;13Hsteps {[12;17Hgit branch: 'exam', url: '[94mhttps://github.com/Roma-uuu/codeby-devops.git'[13;13H[39m(B[m}[14;9H}[15dstage('Build') {[16;13Hsteps {[17;17Hdir('exam/src') {[18;21Hsh 'mvn clean package -Dcheckstyle.skip=true'[19;17H}[20;13H}[21;9H}[22dstage('Test Docker Access') {[23;13Hsteps {[24;17Hsh 'docker info'[25;13H}[26;9H}[27dstage('Build and Push Docker Image') {[28;13Hsteps {[29;17Hdir('exam/src') {[30;21Hscript {[31;25Hecho "Building Docker image with tag: ${appVersion}"[32;25HwithCredentials([usernamePassword(credentialsId: 'dockerhub-credentials', usernameVariable: 'DOCKERHUB_USERNAME', passwordVariable: 'DOCKERHUB_TOKEN')]) {[33;29Hsh """[34;29Hecho $DOCKERHUB_TOKEN | docker login -u $DOCKERHUB_USERNAME --password-stdin[35;29Hdocker build -t apkerigz/devops:${appVersion} .[36;29Hdocker push apkerigz/devops:${appVersion}[37;29H"""[38;25H}[39;21H}[40;17H}[41;13H}[42;9H}[43dstage('Deploy using Helm') {[44;13Hsteps {[45;17HwithCredentials([string(credentialsId: 'k8s-sa-token', variable: 'K8S_TOKEN')]) {[46;21Hdir('exam/src/mychart') {[47;25Hscript {[48;29Hecho "Deploying Helm chart with image tag: ${appVersion}"[49;29Hsh """[50;29Hhelm upgrade --install petclinic-app . \[51;33H--set image.repository=apkerigz/devops \[52;33H--set image.tag=${appVersion} \[2d[?12l[?25h[?25l[1;112H(B[0;7m*[203G(B[m[2;53r[53;1H
[1;55r[52;33H--kube-token=$K8S_TOKEN[K[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;29H"""[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;25H}[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;21H}[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;17H}[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;13H}[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;9H}[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;9Hstage('Run Ansible Playbook') {[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;13Hsteps {[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;17Hdir('exam/src') {[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;21Hscript {[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;25H// Ð”Ð¾Ð±Ð°Ð²Ð»ÑÐµÐ¼ ÑƒÑÑ‚Ð°Ð½Ð¾Ð²ÐºÑƒ ÐºÐ¾Ð»Ð»ÐµÐºÑ†Ð¸Ð¸ Ð¿ÐµÑ€ÐµÐ´ Ð·Ð°Ð¿ÑƒÑÐºÐ¾Ð¼ Ð¿Ð»ÐµÐ¹Ð±ÑƒÐºÐ°[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;25Hsh 'ansible-galaxy collection install kubernetes.core'[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;25H// Ð—Ð°Ð¿ÑƒÑÐº ÑÐ°Ð¼Ð¾Ð³Ð¾ Ð¿Ð»ÐµÐ¹Ð±ÑƒÐºÐ°[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;25Hsh 'ansible-playbook -i inventory monitoring_playbook.yml --ask-become-pass'[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;21H}[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;17H}[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;13H}[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;9H}[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;5H}[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;1H}[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[K[?12l[?25h[?25l[53;93H(B[0;7m[ Nothing was cut ](B[m[?12l[?25h[2d[?25l[53;112H[?12l[?25h[2d[?25l[53;112H[?12l[?25h[2d[?25l[53;112H[?12l[?25h[2d[?25l[53;112H[?12l[?25h[2d[?25l[53;112H[?12l[?25h[2d[?25l[53;112H[?12l[?25h[2d[?25l[53;112H[?12l[?25h[2d[?25l[53;112H[?12l[?25h[2d[?25l[53;112H[?12l[?25h[2d[?25l[53;112H[?12l[?25h[2d[?25l[2;29H"""[3;25H}[4;21H}[5;17H}[6;13H}[7;9H}[8dstage('Run Ansible Playbook') {[9;13Hsteps {[10;17Hdir('exam/src') {[11;21Hscript {[12;25H// Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¸Ðµ ansible.cfg Ð´Ð»Ñ ÑƒÐºÐ°Ð·Ð°Ð½Ð¸Ñ Ð¿ÑƒÑ‚Ð¸ Ðº ÐºÐ¾Ð»Ð»ÐµÐºÑ†Ð¸ÑÐ¼[13;25Hsh '''[14;25Hecho "[defaults]" > ansible.cfg[15;25Hecho "collections_paths = /home/rsshabanov/.ansible/collections:/usr/share/ansible/collections" >> ansible.cfg[16;25H'''[18;25H// Ð£ÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐ° ÐºÐ¾Ð»Ð»ÐµÐºÑ†Ð¸Ð¸ Ð¸ Ð·Ð°Ð¿ÑƒÑÐº Ð¿Ð»ÐµÐ¹Ð±ÑƒÐºÐ°[19;25Hsh 'ansible-galaxy collection install kubernetes.core'[20;25Hsh 'ansible-playbook -i inventory monitoring_playbook.yml --ask-become-pass'[21;21H}[22;17H}[23;13H}[24;9H}[25;5H}[26d}[53d[K[27d[?12l[?25h[?25l[?12l[?25h[18d[?25l[2dpipeline {[K[3;5Hagent any[K[4d[K[5;5Henvironment {[6;9HappVersion = readFile('exam/src/VERSION').trim()[7;5H}[K[8d[K[9;5Hstages {[K[10;9Hstage('Checkout') {[K[11;13Hsteps {[K[12;17Hgit branch: 'exam', url: '[94mhttps://github.com/Roma-uuu/codeby-devops.git'[13;13H[39m(B[m}[K[14;9H}[K[15dstage('Build') {[K[16;13Hsteps {[K[17;17Hdir('exam/src') {[18;21Hsh 'mvn clean package -Dcheckstyle.skip=true'[19;17H}[K[20;13H}[K[21;9H}[K[22dstage('Test Docker Access') {[23;13Hsteps {[24;16H[1K sh 'docker info'[25;12H[1K }[26;8H[1K }[27dstage('Build and Push Docker Image') {[28;13Hsteps {[29;17Hdir('exam/src') {[30;21Hscript {[31;25Hecho "Building Docker image with tag: ${appVersion}"[32;25HwithCredentials([usernamePassword(credentialsId: 'dockerhub-credentials', usernameVariable: 'DOCKERHUB_USERNAME', passwordVariable: 'DOCKERHUB_TOKEN')]) {[33;29Hsh """[34;29Hecho $DOCKERHUB_TOKEN | docker login -u $DOCKERHUB_USERNAME --password-stdin[35;29Hdocker build -t apkerigz/devops:${appVersion} .[36;29Hdocker push apkerigz/devops:${appVersion}[37;29H"""[38;25H}[39;21H}[40;17H}[41;13H}[42;9H}[43dstage('Deploy using Helm') {[44;13Hsteps {[45;17HwithCredentials([string(credentialsId: 'k8s-sa-token', variable: 'K8S_TOKEN')]) {[46;21Hdir('exam/src/mychart') {[47;25Hscript {[48;29Hecho "Deploying Helm chart with image tag: ${appVersion}"[49;29Hsh """[50;29Hhelm upgrade --install petclinic-app . \[51;33H--set image.repository=apkerigz/devops \[52;33H--set image.tag=${appVersion} \[9d[?12l[?25h[?25l[?12l[?25h[5d[?25l[?12l[?25h[2d[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[53d(B[0;7mSave modified buffer?                                                                                                                                                                                       [54;1H Y(B[m Yes[K[55d(B[0;7m N(B[m No  [55;17H(B[0;7m^C(B[m Cancel[K[53;23H[?12l[?25h[?25l[54d(B[0;7m^G(B[m Help[54;52H(B[0;7mM-D(B[m DOS Format[54;103H(B[0;7mM-A(B[m Append[54;154H(B[0;7mM-B(B[m Backup File[55d(B[0;7m^C(B[m Cancel[17G         [55;52H(B[0;7mM-M(B[m Mac Format[55;103H(B[0;7mM-P(B[m Prepend[55;154H(B[0;7m^T(B[m Browse[53d(B[0;7mFile Name to Write: Jenkinsfile(B[m[?12l[?25h[?25l[53;95H[1K (B[0;7m[ Writing... ](B[m[K[1;112H(B[0;7m [203G(B[m[53;94H(B[0;7m[ Wrote 77 lines ](B[m[J[55d[?12l[?25h[55;1H[?1049l[23;0;0t[?1l>[?2004l[?2004h]0;rsshabanov@MSK-01: ~/codeby-devops/exam/src[01;32mrsshabanov@MSK-01[00m:[01;34m~/codeby-devops/exam/src[00m$ sudo nano Jenkinsfile [1Pansible.cfgJenkinsfile [Kgit add ../src
[?2004l[?2004h]0;rsshabanov@MSK-01: ~/codeby-devops/exam/src[01;32mrsshabanov@MSK-01[00m:[01;34m~/codeby-devops/exam/src[00m$ git commit 0m [K[K[K-m ''e'd'i't'e'[1P'e'd'[1P'[1P' 'J'e'n'k'i'n's'f'i'l'e'
[?2004l[exam 9ac10e3] edit Jenkinsfile
 8 files changed, 248 insertions(+), 2 deletions(-)
 create mode 120000 exam/src/ansible-venv/bin/python
 create mode 120000 exam/src/ansible-venv/bin/python3
 create mode 120000 exam/src/ansible-venv/bin/python3.10
 create mode 120000 exam/src/ansible-venv/lib64
 create mode 100644 exam/src/ansible-venv/pyvenv.cfg
 create mode 100644 exam/src/ansible.cfg
 create mode 100644 exam/src/{
[?2004h]0;rsshabanov@MSK-01: ~/codeby-devops/exam/src[01;32mrsshabanov@MSK-01[00m:[01;34m~/codeby-devops/exam/src[00m$ git push codeby-devops
[?2004lEnumerating objects: 17, done.
Counting objects:   5% (1/17)Counting objects:  11% (2/17)Counting objects:  17% (3/17)Counting objects:  23% (4/17)Counting objects:  29% (5/17)Counting objects:  35% (6/17)Counting objects:  41% (7/17)Counting objects:  47% (8/17)Counting objects:  52% (9/17)Counting objects:  58% (10/17)Counting objects:  64% (11/17)Counting objects:  70% (12/17)Counting objects:  76% (13/17)Counting objects:  82% (14/17)Counting objects:  88% (15/17)Counting objects:  94% (16/17)Counting objects: 100% (17/17)Counting objects: 100% (17/17), done.
Delta compression using up to 6 threads
Compressing objects:  11% (1/9)Compressing objects:  22% (2/9)Compressing objects:  33% (3/9)Compressing objects:  44% (4/9)Compressing objects:  55% (5/9)Compressing objects:  66% (6/9)Compressing objects:  77% (7/9)Compressing objects:  88% (8/9)Compressing objects: 100% (9/9)Compressing objects: 100% (9/9), done.
Writing objects:   7% (1/13)Writing objects:  15% (2/13)Writing objects:  23% (3/13)Writing objects:  30% (4/13)Writing objects:  38% (5/13)Writing objects:  46% (6/13)Writing objects:  53% (7/13)Writing objects:  61% (8/13)Writing objects:  69% (9/13)Writing objects:  76% (10/13)Writing objects:  84% (11/13)Writing objects:  92% (12/13)Writing objects: 100% (13/13)Writing objects: 100% (13/13), 5.23 KiB | 2.61 MiB/s, done.
Total 13 (delta 2), reused 0 (delta 0), pack-reused 0
remote: Resolving deltas:   0% (0/2)[Kremote: Resolving deltas:  50% (1/2)[Kremote: Resolving deltas: 100% (2/2)[Kremote: Resolving deltas: 100% (2/2), completed with 2 local objects.[K
To github.com:Roma-uuu/codeby-devops.git
   266e874..9ac10e3  exam -> exam
[?2004h]0;rsshabanov@MSK-01: ~/codeby-devops/exam/src[01;32mrsshabanov@MSK-01[00m:[01;34m~/codeby-devops/exam/src[00m$ [7msudo apt-get update[27m
[7msudo apt-get install ansible=2.11.0[27m
[A[A[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[Csudo apt-get update
sudo apt-get install ansible=2.11.0
[A
[?2004l0% [Working]0% [Connecting to ru.archive.ubuntu.com] [Connecting to security.ubuntu.com] [Connecting to download.docker.com] [Connecting to apt.releases.hashicorp.com] [Connecting to baltocdn.com] [Connecting to pkg0% [Connecting to ru.archive.ubuntu.com (213.180.204.183)] [Waiting for headers] [Waiting for headers] [Waiting for headers] [Connected to baltocdn.com (143.244.49.183)] [Connected to pkg.jenkins.io (151                                                                                                                                                                                                           0% [Connecting to ru.archive.ubuntu.com (2a02:6b8::183)] [Waiting for headers] [Waiting for headers] [Waiting for headers] [Waiting for headers] [Waiting for headers]                                                                                                                                                                      Get:2 https://download.docker.com/linux/ubuntu jammy InRelease [48.8 kB]
                                                                                                                                                                      Get:3 https://apt.releases.hashicorp.com jammy InRelease [12.9 kB]
                                                                                                                                                                      0% [Connecting to ru.archive.ubuntu.com (2a02:6b8::183)] [Waiting for headers] [2 InRelease 15.9 kB/48.8 kB 32%] [Waiting for headers] [Waiting for headers]                                                                                                                                                            Hit:4 https://baltocdn.com/helm/stable/debian all InRelease
                                                                                                                                                            0% [Waiting for headers] [Waiting for headers] [2 InRelease 32.3 kB/48.8 kB 66%] [Waiting for headers]0% [Waiting for headers] [Waiting for headers] [2 InRelease 32.3 kB/48.8 kB 66%] [Waiting for headers]                                                                                                      Ign:5 https://pkg.jenkins.io/debian-stable binary/ InRelease
0% [Waiting for headers] [Waiting for headers] [2 InRelease 32.3 kB/48.8 kB 66%] [Waiting for headers]                                                                                                      0% [Waiting for headers] [Waiting for headers] [Waiting for headers] [Waiting for headers]                                                                                          Hit:6 https://pkg.jenkins.io/debian-stable binary/ Release
                                                                                          0% [Waiting for headers] [Waiting for headers] [Waiting for headers]                                                                    Get:7 https://apt.releases.hashicorp.com jammy/main amd64 Packages [154 kB]
0% [Waiting for headers] [Waiting for headers] [7 Packages 15.7 kB/154 kB 10%]0% [Waiting for headers] [Waiting for headers] [7 Packages 15.7 kB/154 kB 10%]                                                                              Hit:8 http://ru.archive.ubuntu.com/ubuntu jammy InRelease
                                                                              0% [Waiting for headers] [7 Packages 32.1 kB/154 kB 21%]0% [Connecting to packages.cloud.google.com] [Waiting for headers] [Waiting for headers] [7 Packages 32.1 kB/154 kB 21%]0% [Connecting to packages.cloud.google.com (173.194.199.113)] [Waiting for headers] [Waiting for headers] [7 Packages 97.6 kB/154 kB 63%]                                                                                                                                          0% [Connecting to packages.cloud.google.com (173.194.199.113)] [Waiting for headers] [Waiting for headers]0% [7 Packages store 0 B] [Connecting to packages.cloud.google.com (173.194.199.113)] [Waiting for headers] [Waiting for headers]0% [7 Packages store 0 B] [Connecting to packages.cloud.google.com (173.194.199.113)] [Waiting for headers] [Waiting for headers]                                                                                                                                 0% [Connected to packages.cloud.google.com (173.194.199.113)] [Waiting for headers] [Waiting for headers]                                                                                                         Get:10 http://security.ubuntu.com/ubuntu jammy-security InRelease [129 kB]
0% [Connected to packages.cloud.google.com (173.194.199.113)] [Waiting for headers] [10 InRelease 6989 B/129 kB 5%]                                                                                                                   0% [Waiting for headers] [Waiting for headers]0% [Waiting for headers] [Waiting for headers]                                              Ign:1 https://packages.cloud.google.com/apt kubernetes-xenial InRelease
0% [Waiting for headers] [Waiting for headers]0% [Waiting for headers] [Waiting for headers]                                              Get:12 http://security.ubuntu.com/ubuntu jammy-security/main amd64 Packages [1895 kB]
0% [Waiting for headers] [Waiting for headers] [12 Packages 4749 B/1895 kB 0%]                                                                              Err:11 https://packages.cloud.google.com/apt kubernetes-xenial Release
  404  Not Found [IP: 173.194.199.113 443]
                                                                              0% [Waiting for headers] [12 Packages 114 kB/1895 kB 6%]                                                        Get:13 http://ru.archive.ubuntu.com/ubuntu jammy-updates InRelease [128 kB]
0% [13 InRelease 1141 B/128 kB 1%] [12 Packages 168 kB/1895 kB 9%]                                                                  0% [12 Packages 201 kB/1895 kB 11%]0% [Waiting for headers] [12 Packages 295 kB/1895 kB 16%]0% [Waiting for headers] [12 Packages 1113 kB/1895 kB 59%]                                                          Get:14 http://ru.archive.ubuntu.com/ubuntu jammy-backports InRelease [127 kB]
0% [14 InRelease 20.1 kB/127 kB 16%] [12 Packages 1253 kB/1895 kB 66%]                                                                      0% [12 Packages 1272 kB/1895 kB 67%]31% [Waiting for headers] [12 Packages 1895 kB/1895 kB 100%]                                                            31% [Waiting for headers]31% [12 Packages store 0 B] [Waiting for headers]                                                 Get:15 http://ru.archive.ubuntu.com/ubuntu jammy-updates/main amd64 Packages [2112 kB]
31% [12 Packages store 0 B] [15 Packages 919 B/2112 kB 0%] [Waiting for headers]                                                                                32% [15 Packages 136 kB/2112 kB 6%] [Waiting for headers]                                                         Get:16 http://security.ubuntu.com/ubuntu jammy-security/main Translation-en [305 kB]
32% [15 Packages 136 kB/2112 kB 6%] [16 Translation-en 57.3 kB/305 kB 19%]                                                                          33% [15 Packages 136 kB/2112 kB 6%] [Waiting for headers]33% [16 Translation-en store 0 B] [15 Packages 136 kB/2112 kB 6%] [Waiting for headers]                                                                                       Get:17 http://security.ubuntu.com/ubuntu jammy-security/main amd64 DEP-11 Metadata [43.1 kB]
34% [16 Translation-en store 0 B] [15 Packages 136 kB/2112 kB 6%] [17 Components-amd64 43.1 kB/43.1 kB 100%]                                                                                                            34% [16 Translation-en store 0 B] [15 Packages 136 kB/2112 kB 6%] [Waiting for headers]                                                                                       Get:18 http://security.ubuntu.com/ubuntu jammy-security/restricted amd64 Packages [2517 kB]
34% [16 Translation-en store 0 B] [15 Packages 136 kB/2112 kB 6%] [18 Packages 51.4 kB/2517 kB 2%]                                                                                                  43% [15 Packages 136 kB/2112 kB 6%] [18 Packages 1619 kB/2517 kB 64%]43% [17 Components-amd64 store 0 B] [15 Packages 136 kB/2112 kB 6%] [18 Packages 1619 kB/2517 kB 64%]                                                                                                     43% [15 Packages 136 kB/2112 kB 6%] [18 Packages 1641 kB/2517 kB 65%]                                                                     49% [15 Packages 399 kB/2112 kB 19%] [Waiting for headers]49% [18 Packages store 0 B] [15 Packages 399 kB/2112 kB 19%] [Waiting for headers]                                                                                  Get:19 http://security.ubuntu.com/ubuntu jammy-security/restricted Translation-en [435 kB]
49% [18 Packages store 0 B] [15 Packages 399 kB/2112 kB 19%] [19 Translation-en 24.6 kB/435 kB 6%]                                                                                                  52% [18 Packages store 0 B] [15 Packages 399 kB/2112 kB 19%] [Waiting for headers]                                                                                  Get:20 http://security.ubuntu.com/ubuntu jammy-security/restricted amd64 DEP-11 Metadata [208 B]
52% [18 Packages store 0 B] [15 Packages 399 kB/2112 kB 19%] [20 Components-amd64 208 B/208 B 100%]                                                                                                   52% [18 Packages store 0 B] [15 Packages 399 kB/2112 kB 19%] [Waiting for headers]                                                                                  52% [15 Packages 433 kB/2112 kB 21%] [Waiting for headers]52% [19 Translation-en store 0 B] [15 Packages 436 kB/2112 kB 21%] [Waiting for headers]                                                                                        Get:21 http://security.ubuntu.com/ubuntu jammy-security/universe amd64 Packages [911 kB]
53% [19 Translation-en store 0 B] [15 Packages 505 kB/2112 kB 24%] [21 Packages 12.9 kB/911 kB 1%]                                                                                                  58% [19 Translation-en store 0 B] [15 Packages 570 kB/2112 kB 27%]                                                                  Get:22 http://security.ubuntu.com/ubuntu jammy-security/universe Translation-en [180 kB]
59% [19 Translation-en store 0 B] [15 Packages 660 kB/2112 kB 31%] [22 Translation-en 53.7 kB/180 kB 30%]                                                                                                         59% [19 Translation-en store 0 B] [15 Packages 660 kB/2112 kB 31%] [Waiting for headers]                                                                                        60% [15 Packages 660 kB/2112 kB 31%] [Waiting for headers]60% [15 Packages 660 kB/2112 kB 31%] [Waiting for headers]60% [21 Packages store 0 B] [15 Packages 660 kB/2112 kB 31%] [Waiting for headers]                                                                                  Get:23 http://security.ubuntu.com/ubuntu jammy-security/universe amd64 DEP-11 Metadata [126 kB]
60% [21 Packages store 0 B] [15 Packages 660 kB/2112 kB 31%] [23 Components-amd64 57.3 kB/126 kB 45%]                                                                                                     60% [21 Packages store 0 B] [15 Packages 660 kB/2112 kB 31%]                                                            Get:24 http://security.ubuntu.com/ubuntu jammy-security/multiverse amd64 DEP-11 Metadata [208 B]
60% [21 Packages store 0 B] [15 Packages 660 kB/2112 kB 31%] [24 Components-amd64 208 B/208 B 100%]                                                                                                   60% [21 Packages store 0 B] [15 Packages 660 kB/2112 kB 31%]                                                            60% [15 Packages 660 kB/2112 kB 31%]60% [22 Translation-en store 0 B] [15 Packages 660 kB/2112 kB 31%]                                                                  61% [15 Packages 660 kB/2112 kB 31%]61% [23 Components-amd64 store 0 B] [15 Packages 660 kB/2112 kB 31%]                                                                    61% [15 Packages 660 kB/2112 kB 31%]61% [24 Components-amd64 store 0 B] [15 Packages 660 kB/2112 kB 31%]                                                                    61% [15 Packages 660 kB/2112 kB 31%]                                    69% [Waiting for headers]69% [15 Packages store 0 B] [Waiting for headers]                                                 69% [Waiting for headers]                         Get:25 http://ru.archive.ubuntu.com/ubuntu jammy-updates/main Translation-en [363 kB]
69% [25 Translation-en 24.6 kB/363 kB 7%]                                         71% [Waiting for headers]71% [25 Translation-en store 0 B] [Waiting for headers]                                                       Get:26 http://ru.archive.ubuntu.com/ubuntu jammy-updates/main amd64 DEP-11 Metadata [103 kB]
71% [25 Translation-en store 0 B] [26 Components-amd64 0 B/103 kB 0%]                                                                     72% [25 Translation-en store 0 B]                                 Get:27 http://ru.archive.ubuntu.com/ubuntu jammy-updates/restricted amd64 Packages [2577 kB]
72% [25 Translation-en store 0 B] [27 Packages 90.2 kB/2577 kB 3%]                                                                  81% [27 Packages 1757 kB/2577 kB 68%]81% [26 Components-amd64 store 0 B] [27 Packages 1757 kB/2577 kB 68%]                                                                     82% [27 Packages 1757 kB/2577 kB 68%]86% [Waiting for headers]                                                                                                                                                                      1955 kB/s 1s86% [27 Packages store 0 B] [Waiting for headers]                                                                                                                                              1955 kB/s 1s                                                                                                                                                                                                           Get:28 http://ru.archive.ubuntu.com/ubuntu jammy-updates/restricted Translation-en [445 kB]
86% [27 Packages store 0 B] [28 Translation-en 25.7 kB/445 kB 6%]                                                                                                                              1955 kB/s 1s89% [27 Packages store 0 B] [Waiting for headers]                                                                                                                                              1955 kB/s 0s                                                                                                                                                                                                           Get:29 http://ru.archive.ubuntu.com/ubuntu jammy-updates/restricted amd64 DEP-11 Metadata [212 B]
89% [27 Packages store 0 B] [29 Components-amd64 212 B/212 B 100%]                                                                                                                             1955 kB/s 0s89% [27 Packages store 0 B]                                                                                                                                                                    1955 kB/s 0s                                                                                                                                                                                                           Get:30 http://ru.archive.ubuntu.com/ubuntu jammy-updates/universe amd64 Packages [1133 kB]
89% [27 Packages store 0 B] [30 Packages 38.3 kB/1133 kB 3%]                                                                                                                                   1955 kB/s 0s95% [27 Packages store 0 B]                                                                                                                                                                    1955 kB/s 0s                                                                                                                                                                                                           Get:31 http://ru.archive.ubuntu.com/ubuntu jammy-updates/universe Translation-en [265 kB]
95% [27 Packages store 0 B] [31 Translation-en 49.2 kB/265 kB 19%]                                                                                                                             1955 kB/s 0s96% [27 Packages store 0 B] [Waiting for headers]                                                                                                                                              1955 kB/s 0s                                                                                                                                                                                                           Get:32 http://ru.archive.ubuntu.com/ubuntu jammy-updates/universe amd64 DEP-11 Metadata [356 kB]
97% [27 Packages store 0 B] [32 Components-amd64 41.0 kB/356 kB 12%]                                                                                                                           1955 kB/s 0s98% [27 Packages store 0 B] [Waiting for headers]                                                                                                                                              1955 kB/s 0s                                                                                                                                                                                                           Get:33 http://ru.archive.ubuntu.com/ubuntu jammy-updates/multiverse amd64 DEP-11 Metadata [940 B]
98% [27 Packages store 0 B] [33 Components-amd64 940 B/940 B 100%]                                                                                                                             1955 kB/s 0s98% [27 Packages store 0 B] [Waiting for headers]                                                                                                                                              1955 kB/s 0s                                                                                                                                                                                                           Get:34 http://ru.archive.ubuntu.com/ubuntu jammy-backports/main amd64 DEP-11 Metadata [5324 B]
98% [27 Packages store 0 B] [Waiting for headers]                                                                                                                                              1955 kB/s 0s                                                                                                                                                                                                           Get:35 http://ru.archive.ubuntu.com/ubuntu jammy-backports/restricted amd64 DEP-11 Metadata [212 B]
98% [27 Packages store 0 B] [Waiting for headers]                                                                                                                                              1955 kB/s 0s99% [Waiting for headers]                                                                                                                                                                      1955 kB/s 0s99% [28 Translation-en store 0 B] [Waiting for headers]                                                                                                                                        1955 kB/s 0s                                                                                                                                                                                                           Get:36 http://ru.archive.ubuntu.com/ubuntu jammy-backports/universe amd64 DEP-11 Metadata [23.1 kB]
99% [28 Translation-en store 0 B] [36 Components-amd64 23.1 kB/23.1 kB 100%]                                                                                                                   1955 kB/s 0s99% [28 Translation-en store 0 B] [Waiting for headers]                                                                                                                                        1955 kB/s 0s99% [Waiting for headers]                                                                                                                                                                      1955 kB/s 0s99% [29 Components-amd64 store 0 B] [Waiting for headers]                                                                                                                                      1955 kB/s 0s99% [Waiting for headers]                                                                                                                                                                      1955 kB/s 0s99% [30 Packages store 0 B] [Waiting for headers]                                                                                                                                              1955 kB/s 0s                                                                                                                                                                                                           Get:37 http://ru.archive.ubuntu.com/ubuntu jammy-backports/multiverse amd64 DEP-11 Metadata [212 B]
99% [30 Packages store 0 B] [37 Components-amd64 212 B/212 B 100%]                                                                                                                             1955 kB/s 0s99% [30 Packages store 0 B]                                                                                                                                                                    1955 kB/s 0s99% [Working]                                                                                                                                                                                  1955 kB/s 0s99% [31 Translation-en store 0 B]                                                                                                                                                              1955 kB/s 0s99% [Working]                                                                                                                                                                                  1955 kB/s 0s99% [32 Components-amd64 store 0 B]                                                                                                                                                            1955 kB/s 0s99% [Working]                                                                                                                                                                                  1955 kB/s 0s99% [33 Components-amd64 store 0 B]                                                                                                                                                            1955 kB/s 0s99% [Working]                                                                                                                                                                                  1955 kB/s 0s99% [34 Components-amd64 store 0 B]                                                                                                                                                            1955 kB/s 0s100% [Working]                                                                                                                                                                                 1955 kB/s 0s100% [35 Components-amd64 store 0 B]                                                                                                                                                           1955 kB/s 0s100% [Working]                                                                                                                                                                                 1955 kB/s 0s100% [36 Components-amd64 store 0 B]                                                                                                                                                           1955 kB/s 0s100% [Working]                                                                                                                                                                                 1955 kB/s 0s100% [37 Components-amd64 store 0 B]                                                                                                                                                           1955 kB/s 0s100% [Working]                                                                                                                                                                                 1955 kB/s 0s                                                                                                                                                                                                           Reading package lists... 0%Reading package lists... 0%Reading package lists... 0%Reading package lists... 3%Reading package lists... 3%Reading package lists... 4%Reading package lists... 4%Reading package lists... 5%Reading package lists... 5%Reading package lists... 5%Reading package lists... 5%Reading package lists... 35%Reading package lists... 35%Reading package lists... 49%Reading package lists... 49%Reading package lists... 49%Reading package lists... 49%Reading package lists... 49%Reading package lists... 49%Reading package lists... 51%Reading package lists... 55%Reading package lists... 55%Reading package lists... 59%Reading package lists... 59%Reading package lists... 66%Reading package lists... 66%Reading package lists... 70%Reading package lists... 70%Reading package lists... 73%Reading package lists... 73%Reading package lists... 74%Reading package lists... 74%Reading package lists... 74%Reading package lists... 74%Reading package lists... 74%Reading package lists... 74%Reading package lists... 74%Reading package lists... 74%Reading package lists... 75%Reading package lists... 75%Reading package lists... 75%Reading package lists... 75%Reading package lists... 75%Reading package lists... 75%Reading package lists... 80%Reading package lists... 80%Reading package lists... 83%Reading package lists... 83%Reading package lists... 90%Reading package lists... 90%Reading package lists... 94%Reading package lists... 94%Reading package lists... 97%Reading package lists... 97%Reading package lists... 98%Reading package lists... 98%Reading package lists... 98%Reading package lists... 98%Reading package lists... 98%Reading package lists... 98%Reading package lists... 98%Reading package lists... 98%Reading package lists... 98%Reading package lists... 98%Reading package lists... 98%Reading package lists... 98%Reading package lists... 98%Reading package lists... 98%Reading package lists... Done
W: https://baltocdn.com/helm/stable/debian/dists/all/InRelease: Key is stored in legacy trusted.gpg keyring (/etc/apt/trusted.gpg), see the DEPRECATION section in apt-key(8) for details.
E: The repository 'https://apt.kubernetes.io kubernetes-xenial Release' does not have a Release file.
N: Updating from such a repository can't be done securely, and is therefore disabled by default.
N: See apt-secure(8) manpage for repository creation and user configuration details.
Reading package lists... 0%Reading package lists... 100%Reading package lists... Done
Building dependency tree... 0%Building dependency tree... 0%Building dependency tree... 50%Building dependency tree... 50%Building dependency tree... Done
Reading state information... 0% Reading state information... 0%Reading state information... Done
Package ansible is not available, but is referred to by another package.
This may mean that the package is missing, has been obsoleted, or
is only available from another source
However the following packages replace it:
  ansible-core

E: Version '2.11.0' for 'ansible' was not found
[?2004h]0;rsshabanov@MSK-01: ~/codeby-devops/exam/src[01;32mrsshabanov@MSK-01[00m:[01;34m~/codeby-devops/exam/src[00m$ sudo apt-get install ansible=2.11.0[C[K[K[K[K[K[K[K
[?2004lReading package lists... 0%Reading package lists... 100%Reading package lists... Done
Building dependency tree... 0%Building dependency tree... 0%Building dependency tree... 50%Building dependency tree... 50%Building dependency tree... Done
Reading state information... 0% Reading state information... 0%Reading state information... Done
ansible is already the newest version (2.10.7+merged+base+2.10.8+dfsg-1).
The following package was automatically installed and is no longer required:
  libdebuginfod-common
Use 'sudo apt autoremove' to remove it.
0 upgraded, 0 newly installed, 0 to remove and 12 not upgraded.
[?2004h]0;rsshabanov@MSK-01: ~/codeby-devops/exam/src[01;32mrsshabanov@MSK-01[00m:[01;34m~/codeby-devops/exam/src[00m$ [7msudo nano /etc/apt/sources.list[27m
[A[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[Csudo nano /etc/apt/sources.list
[A
[?2004l[?2004h[?1049h[22;0;0t[1;55r(B[m[4l[?7h[39;49m[?1h=[?1h=[?25l[39;49m(B[m[H[2J[53;96H(B[0;7m[ Reading... ](B[m[53;94H(B[0;7m[ Read 42 lines ](B[m[H(B[0;7m  GNU nano 6.2                                                                                /etc/apt/sources.list                                                                                         [1;203H(B[m[54d(B[0;7m^G(B[m Help[54;18H(B[0;7m^O(B[m Write Out     (B[0;7m^W(B[m Where Is[52G(B[0;7m^K(B[m Cut[54;69H(B[0;7m^T(B[m Execute[86G(B[0;7m^C(B[m Location[103G(B[0;7mM-U(B[m Undo[54;120H(B[0;7mM-A(B[m Set Mark     (B[0;7mM-](B[m To Bracket   (B[0;7mM-Q(B[m Previous     (B[0;7m^B(B[m Back[54;188H(B[0;7m^â—‚(B[m Prev Word[55d(B[0;7m^X(B[m Exit[55;18H(B[0;7m^R(B[m Read File     (B[0;7m^\(B[m Replace[52G(B[0;7m^U(B[m Paste[55;69H(B[0;7m^J(B[m Justify[86G(B[0;7m^/(B[m Go To Line    (B[0;7mM-E(B[m Redo[55;120H(B[0;7mM-6(B[m Copy[55;137H(B[0;7m^Q(B[m Where Was     (B[0;7mM-W(B[m Next[55;171H(B[0;7m^F(B[m Forward[188G(B[0;7m^â–¸(B[m Next Word[2d(B[0;1m[34m# See http://help.ubuntu.com/community/UpgradeNotes for how to upgrade to[3d# newer versions of the distribution.[4d(B[0m[33mdeb(B[0;1m[32m http://ru.archive.ubuntu.com/ubuntu/[35m jammy main restricted[5d[34m# deb-src http://ru.archive.ubuntu.com/ubuntu/ jammy main restricted[7d## Major bug fix updates produced after the final release of the[8d## distribution.[9d(B[0m[33mdeb(B[0;1m[32m http://ru.archive.ubuntu.com/ubuntu/[35m jammy-updates main restricted[10d[34m# deb-src http://ru.archive.ubuntu.com/ubuntu/ jammy-updates main restricted[12d## N.B. software from this repository is ENTIRELY UNSUPPORTED by the Ubuntu[13d## team. Also, please note that software in universe WILL NOT receive any[14d## review or updates from the Ubuntu security team.[15d(B[0m[33mdeb(B[0;1m[32m http://ru.archive.ubuntu.com/ubuntu/[35m jammy universe[16d[34m# deb-src http://ru.archive.ubuntu.com/ubuntu/ jammy universe[17d(B[0m[33mdeb(B[0;1m[32m http://ru.archive.ubuntu.com/ubuntu/[35m jammy-updates universe[18d[34m# deb-src http://ru.archive.ubuntu.com/ubuntu/ jammy-updates universe[20d## N.B. software from this repository is ENTIRELY UNSUPPORTED by the Ubuntu[21d## team, and may not be under a free licence. Please satisfy yourself as to[22d## your rights to use the software. Also, please note that software in[23d## multiverse WILL NOT receive any review or updates from the Ubuntu[24d## security team.[25d(B[0m[33mdeb(B[0;1m[32m http://ru.archive.ubuntu.com/ubuntu/[35m jammy multiverse[26d[34m# deb-src http://ru.archive.ubuntu.com/ubuntu/ jammy multiverse[27d(B[0m[33mdeb(B[0;1m[32m http://ru.archive.ubuntu.com/ubuntu/[35m jammy-updates multiverse[28d[34m# deb-src http://ru.archive.ubuntu.com/ubuntu/ jammy-updates multiverse[30d## N.B. software from this repository may not have been tested as[31d## extensively as that contained in the main release, although it includes[32d## newer versions of some applications which may provide useful features.[33d## Also, please note that software in backports WILL NOT receive any review[34d## or updates from the Ubuntu security team.[35d(B[0m[33mdeb(B[0;1m[32m http://ru.archive.ubuntu.com/ubuntu/[35m jammy-backports main restricted universe multiverse[36d[34m# deb-src http://ru.archive.ubuntu.com/ubuntu/ jammy-backports main restricted universe multiverse[38d(B[0m[33mdeb(B[0;1m[32m http://security.ubuntu.com/ubuntu/[35m jammy-security main restricted[39d[34m# deb-src http://security.ubuntu.com/ubuntu/ jammy-security main restricted[40d(B[0m[33mdeb(B[0;1m[32m http://security.ubuntu.com/ubuntu/[35m jammy-security universe[41d[34m# deb-src http://security.ubuntu.com/ubuntu/ jammy-security universe[42d(B[0m[33mdeb(B[0;1m[32m http://security.ubuntu.com/ubuntu/[35m jammy-security multiverse[43d[34m# deb-src http://security.ubuntu.com/ubuntu/ jammy-security multiverse[2d[39m(B[m[?12l[?25h[?25l[53d[J[55d[?12l[?25h[55;1H[?1049l[23;0;0t[?1l>[?2004l[?2004h]0;rsshabanov@MSK-01: ~/codeby-devops/exam/src[01;32mrsshabanov@MSK-01[00m:[01;34m~/codeby-devops/exam/src[00m$ [7msudo nano /etc/apt/sources.list.d/kubernetes.list[27m
[A[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[Csudo nano /etc/apt/sources.list.d/kubernetes.list
[A
[?2004l[?2004h[?1049h[22;0;0t[1;55r(B[m[4l[?7h[39;49m[?1h=[?1h=[?25l[39;49m(B[m[H[2J[53;96H(B[0;7m[ Reading... ](B[m[53;95H(B[0;7m[ Read 1 line ](B[m[H(B[0;7m  GNU nano 6.2                                                                       /etc/apt/sources.list.d/kubernetes.list                                                                                [1;203H(B[m[54d(B[0;7m^G(B[m Help[54;18H(B[0;7m^O(B[m Write Out     (B[0;7m^W(B[m Where Is[52G(B[0;7m^K(B[m Cut[54;69H(B[0;7m^T(B[m Execute[86G(B[0;7m^C(B[m Location[103G(B[0;7mM-U(B[m Undo[54;120H(B[0;7mM-A(B[m Set Mark     (B[0;7mM-](B[m To Bracket   (B[0;7mM-Q(B[m Previous     (B[0;7m^B(B[m Back[54;188H(B[0;7m^â—‚(B[m Prev Word[55d(B[0;7m^X(B[m Exit[55;18H(B[0;7m^R(B[m Read File     (B[0;7m^\(B[m Replace[52G(B[0;7m^U(B[m Paste[55;69H(B[0;7m^J(B[m Justify[86G(B[0;7m^/(B[m Go To Line    (B[0;7mM-E(B[m Redo[55;120H(B[0;7mM-6(B[m Copy[55;137H(B[0;7m^Q(B[m Where Was     (B[0;7mM-W(B[m Next[55;171H(B[0;7m^F(B[m Forward[188G(B[0;7m^â–¸(B[m Next Word[2d[33mdeb(B[0;1m[32m https://apt.kubernetes.io/[35m kubernetes-xenial main[39m(B[m[?12l[?25h[?25l[53d[J[55d[?12l[?25h[55;1H[?1049l[23;0;0t[?1l>[?2004l[?2004h]0;rsshabanov@MSK-01: ~/codeby-devops/exam/src[01;32mrsshabanov@MSK-01[00m:[01;34m~/codeby-devops/exam/src[00m$ sudo nano /etc/apt/sources.list.d/kubernetes.list
[?2004l[?2004h[?1049h[22;0;0t[1;55r(B[m[4l[?7h[39;49m[?1h=[?1h=[?25l[39;49m(B[m[H[2J[53;96H(B[0;7m[ Reading... ](B[m[53;95H(B[0;7m[ Read 1 line ](B[m[H(B[0;7m  GNU nano 6.2                                                                       /etc/apt/sources.list.d/kubernetes.list                                                                                [1;203H(B[m[54d(B[0;7m^G(B[m Help[54;18H(B[0;7m^O(B[m Write Out     (B[0;7m^W(B[m Where Is[52G(B[0;7m^K(B[m Cut[54;69H(B[0;7m^T(B[m Execute[86G(B[0;7m^C(B[m Location[103G(B[0;7mM-U(B[m Undo[54;120H(B[0;7mM-A(B[m Set Mark     (B[0;7mM-](B[m To Bracket   (B[0;7mM-Q(B[m Previous     (B[0;7m^B(B[m Back[54;188H(B[0;7m^â—‚(B[m Prev Word[55d(B[0;7m^X(B[m Exit[55;18H(B[0;7m^R(B[m Read File     (B[0;7m^\(B[m Replace[52G(B[0;7m^U(B[m Paste[55;69H(B[0;7m^J(B[m Justify[86G(B[0;7m^/(B[m Go To Line    (B[0;7mM-E(B[m Redo[55;120H(B[0;7mM-6(B[m Copy[55;137H(B[0;7m^Q(B[m Where Was     (B[0;7mM-W(B[m Next[55;171H(B[0;7m^F(B[m Forward[188G(B[0;7m^â–¸(B[m Next Word[2d[33mdeb(B[0;1m[32m https://apt.kubernetes.io/[35m kubernetes-xenial main[39m(B[m[?12l[?25h[?25l[1;126H(B[0;7m*[203G(B[m[2d[K[53d[K[2d[?12l[?25h[?25l[53d(B[0;7mSave modified buffer?                                                                                                                                                                                       [54;1H Y(B[m Yes[K[55d(B[0;7m N(B[m No  [55;17H(B[0;7m^C(B[m Cancel[K[53;23H[?12l[?25h[?25l[54d(B[0;7m^G(B[m Help[54;52H(B[0;7mM-D(B[m DOS Format[54;103H(B[0;7mM-A(B[m Append[54;154H(B[0;7mM-B(B[m Backup File[55d(B[0;7m^C(B[m Cancel[17G         [55;52H(B[0;7mM-M(B[m Mac Format[55;103H(B[0;7mM-P(B[m Prepend[55;154H(B[0;7m^T(B[m Browse[53d(B[0;7mFile Name to Write: /etc/apt/sources.list.d/kubernetes.list(B[m[?12l[?25h[?25l[53;95H[1K (B[0;7m[ Writing... ](B[m[K[1;126H(B[0;7m [203G(B[m[53;94H(B[0;7m[ Wrote 0 lines ](B[m[J[55d[?12l[?25h[55;1H[?1049l[23;0;0t[?1l>[?2004l[?2004h]0;rsshabanov@MSK-01: ~/codeby-devops/exam/src[01;32mrsshabanov@MSK-01[00m:[01;34m~/codeby-devops/exam/src[00m$ [7mcurl https://baltocdn.com/helm/signing.asc | sudo gpg --dearmor -o /usr/share/keyrings/helm.gpg[27m
[A[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[Ccurl https://baltocdn.com/helm/signing.asc | sudo gpg --dearmor -o /usr/share/keyrings/helm.gpg
[A
[?2004l  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0100  1699  100  1699    0     0   2077      0 --:--:-- --:--:-- --:--:--  2077
[?2004h]0;rsshabanov@MSK-01: ~/codeby-devops/exam/src[01;32mrsshabanov@MSK-01[00m:[01;34m~/codeby-devops/exam/src[00m$ [7msudo apt-get update[27m
[A[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[Csudo apt-get update
[A
[?2004l0% [Working]0% [Connecting to ru.archive.ubuntu.com] [Connecting to security.ubuntu.com] [Connecting to download.docker.com] [Connecting to apt.releases.hashicorp.com] [Connecting to baltocdn.com] [Connecting to pkg0% [Connecting to ru.archive.ubuntu.com (2a02:6b8::183)] [Waiting for headers] [Connected to download.docker.com (18.160.143.36)] [Waiting for headers] [Connected to baltocdn.com (185.93.1.250)] [Connect0% [Waiting for headers] [Waiting for headers] [Connected to download.docker.com (18.160.143.36)] [Waiting for headers] [Connected to baltocdn.com (185.93.1.250)] [Connected to pkg.jenkins.io (151.101.66                                                                                                                                                                                                           Hit:1 https://apt.releases.hashicorp.com jammy InRelease
                                                                                                                                                                                                           0% [Waiting for headers] [Waiting for headers] [Connected to download.docker.com (18.160.143.36)] [Connected to baltocdn.com (185.93.1.250)] [Connected to pkg.jenkins.io (151.101.66.133)]                                                                                                                                                                                           Hit:2 http://security.ubuntu.com/ubuntu jammy-security InRelease
                                                                                                                                                                                           0% [Waiting for headers] [Waiting for headers] [Waiting for headers] [Connected to pkg.jenkins.io (151.101.66.133)]0% [Waiting for headers] [Waiting for headers] [Waiting for headers] [Connected to pkg.jenkins.io (151.101.66.133)]                                                                                                                   Hit:3 http://ru.archive.ubuntu.com/ubuntu jammy InRelease
                                                                                                                   0% [Waiting for headers] [Waiting for headers] [Connected to pkg.jenkins.io (151.101.66.133)]                                                                                             Hit:4 https://download.docker.com/linux/ubuntu jammy InRelease
                                                                                             0% [Waiting for headers] [Waiting for headers] [Waiting for headers]                                                                    Hit:5 https://baltocdn.com/helm/stable/debian all InRelease
                                                                    0% [Waiting for headers] [Waiting for headers]0% [Waiting for headers] [Waiting for headers]                                              Ign:6 https://pkg.jenkins.io/debian-stable binary/ InRelease
                                              0% [Waiting for headers]0% [Waiting for headers] [Waiting for headers]0% [Waiting for headers] [Waiting for headers]                                              Hit:7 http://ru.archive.ubuntu.com/ubuntu jammy-updates InRelease
                                              0% [Waiting for headers]                        Hit:8 https://pkg.jenkins.io/debian-stable binary/ Release
0% [Waiting for headers]0% [Waiting for headers]0% [Waiting for headers]0% [Waiting for headers]                        Hit:10 http://ru.archive.ubuntu.com/ubuntu jammy-backports InRelease
                        0% [Working]20% [Working]             Reading package lists... 0%Reading package lists... 0%Reading package lists... 0%Reading package lists... 3%Reading package lists... 3%Reading package lists... 4%Reading package lists... 4%Reading package lists... 5%Reading package lists... 5%Reading package lists... 5%Reading package lists... 5%Reading package lists... 35%Reading package lists... 35%Reading package lists... 49%Reading package lists... 49%Reading package lists... 49%Reading package lists... 49%Reading package lists... 49%Reading package lists... 49%Reading package lists... 54%Reading package lists... 55%Reading package lists... 55%Reading package lists... 59%Reading package lists... 59%Reading package lists... 66%Reading package lists... 66%Reading package lists... 70%Reading package lists... 70%Reading package lists... 73%Reading package lists... 73%Reading package lists... 74%Reading package lists... 74%Reading package lists... 74%Reading package lists... 74%Reading package lists... 74%Reading package lists... 74%Reading package lists... 74%Reading package lists... 74%Reading package lists... 75%Reading package lists... 75%Reading package lists... 75%Reading package lists... 75%Reading package lists... 75%Reading package lists... 75%Reading package lists... 80%Reading package lists... 80%Reading package lists... 83%Reading package lists... 83%Reading package lists... 90%Reading package lists... 90%Reading package lists... 94%Reading package lists... 94%Reading package lists... 97%Reading package lists... 97%Reading package lists... 98%Reading package lists... 98%Reading package lists... 98%Reading package lists... 98%Reading package lists... 98%Reading package lists... 98%Reading package lists... 98%Reading package lists... 98%Reading package lists... 98%Reading package lists... 98%Reading package lists... 98%Reading package lists... 98%Reading package lists... 98%Reading package lists... 98%Reading package lists... Done
W: https://baltocdn.com/helm/stable/debian/dists/all/InRelease: Key is stored in legacy trusted.gpg keyring (/etc/apt/trusted.gpg), see the DEPRECATION section in apt-key(8) for details.
[?2004h]0;rsshabanov@MSK-01: ~/codeby-devops/exam/src[01;32mrsshabanov@MSK-01[00m:[01;34m~/codeby-devops/exam/src[00m$ [7msudo apt-get install ansible[27m
[A[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[Csudo apt-get install ansible
[A
[?2004lReading package lists... 0%Reading package lists... 100%Reading package lists... Done
Building dependency tree... 0%Building dependency tree... 0%Building dependency tree... 50%Building dependency tree... 50%Building dependency tree... Done
Reading state information... 0% Reading state information... 0%Reading state information... Done
ansible is already the newest version (2.10.7+merged+base+2.10.8+dfsg-1).
The following package was automatically installed and is no longer required:
  libdebuginfod-common
Use 'sudo apt autoremove' to remove it.
0 upgraded, 0 newly installed, 0 to remove and 12 not upgraded.
[?2004h]0;rsshabanov@MSK-01: ~/codeby-devops/exam/src[01;32mrsshabanov@MSK-01[00m:[01;34m~/codeby-devops/exam/src[00m$ [7mansible --version[27m
[A[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[Cansible --version
[A
[?2004lansible [core 2.17.5]
  config file = /home/rsshabanov/codeby-devops/exam/src/ansible.cfg
  configured module search path = ['/home/rsshabanov/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']
  ansible python module location = /home/rsshabanov/.local/lib/python3.10/site-packages/ansible
  ansible collection location = /home/rsshabanov/.ansible/collections:/usr/share/ansible/collections
  executable location = /home/rsshabanov/.local/bin/ansible
  python version = 3.10.12 (main, Sep 11 2024, 15:47:36) [GCC 11.4.0] (/usr/bin/python3)
  jinja version = 3.0.3
  libyaml = True
[?2004h]0;rsshabanov@MSK-01: ~/codeby-devops/exam/src[01;32mrsshabanov@MSK-01[00m:[01;34m~/codeby-devops/exam/src[00m$ [7mpip install ansible[27mpip install ansible
[?2004lDefaulting to user installation because normal site-packages is not writeable
Requirement already satisfied: ansible in /home/rsshabanov/.local/lib/python3.10/site-packages (10.5.0)
Requirement already satisfied: ansible-core~=2.17.5 in /home/rsshabanov/.local/lib/python3.10/site-packages (from ansible) (2.17.5)
Requirement already satisfied: jinja2>=3.0.0 in /usr/lib/python3/dist-packages (from ansible-core~=2.17.5->ansible) (3.0.3)
Requirement already satisfied: packaging in /usr/lib/python3/dist-packages (from ansible-core~=2.17.5->ansible) (21.3)
Requirement already satisfied: resolvelib<1.1.0,>=0.5.3 in /home/rsshabanov/.local/lib/python3.10/site-packages (from ansible-core~=2.17.5->ansible) (1.0.1)
Requirement already satisfied: cryptography in /usr/lib/python3/dist-packages (from ansible-core~=2.17.5->ansible) (3.4.8)
Requirement already satisfied: PyYAML>=5.1 in /usr/lib/python3/dist-packages (from ansible-core~=2.17.5->ansible) (5.4.1)
[?2004h]0;rsshabanov@MSK-01: ~/codeby-devops/exam/src[01;32mrsshabanov@MSK-01[00m:[01;34m~/codeby-devops/exam/src[00m$ 
[?2004l[?2004h]0;rsshabanov@MSK-01: ~/codeby-devops/exam/src[01;32mrsshabanov@MSK-01[00m:[01;34m~/codeby-devops/exam/src[00m$ 
[?2004l[?2004h]0;rsshabanov@MSK-01: ~/codeby-devops/exam/src[01;32mrsshabanov@MSK-01[00m:[01;34m~/codeby-devops/exam/src[00m$ 
[?2004l[?2004h]0;rsshabanov@MSK-01: ~/codeby-devops/exam/src[01;32mrsshabanov@MSK-01[00m:[01;34m~/codeby-devops/exam/src[00m$ 
[?2004l[?2004h]0;rsshabanov@MSK-01: ~/codeby-devops/exam/src[01;32mrsshabanov@MSK-01[00m:[01;34m~/codeby-devops/exam/src[00m$ pip install ansible[2Pansible --versionsudo apt-get install ansible[9Pupdatecurl https://baltocdn.com/helm/signing.asc | sudo gpg --dearmor -o /usr/share/keyrings/helm.gpg[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[46Psudo nano /etc/apt/sources.list.d/kubernetes.list[K[3Papt-get install ansiblenano /etc/apt/sources.list[3Papt-get install ansible=2.11.0update[Kgit push codeby-devopscommit -m 'edit Jenkinsfile'[18Padd ../srcsudo nano Jenkinsfile 
[?2004l[?2004h[?1049h[22;0;0t[1;55r(B[m[4l[?7h[39;49m[?1h=[?1h=[?25l[39;49m(B[m[H[2J[53;96H(B[0;7m[ Reading... ](B[m[53;94H(B[0;7m[ Read 77 lines ](B[m[H(B[0;7m  GNU nano 6.2                                                                                     Jenkinsfile                                                                                              [1;203H(B[m[54d(B[0;7m^G(B[m Help[54;18H(B[0;7m^O(B[m Write Out     (B[0;7m^W(B[m Where Is[52G(B[0;7m^K(B[m Cut[54;69H(B[0;7m^T(B[m Execute[86G(B[0;7m^C(B[m Location[103G(B[0;7mM-U(B[m Undo[54;120H(B[0;7mM-A(B[m Set Mark     (B[0;7mM-](B[m To Bracket   (B[0;7mM-Q(B[m Previous     (B[0;7m^B(B[m Back[54;188H(B[0;7m^â—‚(B[m Prev Word[55d(B[0;7m^X(B[m Exit[55;18H(B[0;7m^R(B[m Read File     (B[0;7m^\(B[m Replace[52G(B[0;7m^U(B[m Paste[55;69H(B[0;7m^J(B[m Justify[86G(B[0;7m^/(B[m Go To Line    (B[0;7mM-E(B[m Redo[55;120H(B[0;7mM-6(B[m Copy[55;137H(B[0;7m^Q(B[m Where Was     (B[0;7mM-W(B[m Next[55;171H(B[0;7m^F(B[m Forward[188G(B[0;7m^â–¸(B[m Next Word[2dpipeline {[3;5Hagent any[5;5Henvironment {[6;9HappVersion = readFile('exam/src/VERSION').trim()[7;5H}[9dstages {[10;9Hstage('Checkout') {[11;13Hsteps {[12;17Hgit branch: 'exam', url: '[94mhttps://github.com/Roma-uuu/codeby-devops.git'[13;13H[39m(B[m}[14;9H}[15dstage('Build') {[16;13Hsteps {[17;17Hdir('exam/src') {[18;21Hsh 'mvn clean package -Dcheckstyle.skip=true'[19;17H}[20;13H}[21;9H}[22dstage('Test Docker Access') {[23;13Hsteps {[24;17Hsh 'docker info'[25;13H}[26;9H}[27dstage('Build and Push Docker Image') {[28;13Hsteps {[29;17Hdir('exam/src') {[30;21Hscript {[31;25Hecho "Building Docker image with tag: ${appVersion}"[32;25HwithCredentials([usernamePassword(credentialsId: 'dockerhub-credentials', usernameVariable: 'DOCKERHUB_USERNAME', passwordVariable: 'DOCKERHUB_TOKEN')]) {[33;29Hsh """[34;29Hecho $DOCKERHUB_TOKEN | docker login -u $DOCKERHUB_USERNAME --password-stdin[35;29Hdocker build -t apkerigz/devops:${appVersion} .[36;29Hdocker push apkerigz/devops:${appVersion}[37;29H"""[38;25H}[39;21H}[40;17H}[41;13H}[42;9H}[43dstage('Deploy using Helm') {[44;13Hsteps {[45;17HwithCredentials([string(credentialsId: 'k8s-sa-token', variable: 'K8S_TOKEN')]) {[46;21Hdir('exam/src/mychart') {[47;25Hscript {[48;29Hecho "Deploying Helm chart with image tag: ${appVersion}"[49;29Hsh """[50;29Hhelm upgrade --install petclinic-app . \[51;33H--set image.repository=apkerigz/devops \[52;33H--set image.tag=${appVersion} \[2d[?12l[?25h[?25l[1;112H(B[0;7m*[203G(B[m[2;53r[53;1H
[1;55r[52;33H--kube-token=$K8S_TOKEN[K[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;29H"""[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;25H}[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;21H}[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;17H}[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;13H}[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;9H}[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;9Hstage('Run Ansible Playbook') {[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;13Hsteps {[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;17Hdir('exam/src') {[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;21Hscript {[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;25H// Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¸Ðµ ansible.cfg Ð´Ð»Ñ ÑƒÐºÐ°Ð·Ð°Ð½Ð¸Ñ Ð¿ÑƒÑ‚Ð¸ Ðº ÐºÐ¾Ð»Ð»ÐµÐºÑ†Ð¸ÑÐ¼[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;25Hsh '''[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;25Hecho "[defaults]" > ansible.cfg[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;25Hecho "collections_paths = /home/rsshabanov/.ansible/collections:/usr/share/ansible/collections" >> ansible.cfg[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;25H'''[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;25H// Ð£ÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐ° ÐºÐ¾Ð»Ð»ÐµÐºÑ†Ð¸Ð¸ Ð¸ Ð·Ð°Ð¿ÑƒÑÐº Ð¿Ð»ÐµÐ¹Ð±ÑƒÐºÐ°[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;25Hsh 'ansible-galaxy collection install kubernetes.core'[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;25Hsh 'ansible-playbook -i inventory monitoring_playbook.yml --ask-become-pass'[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;21H}[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;17H}[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;13H}[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;9H}[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;5H}[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;1H}[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[K[?12l[?25h[?25l[53;93H(B[0;7m[ Nothing was cut ](B[m[?12l[?25h[2d[?25l[53;112H[?12l[?25h[2d[?25l[53;112H[?12l[?25h[2d[?25l[53;112H[?12l[?25h[2d[?25l[53;112H[?12l[?25h[2d[?25l[53;112H[?12l[?25h[2d[?25l[53;112H[?12l[?25h[2d[?25l[53;112H[?12l[?25h[2d[?25l[2;29H"""[3;25H}[4;21H}[5;17H}[6;13H}[7;9H}[8dstage('Run Ansible Playbook') {[9;13Hsteps {[10;17Hdir('exam/src') {[11;21Hscript {[12;25H// Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¸Ðµ ansible.cfg Ð´Ð»Ñ ÑƒÐºÐ°Ð·Ð°Ð½Ð¸Ñ Ð¿ÑƒÑ‚Ð¸ Ðº ÐºÐ¾Ð»Ð»ÐµÐºÑ†Ð¸ÑÐ¼[13;25Hsh '''[14;25Hecho "[defaults]" > ansible.cfg[15;25Hecho "collections_paths = /home/rsshabanov/.ansible/collections:/usr/share/ansible/collections" >> ansible.cfg[16;25H'''[18;25H// Ð£ÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐ° ÐºÐ¾Ð»Ð»ÐµÐºÑ†Ð¸Ð¸ Ð¸ Ð·Ð°Ð¿ÑƒÑÐº Ð¿Ð»ÐµÐ¹Ð±ÑƒÐºÐ° Ñ Ð¿ÐµÑ€ÐµÐ´Ð°Ñ‡ÐµÐ¹ sudo-Ð¿Ð°Ñ€Ð¾Ð»Ñ Ñ‡ÐµÑ€ÐµÐ· Ð¿ÐµÑ€ÐµÐ¼ÐµÐ½Ð½ÑƒÑŽ[19;25Hsh 'ansible-galaxy collection install kubernetes.core'[20;25Hsh "ansible-playbook -i inventory monitoring_playbook.yml --extra-vars 'ansible_become_pass=${BECOME_PASSWORD}'"[21;21H}[22;17H}[23;13H}[24;9H}[25;5H}[26d}[53d[K[27d[?12l[?25h[?25l[?12l[?25h[18d[?25l[2dpipeline {[K[3;5Hagent any[K[4d[K[5;5Henvironment {[6;9HappVersion = readFile('exam/src/VERSION').trim()[7;9HBECOME_PASSWORD = credentials('your-sudo-password-id')  // Ð—Ð°Ð¼ÐµÐ½Ð¸Ñ‚Ðµ Ð½Ð° ID Jenkins Credentials Ð´Ð»Ñ sudo Ð¿Ð°Ñ€Ð¾Ð»Ñ[8;5H}[K[9d[K[10;5Hstages {[K[11;9Hstage('Checkout') {[K[12;13Hsteps {[K[13;17Hgit branch: 'exam', url: '[94mhttps://github.com/Roma-uuu/codeby-devops.git'[14;13H[39m(B[m}[K[15;9H}[K[16dstage('Build') {[K[17;13Hsteps {[18;17Hdir('exam/src') {[K[19;21Hsh 'mvn clean package -Dcheckstyle.skip=true'[K[20;17H}[K[21;13H}[K[22;9H}[K[23dstage('Test Docker Access') {[24;9H    steps {[25;16H[1K sh 'docker info'[26;12H[1K }[27;9H}[28dstage('Build and Push Docker Image') {[29;13Hsteps {[30;17Hdir('exam/src') {[31;21Hscript {[32;25Hecho "Building Docker image with tag: ${appVersion}"[33;25HwithCredentials([usernamePassword(credentialsId: 'dockerhub-credentials', usernameVariable: 'DOCKERHUB_USERNAME', passwordVariable: 'DOCKERHUB_TOKEN')]) {[34;29Hsh """[35;29Hecho $DOCKERHUB_TOKEN | docker login -u $DOCKERHUB_USERNAME --password-stdin[36;29Hdocker build -t apkerigz/devops:${appVersion} .[37;29Hdocker push apkerigz/devops:${appVersion}[38;29H"""[39;25H}[40;21H}[41;17H}[42;13H}[43;9H}[44dstage('Deploy using Helm') {[45;13Hsteps {[46;17HwithCredentials([string(credentialsId: 'k8s-sa-token', variable: 'K8S_TOKEN')]) {[47;21Hdir('exam/src/mychart') {[48;25Hscript {[49;29Hecho "Deploying Helm chart with image tag: ${appVersion}"[50;29Hsh """[51;29Hhelm upgrade --install petclinic-app . \[52;33H--set image.repository=apkerigz/devops \[10d[?12l[?25h[?25l[?12l[?25h[5d[?25l[?12l[?25h[2d[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[3d[?25l[?12l[?25h[4d[?25l[?12l[?25h[5d[?25l[?12l[?25h[6d[?25l[?12l[?25h[7d[?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25hB[?25l[?12l[?25hE[?25l[?12l[?25hC[?25l[?12l[?25hO[?25l[?12l[?25hM[?25l[?12l[?25hE[?25l[?12l[?25h_[?25l[?12l[?25hP[?25l[?12l[?25hA[?25l[?12l[?25hS[?25l[?12l[?25hS[?25l[?12l[?25hW[?25l[?12l[?25hO[?25l[?12l[?25hR[?25l[?12l[?25hD[?25l[?12l[?25h [?25l[?12l[?25h=[?25l[?12l[?25h [?25l[?12l[?25hc[?25l[?12l[?25hr[?25l[?12l[?25he[?25l[?12l[?25hd[?25l[?12l[?25he[?25l[?12l[?25hn[?25l[?12l[?25ht[?25l[?12l[?25hi[?25l[?12l[?25ha[?25l[?12l[?25hl[?25l[?12l[?25hs[?25l[?12l[?25h([?25l[?12l[?25h'[?25l[?12l[?25hy[?25l[?12l[?25ho[?25l[?12l[?25hu[?25l[?12l[?25hr[?25l[?12l[?25h-[?25l[?12l[?25hs[?25l[?12l[?25hu[?25l[?12l[?25hd[?25l[?12l[?25ho[?25l[?12l[?25h-[?25l[?12l[?25hp[?25l[?12l[?25ha[?25l[?12l[?25hs[?25l[?12l[?25hs[?25l[?12l[?25hw[?25l[?12l[?25ho[?25l[?12l[?25hr[?25l[?12l[?25hd[?25l[?12l[?25h-[?25l[?12l[?25hi[?25l[?12l[?25hd[?25l[?12l[?25h[1P[?25l[?12l[?25h[1P[?25l[?12l[?25h[1P[?25l[?12l[?25h[1P[?25l[?12l[?25h[1P[?25l[?12l[?25h[1P[?25l[?12l[?25h[1P[?25l[?12l[?25h[1Ps[?25l[?12l[?25h[1P[?25l[?12l[?25h[1P[?25l[?12l[?25h[1P[?25l[?12l[?25h[1P[?25l[?12l[?25h[1P[?25l[?12l[?25h[1P[?25l[?12l[?25h[1P[?25l[?12l[?25h[1P[?25l[?12l[?25h[1P[?25l[?12l[?25h[1P[?25l[?12l[?25h[1P[?25l[?12l[?25h[1P[?25l[?12l[?25h[1P[?25l[?12l[?25hf')  // Ð—Ð°Ð¼ÐµÐ½Ð¸Ñ‚Ðµ Ð½Ð° ID Jenkins Credentials Ð´Ð»Ñ sudo Ð¿Ð°Ñ€Ð¾Ð»Ñ[7;41H[?25l[?12l[?25ho')  // Ð—Ð°Ð¼ÐµÐ½Ð¸Ñ‚Ðµ Ð½Ð° ID Jenkins Credentials Ð´Ð»Ñ sudo Ð¿Ð°Ñ€Ð¾Ð»Ñ[7;42H[?25l[?12l[?25hr')  // Ð—Ð°Ð¼ÐµÐ½Ð¸Ñ‚Ðµ Ð½Ð° ID Jenkins Credentials Ð´Ð»Ñ sudo Ð¿Ð°Ñ€Ð¾Ð»Ñ[7;43H[?25l[?12l[?25h_')  // Ð—Ð°Ð¼ÐµÐ½Ð¸Ñ‚Ðµ Ð½Ð° ID Jenkins Credentials Ð´Ð»Ñ sudo Ð¿Ð°Ñ€Ð¾Ð»Ñ[7;44H[?25l[?12l[?25ha')  // Ð—Ð°Ð¼ÐµÐ½Ð¸Ñ‚Ðµ Ð½Ð° ID Jenkins Credentials Ð´Ð»Ñ sudo Ð¿Ð°Ñ€Ð¾Ð»Ñ[7;45H[?25l[?12l[?25hn')  // Ð—Ð°Ð¼ÐµÐ½Ð¸Ñ‚Ðµ Ð½Ð° ID Jenkins Credentials Ð´Ð»Ñ sudo Ð¿Ð°Ñ€Ð¾Ð»Ñ[7;46H[?25l[?12l[?25hs')  // Ð—Ð°Ð¼ÐµÐ½Ð¸Ñ‚Ðµ Ð½Ð° ID Jenkins Credentials Ð´Ð»Ñ sudo Ð¿Ð°Ñ€Ð¾Ð»Ñ[7;47H[?25l[?12l[?25hi')  // Ð—Ð°Ð¼ÐµÐ½Ð¸Ñ‚Ðµ Ð½Ð° ID Jenkins Credentials Ð´Ð»Ñ sudo Ð¿Ð°Ñ€Ð¾Ð»Ñ[7;48H[?25l[?12l[?25hb')  // Ð—Ð°Ð¼ÐµÐ½Ð¸Ñ‚Ðµ Ð½Ð° ID Jenkins Credentials Ð´Ð»Ñ sudo Ð¿Ð°Ñ€Ð¾Ð»Ñ[7;49H[?25l[?12l[?25hl')  // Ð—Ð°Ð¼ÐµÐ½Ð¸Ñ‚Ðµ Ð½Ð° ID Jenkins Credentials Ð´Ð»Ñ sudo Ð¿Ð°Ñ€Ð¾Ð»Ñ[7;50H[?25l[?12l[?25he')  // Ð—Ð°Ð¼ÐµÐ½Ð¸Ñ‚Ðµ Ð½Ð° ID Jenkins Credentials Ð´Ð»Ñ sudo Ð¿Ð°Ñ€Ð¾Ð»Ñ[7;51H[?25l[?12l[?25h[8;6H[?25l[?12l[?25h[9d[?25l[?12l[?25h[10;13H[?25l[?12l[?25h[11;28H[?25l[?12l[?25h[12;20H[?25l[?12l[?25h[13;51H[?25l[?12l[?25h[14;14H[?25l[?12l[?25h[15;10H[?25l[?12l[?25h[16;25H[?25l[?12l[?25h[17;20H[?25l[?12l[?25h[18;34H[?25l[?12l[?25h[19;51H[?25l[?12l[?25h[20;18H[?25l[?12l[?25h[21;14H[?25l[?12l[?25h[22;10H[?25l[?12l[?25h[23;38H[?25l[?12l[?25h[24;20H[?25l[?12l[?25h[25;33H[?25l[?12l[?25h[26;14H[?25l[?12l[?25h[27;10H[?25l[?12l[?25h[28;47H[?25l[?12l[?25h[29;20H[?25l[?12l[?25h[30;34H[?25l[?12l[?25h[31;29H[?25l[?12l[?25h[32;51H[?25l[?12l[?25h[33d[?25l[?12l[?25h[34;35H[?25l[?12l[?25h[35;51H[?25l[?12l[?25h[36d[?25l[?12l[?25h[37d[?25l[?12l[?25h[38;32H[?25l[?12l[?25h[39;26H[?25l[?12l[?25h[40;22H[?25l[?12l[?25h[41;18H[?25l[?12l[?25h[42;14H[?25l[?12l[?25h[43;10H[?25l[?12l[?25h[44;37H[?25l[?12l[?25h[45;20H[?25l[?12l[?25h[46;51H[?25l[?12l[?25h[47;46H[?25l[?12l[?25h[48;33H[?25l[?12l[?25h[49;51H[?25l[?12l[?25h[50;35H[?25l[?12l[?25h[51;51H[?25l[?12l[?25h[52d[?25l[?12l[?25h7[2;53r8[53d
[1;55r[52;33H--set image.tag=${appVersion} \[52;51H[?25l[?12l[?25h7[2;53r8[53d
[1;55r[52;33H--kube-token=$K8S_TOKEN[51G[?25l[?12l[?25h7[2;53r8[53d
[1;55r[52;29H"""[?25l[?12l[?25h7[2;53r8[53d
[1;55r[52;25H}[?25l[?12l[?25h7[2;53r8[53d
[1;55r[52;21H}[?25l[?12l[?25h7[2;53r8[53d
[1;55r[52;17H}[?25l[?12l[?25h7[2;53r8[53d
[1;55r[52;13H}[?25l[?12l[?25h7[2;53r8[53d
[1;55r[52;9H}[?25l[?12l[?25h7[2;53r8[53d
[1;55r[52;9Hstage('Run Ansible Playbook') {[?25l[?12l[?25h7[2;53r8[53d
[1;55r[52;13Hsteps {[?25l[?12l[?25h7[2;53r8[53d
[1;55r[52;17Hdir('exam/src') {[?25l[?12l[?25h7[2;53r8[53d
[1;55r[52;21Hscript {[?25l[?12l[?25h7[2;53r8[53d
[1;55r[52;25H// Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¸Ðµ ansible.cfg Ð´Ð»Ñ ÑƒÐºÐ°Ð·Ð°Ð½Ð¸Ñ Ð¿ÑƒÑ‚Ð¸ Ðº ÐºÐ¾Ð»Ð»ÐµÐºÑ†Ð¸ÑÐ¼[52;51H[?25l[?12l[?25h7[2;53r8[53d
[1;55r[52;25Hsh '''[?25l[?12l[?25h7[2;53r8[53d
[1;55r[52;25Hecho "[defaults]" > ansible.cfg[51G[?25l[?12l[?25h7[2;53r8[53d
[1;55r[52;25Hecho "collections_paths = /home/rsshabanov/.ansible/collections:/usr/share/ansible/collections" >> ansible.cfg[52;51H[?25l[?12l[?25h7[2;53r8[53d
[1;55r[52;25H'''[?25l[?12l[?25h7[2;53r8[53d
[1;55r[52;1H[?25l[?12l[?25h7[2;53r8[53d
[1;55r[52;25H// Ð£ÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐ° ÐºÐ¾Ð»Ð»ÐµÐºÑ†Ð¸Ð¸ Ð¸ Ð·Ð°Ð¿ÑƒÑÐº Ð¿Ð»ÐµÐ¹Ð±ÑƒÐºÐ° Ñ Ð¿ÐµÑ€ÐµÐ´Ð°Ñ‡ÐµÐ¹ sudo-Ð¿Ð°Ñ€Ð¾Ð»Ñ Ñ‡ÐµÑ€ÐµÐ· Ð¿ÐµÑ€ÐµÐ¼ÐµÐ½Ð½ÑƒÑŽ[52;51H[?25l[?12l[?25h7[2;53r8[53d
[1;55r[52;25Hsh 'ansible-galaxy collection install kubernetes.core'[52;51H[?25l[?12l[?25h7[2;53r8[53d
[1;55r[52;25Hsh "ansible-playbook -i inventory monitoring_playbook.yml --extra-vars 'ansible_become_pass=${BECOME_PASSWORD}'"[52;51H[?25l[?12l[?25h7[2;53r8[53d
[1;55r[52;21H}[?25l[?12l[?25h7[2;53r8[53d
[1;55r[52;17H}[?25l[?12l[?25h7[2;53r8[53d
[1;55r[52;13H}[?25l[?12l[?25h7[2;53r8[53d
[1;55r[52;9H}[?25l[?12l[?25h7[2;53r8[53d
[1;55r[52;5H}[?25l[?12l[?25h7[2;53r8[53d
[1;55r[52;1H}[?25l[?12l[?25h7[2;53r8[53d
[1;55r[52;1H[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[A}[?25l[?12l[?25h[A   }[?25l[?12l[?25h[A   }[?25l[?12l[?25h[A   }[?25l[?12l[?25h[A   }[?25l[?12l[?25h[A   }[?25l[?12l[?25h[45;51H[?25l[?12l[?25h[A[?25l[?12l[?25h[A[?25l[?12l[?25h[A[?25l[?12l[?25h[43;51H[?25l[43;53r[53;1H
[1;55r[43;1H[?12l[?25h[?25l[?12l[?25h[A[?25l[?12l[?25h[A[?25l[?12l[?25h[A[?25l[?12l[?25h[A[?25l[?12l[?25h[A[?25l[?12l[?25h[A[?25l[?12l[?25h[A[?25l[?12l[?25h[A[?25l[?12l[?25h[A[?25l[?12l[?25h[A[?25l[?12l[?25h[A[?25l[?12l[?25h[A[?25l[?12l[?25h[A[?25l[?12l[?25h[A[?25l[?12l[?25h[A[?25l[?12l[?25h[A[?25l[?12l[?25h[A[?25l[?12l[?25h[A[?25l[?12l[?25h[A[?25l[?12l[?25h[A[?25l[?12l[?25h[A[?25l[?12l[?25h[A[?25l[?12l[?25h[A[?25l[?12l[?25h[A[?25l[?12l[?25h[A[?25l[?12l[?25h[A[?25l[?12l[?25h[A[?25l[?12l[?25h[A[?25l[?12l[?25h[A[?25l[?12l[?25h[A[?25l[?12l[?25h[A[?25l[?12l[?25h[A[?25l[?12l[?25h[A[?25l[?12l[?25h[A[?25l[?12l[?25h[A[?25l[?12l[?25h[A[?25l[?12l[?25h[A[?25l[?12l[?25h[A[?25l[?12l[?25h[A[?25l[?12l[?25h[A[?25l[?12l[?25h[A[?25l[?12l[?25h7[2;53r8M[1;55r[2;13Hsteps {[?25l[?12l[?25h7[2;53r8M[1;55r[2;9Hstage('Build and Push Docker Image') {[?25l[?12l[?25h7[2;52r8M[1;55r[2;9H}[?25l[?12l[?25h7[2;52r8M[1;55r[2;13H}[?25l[?12l[?25h7[2;52r8M[1;55r[2;17Hsh 'docker info'[?25l[?12l[?25h7[2;52r8M[1;55r[2;13Hsteps {[?25l[?12l[?25h7[2;52r8M[1;55r[2;9Hstage('Test Docker Access') {[?25l[?12l[?25h7[2;52r8M[1;55r[2;9H}[?25l[?12l[?25h7[2;52r8M[1;55r[2;13H}[?25l[?12l[?25h7[2;52r8M[1;55r[2;17H}[?25l[?12l[?25h7[2;53r8M[1;55r[2;21Hsh 'mvn clean package -Dcheckstyle.skip=true'[?25l[?12l[?25h7[2;52r8M[1;55r[2;17Hdir('exam/src') {[?25l[?12l[?25h7[2;52r8M[1;55r[2;13Hsteps {[?25l[?12l[?25h7[2;52r8M[1;55r[2;9Hstage('Build') {[?25l[?12l[?25h7[2;52r8M[1;55r[2;9H}[?25l[?12l[?25h7[2;52r8M[1;55r[2;13H}[?25l[?12l[?25h7[2;52r8M[1;55r[2;17Hgit branch: 'exam', url: '[94mhttps://github.com/Roma-uuu/codeby-devops.git'[39m(B[m[?25l[?12l[?25h7[2;52r8M[1;55r[2;13Hsteps {[?25l[?12l[?25h7[2;52r8M[1;55r[2;9Hstage('Checkout') {[?25l[?12l[?25h7[2;52r8M[1;55r[2;5Hstages {[?25l[?12l[?25h7[2;52r8M[1;55r[2;1H[?25l[?12l[?25h7[2;52r8M[1;55r[2;5H}[?25l[?12l[?25h7[2;52r8M[1;55r[2;9HBECOME_PASSWORD = credentials('for_ansible')  // Ð—Ð°Ð¼ÐµÐ½Ð¸Ñ‚Ðµ Ð½Ð° ID Jenkins Credentials Ð´Ð»Ñ sudo Ð¿Ð°Ñ€Ð¾Ð»Ñ[?25l[?12l[?25h7[2;52r8M[1;55r[2;9HappVersion = readFile('exam/src/VERSION').trim()[?25l[?12l[?25h7[2;52r8M[1;55r[2;5Henvironment {[?25l[?12l[?25h7[2;52r8M[1;55r[2;1H[?25l[?12l[?25h7[2;52r8M[1;55r[2;5Hagent any[?25l[?12l[?25h7[2;52r8M[1;55r[2;1Hpipeline {[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[3d[?25l[?12l[?25h[4d[?25l[?12l[?25h[5d[?25l[?12l[?25h[6d[?25l[?12l[?25h[7d[?25l[?12l[?25h[8d[?25l[?12l[?25h [?25l[?12l[?25h[A[?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25hB[?25l[?12l[?25hE[?25l[?12l[?25hC[?25l[?12l[?25hO[?25l[?12l[?25hM[?25l[?12l[?25hE[?25l[?12l[?25h_[?25l[?12l[?25hP[?25l[?12l[?25hA[?25l[?12l[?25hS[?25l[?12l[?25hS[?25l[?12l[?25hW[?25l[?12l[?25hO[?25l[?12l[?25hR[?25l[?12l[?25hD[?25l[?12l[?25h [?25l[?12l[?25h=[?25l[?12l[?25h [?25l[?12l[?25hc[?25l[?12l[?25hr[?25l[?12l[?25he[?25l[?12l[?25hd[?25l[?12l[?25he[?25l[?12l[?25hn[?25l[?12l[?25ht[?25l[?12l[?25hi[?25l[?12l[?25ha[?25l[?12l[?25hl[?25l[?12l[?25hs[?25l[?12l[?25h([?25l[?12l[?25h'[?25l[?12l[?25hf[?25l[?12l[?25ho[?25l[?12l[?25hr[?25l[?12l[?25h_[?25l[?12l[?25ha[?25l[?12l[?25hn[?25l[?12l[?25hs[?25l[?12l[?25hi[?25l[?12l[?25hb[?25l[?12l[?25hl[?25l[?12l[?25he[?25l[?12l[?25h'[?25l[?12l[?25h)[?25l[?12l[?25h[1P[?25l[?12l[?25h[1P[?25l[?12l[?25h[1P[?25l[?12l[?25h[1P[?25l[?12l[?25h[1P[?25l[?12l[?25h[1P[?25l[?12l[?25h[1P[?25l[?12l[?25h[1P[?25l[?12l[?25h[1P[?25l[?12l[?25h[1P[?25l[?12l[?25h[1P[?25l[?12l[?25h[1P[?25l[?12l[?25h[1P[?25l[?12l[?25h[1P[?25l[?12l[?25h[1P[?25l[?12l[?25h[1P[?25l[?12l[?25h[1P[?25l[?12l[?25h[1P[?25l[?12l[?25h[1P[?25l[?12l[?25h[1P[?25l[?12l[?25h[1P[?25l[?12l[?25h[1P[?25l[?12l[?25h[1P[?25l[?12l[?25h[1P[?25l[?12l[?25h[1P[?25l[?12l[?25h[1P[?25l[?12l[?25h[1P[?25l[?12l[?25h[1P[?25l[?12l[?25h[1P[?25l[?12l[?25h[1P[?25l[?12l[?25h[1P[?25l[?12l[?25h[1P[?25l[?12l[?25h[1P[?25l[?12l[?25h[1P[?25l[?12l[?25h[1P[?25l[?12l[?25h[1P[?25l[?12l[?25h[1P[?25l[?12l[?25h[1P[?25l[?12l[?25h[1P[?25l[?12l[?25h[1P[?25l[?12l[?25h[1P[?25l[?12l[?25h[1P[?25l[?12l[?25h[1P[?25l[?12l[?25h[1P[?25l[?12l[?25h[1P[?25l[?12l[?25h[1P[?25l[?12l[?25h[1P[?25l[?12l[?25h[1P[?25l[?12l[?25h[1P[?25l[?12l[?25hÐ°Ñ€Ð¾Ð»Ñ[K[53G[?25l[?12l[?25hÑ€Ð¾Ð»Ñ[K[?25l[?12l[?25hÐ¾Ð»Ñ[K[?25l[?12l[?25hÐ»Ñ[K[?25l[?12l[?25hÑ[K[?25l[?12l[?25h [?25l[53d(B[0;7mSave modified buffer?                                                                                                                                                                                       [54;1H Y(B[m Yes[K[55d(B[0;7m N(B[m No  [55;17H(B[0;7m^C(B[m Cancel[K[53;23H[?12l[?25h[?25l[54d(B[0;7m^G(B[m Help[54;52H(B[0;7mM-D(B[m DOS Format[54;103H(B[0;7mM-A(B[m Append[54;154H(B[0;7mM-B(B[m Backup File[55d(B[0;7m^C(B[m Cancel[17G         [55;52H(B[0;7mM-M(B[m Mac Format[55;103H(B[0;7mM-P(B[m Prepend[55;154H(B[0;7m^T(B[m Browse[53d(B[0;7mFile Name to Write: Jenkinsfile(B[m[?12l[?25h[?25l[53;95H[1K (B[0;7m[ Writing... ](B[m[K[1;112H(B[0;7m [203G(B[m[53;94H(B[0;7m[ Wrote 77 lines ](B[m[J[55d[?12l[?25h[55;1H[?1049l[23;0;0t[?1l>[?2004l[?2004h]0;rsshabanov@MSK-01: ~/codeby-devops/exam/src[01;32mrsshabanov@MSK-01[00m:[01;34m~/codeby-devops/exam/src[00m$ git add ../src/
[?2004l[?2004h]0;rsshabanov@MSK-01: ~/codeby-devops/exam/src[01;32mrsshabanov@MSK-01[00m:[01;34m~/codeby-devops/exam/src[00m$ git add ../src/[K
[?2004l[?2004h]0;rsshabanov@MSK-01: ~/codeby-devops/exam/src[01;32mrsshabanov@MSK-01[00m:[01;34m~/codeby-devops/exam/src[00m$ git commit -m ''e'd'i't'e' '[1P'e'[1P'd' 'J'e'n'k'i'n's'f'i'l'e'[C'
[?2004l[?2004h> ^C[?2004l[?2004h[?2004l
[?2004h]0;rsshabanov@MSK-01: ~/codeby-devops/exam/src[01;32mrsshabanov@MSK-01[00m:[01;34m~/codeby-devops/exam/src[00m$ git commit -m 'edited Jenkinsfile''[K
[?2004l[exam 4f2bad8] edited Jenkinsfile
 2 files changed, 259 insertions(+), 3 deletions(-)
[?2004h]0;rsshabanov@MSK-01: ~/codeby-devops/exam/src[01;32mrsshabanov@MSK-01[00m:[01;34m~/codeby-devops/exam/src[00m$ git push codeby-devops
[?2004lEnumerating objects: 11, done.
Counting objects:   9% (1/11)Counting objects:  18% (2/11)Counting objects:  27% (3/11)Counting objects:  36% (4/11)Counting objects:  45% (5/11)Counting objects:  54% (6/11)Counting objects:  63% (7/11)Counting objects:  72% (8/11)Counting objects:  81% (9/11)Counting objects:  90% (10/11)Counting objects: 100% (11/11)Counting objects: 100% (11/11), done.
Delta compression using up to 6 threads
Compressing objects:  20% (1/5)Compressing objects:  40% (2/5)Compressing objects:  60% (3/5)Compressing objects:  80% (4/5)Compressing objects: 100% (5/5)Compressing objects: 100% (5/5), done.
Writing objects:  16% (1/6)Writing objects:  33% (2/6)Writing objects:  50% (3/6)Writing objects:  66% (4/6)Writing objects:  83% (5/6)Writing objects: 100% (6/6)Writing objects: 100% (6/6), 12.90 KiB | 6.45 MiB/s, done.
Total 6 (delta 2), reused 0 (delta 0), pack-reused 0
remote: Resolving deltas:   0% (0/2)[Kremote: Resolving deltas:  50% (1/2)[Kremote: Resolving deltas: 100% (2/2)[Kremote: Resolving deltas: 100% (2/2), completed with 2 local objects.[K
To github.com:Roma-uuu/codeby-devops.git
   9ac10e3..4f2bad8  exam -> exam
[?2004h]0;rsshabanov@MSK-01: ~/codeby-devops/exam/src[01;32mrsshabanov@MSK-01[00m:[01;34m~/codeby-devops/exam/src[00m$ [7msudo visudo[27m
[A[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[Csudo visudo
[K[A[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C
[?2004l[?2004h[?1049h[22;0;0t[1;55r(B[m[4l[?7h[39;49m[?1h=[?1h=[?25l[39;49m(B[m[H[2J[53;96H(B[0;7m[ Reading... ](B[m[53;94H(B[0;7m[ Read 55 lines ](B[m[H(B[0;7m  GNU nano 6.2                                                                                  /etc/sudoers.tmp                                                                                            [1;203H(B[m[54d(B[0;7m^G(B[m Help[54;18H(B[0;7m^O(B[m Write Out     (B[0;7m^W(B[m Where Is[52G(B[0;7m^K(B[m Cut[54;69H(B[0;7m^T(B[m Execute[86G(B[0;7m^C(B[m Location[103G(B[0;7mM-U(B[m Undo[54;120H(B[0;7mM-A(B[m Set Mark     (B[0;7mM-](B[m To Bracket   (B[0;7mM-Q(B[m Previous     (B[0;7m^B(B[m Back[54;188H(B[0;7m^â—‚(B[m Prev Word[55d(B[0;7m^X(B[m Exit[55;18H(B[0;7m^R(B[m Read File     (B[0;7m^\(B[m Replace[52G(B[0;7m^U(B[m Paste[55;69H(B[0;7m^J(B[m Justify[86G(B[0;7m^/(B[m Go To Line    (B[0;7mM-E(B[m Redo[55;120H(B[0;7mM-6(B[m Copy[55;137H(B[0;7m^Q(B[m Where Was     (B[0;7mM-W(B[m Next[55;171H(B[0;7m^F(B[m Forward[188G(B[0;7m^â–¸(B[m Next Word[2d[36m#[3d# This file MUST be edited with the 'visudo' command as root.[4d#[5d# Please consider adding local content in /etc/sudoers.d/ instead of[6d# directly modifying this file.[7d#[8d# See the man page for details on how to write a sudoers file.[9d#[10d[39m(B[mDefaults[38;5;208m        [39m(B[menv_reset[11dDefaults[38;5;208m        [39m(B[mmail_badpass[12dDefaults[38;5;208m        [39m(B[msecure_path="/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/snap/bin"[13dDefaults[38;5;208m        [39m(B[muse_pty[15d[36m# This preserves proxy settings from user environments of root[16d# equivalent users (group sudo)[17d#Defaults:%sudo env_keep += "http_proxy https_proxy ftp_proxy all_proxy no_proxy"[19d# This allows running arbitrary commands, but so does ALL, and it means[20d# different sudoers have their choice of editor respected.[21d#Defaults:%sudo env_keep += "EDITOR"[23d# Completely harmless preservation of a user preference.[24d#Defaults:%sudo env_keep += "GREP_COLOR"[26d# While you shouldn't normally run git as root, you need to with etckeeper[27d#Defaults:%sudo env_keep += "GIT_AUTHOR_* GIT_COMMITTER_*"[29d# Per-user preferences; root won't have sensible values for them.[30d#Defaults:%sudo env_keep += "EMAIL DEBEMAIL DEBFULLNAME"[32d# "sudo scp" or "sudo rsync" should be able to use your SSH agent.[33d#Defaults:%sudo env_keep += "SSH_AGENT_PID SSH_AUTH_SOCK"[35d# Ditto for GPG agent[36d#Defaults:%sudo env_keep += "GPG_AGENT_INFO"[38d# Host alias specification[40d# User alias specification[42d# Cmnd alias specification[44d# User privilege specification[45d[39m(B[mroot[38;5;208m    [39m(B[mALL=(ALL:ALL) ALL[46drsshabanov ALL=(ALL) NOPASSWD:ALL[48d[36m# Members of the admin group may gain root privileges[49d[39m(B[m%admin ALL=(ALL) ALL[51d[36m# Allow members of group sudo to execute any command[52d[39m(B[m%sudo[38;5;208m   [39m(B[mALL=(ALL:ALL) ALL[2d[?12l[?25h[?25l[?12l[?25h[3d[?25l[?12l[?25h[4d[?25l[?12l[?25h[5d[?25l[?12l[?25h[6d[?25l[?12l[?25h[7d[?25l[?12l[?25h[8d[?25l[?12l[?25h[9d[?25l[?12l[?25h[10d[?25l[?12l[?25h[11d[?25l[?12l[?25h[12d[?25l[?12l[?25h[13d[?25l[?12l[?25h[14d[?25l[?12l[?25h[15d[?25l[?12l[?25h[16d[?25l[?12l[?25h[17d[?25l[?12l[?25h[18d[?25l[?12l[?25h[19d[?25l[?12l[?25h[20d[?25l[?12l[?25h[21d[?25l[53d[K[?12l[?25h[22d[?25l[?12l[?25h[23d[?25l[?12l[?25h[24d[?25l[?12l[?25h[25d[?25l[?12l[?25h[26d[?25l[?12l[?25h[27d[?25l[?12l[?25h[28d[?25l[?12l[?25h[29d[?25l[?12l[?25h[30d[?25l[?12l[?25h[31d[?25l[?12l[?25h[32d[?25l[?12l[?25h[33d[?25l[?12l[?25h[34d[?25l[?12l[?25h[35d[?25l[?12l[?25h[36d[?25l[?12l[?25h[37d[?25l[?12l[?25h[38d[?25l[?12l[?25h[39d[?25l[?12l[?25h[40d[?25l[?12l[?25h[41d[?25l[?12l[?25h[42d[?25l[?12l[?25h[43d[?25l[?12l[?25h[44d[?25l[?12l[?25h[45d[?25l[?12l[?25h[46d[?25l[?12l[?25h[47d[?25l[?12l[?25h[48d[?25l[?12l[?25h[A[?25l[?12l[?25h[A[?25l[?12l[?25h[47d[?25l[?12l[?25h[A[?25l[?12l[?25h[47d[?25l[1;114H(B[0;7m*[203G(B[m[47;52r[47;1HM[1;55r[48;1H[?12l[?25h[?25l[?12l[?25h[A[?25ljenkins ALL=(ALL) NOPASSWD: ALL[?12l[?25h[?25l[53d(B[0;7mSave modified buffer?                                                                                                                                                                                       [54;1H Y(B[m Yes[K[55d(B[0;7m N(B[m No  [55;17H(B[0;7m^C(B[m Cancel[K[53;23H[?12l[?25h[?25l[54d(B[0;7m^G(B[m Help[54;52H(B[0;7mM-D(B[m DOS Format[54;103H(B[0;7mM-A(B[m Append[54;154H(B[0;7mM-B(B[m Backup File[55d(B[0;7m^C(B[m Cancel[17G         [55;52H(B[0;7mM-M(B[m Mac Format[55;103H(B[0;7mM-P(B[m Prepend[55;154H(B[0;7m^T(B[m Browse[53d(B[0;7mFile Name to Write: /etc/sudoers.tmp(B[m[?12l[?25h[?25l[53;95H[1K (B[0;7m[ Writing... ](B[m[K[1;114H(B[0;7m [203G(B[m[53;94H(B[0;7m[ Wrote 56 lines ](B[m[J[55d[?12l[?25h[55;1H[?1049l[23;0;0t[?1l>[?2004l[?2004h]0;rsshabanov@MSK-01: ~/codeby-devops/exam/src[01;32mrsshabanov@MSK-01[00m:[01;34m~/codeby-devops/exam/src[00m$ sudo nano ansible.cfg 
[?2004l[?2004h[?1049h[22;0;0t[1;55r(B[m[4l[?7h[39;49m[?1h=[?1h=[?25l[39;49m(B[m[H[2J[53;96H(B[0;7m[ Reading... ](B[m[53;95H(B[0;7m[ Read 2 lines ](B[m[H(B[0;7m  GNU nano 6.2                                                                                     ansible.cfg                                                                                              [1;203H(B[m[54d(B[0;7m^G(B[m Help[54;18H(B[0;7m^O(B[m Write Out     (B[0;7m^W(B[m Where Is[52G(B[0;7m^K(B[m Cut[54;69H(B[0;7m^T(B[m Execute[86G(B[0;7m^C(B[m Location[103G(B[0;7mM-U(B[m Undo[54;120H(B[0;7mM-A(B[m Set Mark     (B[0;7mM-](B[m To Bracket   (B[0;7mM-Q(B[m Previous     (B[0;7m^B(B[m Back[54;188H(B[0;7m^â—‚(B[m Prev Word[55d(B[0;7m^X(B[m Exit[55;18H(B[0;7m^R(B[m Read File     (B[0;7m^\(B[m Replace[52G(B[0;7m^U(B[m Paste[55;69H(B[0;7m^J(B[m Justify[86G(B[0;7m^/(B[m Go To Line    (B[0;7mM-E(B[m Redo[55;120H(B[0;7mM-6(B[m Copy[55;137H(B[0;7m^Q(B[m Where Was     (B[0;7mM-W(B[m Next[55;171H(B[0;7m^F(B[m Forward[188G(B[0;7m^â–¸(B[m Next Word[2d(B[0;1m[32m[defaults][3d[39m(B[mcollections_paths = /home/rsshabanov/.ansible/collections:/usr/share/ansible/collections[A[?12l[?25h[?25l[1;203H[55;200H[H[2J(B[0;7m  GNU nano 6.2                                                                                     ansible.cfg                                                                                              [2;1H(B[0;1m[32m[defaults][3d[39m(B[mcollections_paths = /home/rsshabanov/.ansible/collections:/usr/share/ansible/collections[53;95H(B[0;7m[ Read 2 lines ][54d^G(B[m Help[54;18H(B[0;7m^O(B[m Write Out     (B[0;7m^W(B[m Where Is[52G(B[0;7m^K(B[m Cut[54;69H(B[0;7m^T(B[m Execute[86G(B[0;7m^C(B[m Location[103G(B[0;7mM-U(B[m Undo[54;120H(B[0;7mM-A(B[m Set Mark     (B[0;7mM-](B[m To Bracket   (B[0;7mM-Q(B[m Previous     (B[0;7m^B(B[m Back[54;188H(B[0;7m^â—‚(B[m Prev Word[55d(B[0;7m^X(B[m Exit[55;18H(B[0;7m^R(B[m Read File     (B[0;7m^\(B[m Replace[52G(B[0;7m^U(B[m Paste[55;69H(B[0;7m^J(B[m Justify[86G(B[0;7m^/(B[m Go To Line    (B[0;7mM-E(B[m Redo[55;120H(B[0;7mM-6(B[m Copy[55;137H(B[0;7m^Q(B[m Where Was     (B[0;7mM-W(B[m Next[55;171H(B[0;7m^F(B[m Forward[188G(B[0;7m^â–¸(B[m Next Word[?12l[?25h[2d[?25l[1;112H(B[0;7m*[203G(B[m[2;53r[53;1H
[1;55r[52;1H[K[2d[?12l[?25h[?25l[K[?12l[?25h[?25l[53;93H(B[0;7m[ Nothing was cut ](B[m[?12l[?25h[2d[?25l(B[0;1m[32m[defaults][3d[39m(B[mcollections_paths = /home/rsshabanov/.ansible/collections:/usr/share/ansible/collections[4dinterpreter_python = /usr/bin/python3[53d[K[5d[?12l[?25h[?25l[53d(B[0;7mSave modified buffer?                                                                                                                                                                                       [54;1H Y(B[m Yes[K[55d(B[0;7m N(B[m No  [55;17H(B[0;7m^C(B[m Cancel[K[53;23H[?12l[?25h[?25l[54d(B[0;7m^G(B[m Help[54;52H(B[0;7mM-D(B[m DOS Format[54;103H(B[0;7mM-A(B[m Append[54;154H(B[0;7mM-B(B[m Backup File[55d(B[0;7m^C(B[m Cancel[17G         [55;52H(B[0;7mM-M(B[m Mac Format[55;103H(B[0;7mM-P(B[m Prepend[55;154H(B[0;7m^T(B[m Browse[53d(B[0;7mFile Name to Write: ansible.cfg(B[m[?12l[?25h[?25l[53;95H[1K (B[0;7m[ Writing... ](B[m[K[1;112H(B[0;7m [203G(B[m[53;94H(B[0;7m[ Wrote 3 lines ](B[m[J[55d[?12l[?25h[55;1H[?1049l[23;0;0t[?1l>[?2004l[?2004h]0;rsshabanov@MSK-01: ~/codeby-devops/exam/src[01;32mrsshabanov@MSK-01[00m:[01;34m~/codeby-devops/exam/src[00m$ git ../[K=[K[K[K[Ka[K add ../src/[K
[?2004l[?2004h]0;rsshabanov@MSK-01: ~/codeby-devops/exam/src[01;32mrsshabanov@MSK-01[00m:[01;34m~/codeby-devops/exam/src[00m$ git commit -m ''e'd'i't'e'd' 'f'i'l'e's'
[?2004l[exam 3f510ee] edited files
 2 files changed, 24 insertions(+), 1 deletion(-)
[?2004h]0;rsshabanov@MSK-01: ~/codeby-devops/exam/src[01;32mrsshabanov@MSK-01[00m:[01;34m~/codeby-devops/exam/src[00m$ git push codeby-devops
[?2004lEnumerating objects: 11, done.
Counting objects:   9% (1/11)Counting objects:  18% (2/11)Counting objects:  27% (3/11)Counting objects:  36% (4/11)Counting objects:  45% (5/11)Counting objects:  54% (6/11)Counting objects:  63% (7/11)Counting objects:  72% (8/11)Counting objects:  81% (9/11)Counting objects:  90% (10/11)Counting objects: 100% (11/11)Counting objects: 100% (11/11), done.
Delta compression using up to 6 threads
Compressing objects:  20% (1/5)Compressing objects:  40% (2/5)Compressing objects:  60% (3/5)Compressing objects:  80% (4/5)Compressing objects: 100% (5/5)Compressing objects: 100% (5/5), done.
Writing objects:  16% (1/6)Writing objects:  33% (2/6)Writing objects:  50% (3/6)Writing objects:  66% (4/6)Writing objects:  83% (5/6)Writing objects: 100% (6/6)Writing objects: 100% (6/6), 2.39 KiB | 2.39 MiB/s, done.
Total 6 (delta 3), reused 0 (delta 0), pack-reused 0
remote: Resolving deltas:   0% (0/3)[Kremote: Resolving deltas:  33% (1/3)[Kremote: Resolving deltas:  66% (2/3)[Kremote: Resolving deltas: 100% (3/3)[Kremote: Resolving deltas: 100% (3/3), completed with 3 local objects.[K
To github.com:Roma-uuu/codeby-devops.git
   4f2bad8..3f510ee  exam -> exam
[?2004h]0;rsshabanov@MSK-01: ~/codeby-devops/exam/src[01;32mrsshabanov@MSK-01[00m:[01;34m~/codeby-devops/exam/src[00m$ [7msudo chown jenkins:jenkins /home/rsshabanov/codeby-devops/exam/src/kubeconfig-jenkins.yaml[27m
[A[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[Csudo chown jenkins:jenkins /home/rsshabanov/codeby-devops/exam/src/kubeconfig-jenkins.yaml
[A
[?2004l[?2004h]0;rsshabanov@MSK-01: ~/codeby-devops/exam/src[01;32mrsshabanov@MSK-01[00m:[01;34m~/codeby-devops/exam/src[00m$ [7msudo chmod 644 /home/rsshabanov/codeby-devops/exam/src/kubeconfig-jenkins.yaml[27m
[A[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[Csudo chmod 644 /home/rsshabanov/codeby-devops/exam/src/kubeconfig-jenkins.yaml
[A
[?2004l[?2004h]0;rsshabanov@MSK-01: ~/codeby-devops/exam/src[01;32mrsshabanov@MSK-01[00m:[01;34m~/codeby-devops/exam/src[00m$ git add ../src
[?2004l[?2004h]0;rsshabanov@MSK-01: ~/codeby-devops/exam/src[01;32mrsshabanov@MSK-01[00m:[01;34m~/codeby-devops/exam/src[00m$ git commit -m ''e'd'i't'
[?2004lOn branch exam
nothing to commit, working tree clean
[?2004h]0;rsshabanov@MSK-01: ~/codeby-devops/exam/src[01;32mrsshabanov@MSK-01[00m:[01;34m~/codeby-devops/exam/src[00m$ [K]0;rsshabanov@MSK-01: ~/codeby-devops/exam/src[01;32mrsshabanov@MSK-01[00m:[01;34m~/codeby-devops/exam/src[00m$ [K]0;rsshabanov@MSK-01: ~/codeby-devops/exam/src[01;32mrsshabanov@MSK-01[00m:[01;34m~/codeby-devops/exam/src[00m$ miini[K[K[K[K[K
[?2004l[?2004h]0;rsshabanov@MSK-01: ~/codeby-devops/exam/src[01;32mrsshabanov@MSK-01[00m:[01;34m~/codeby-devops/exam/src[00m$ 
[?2004l[?2004h]0;rsshabanov@MSK-01: ~/codeby-devops/exam/src[01;32mrsshabanov@MSK-01[00m:[01;34m~/codeby-devops/exam/src[00m$ 
[?2004l[?2004h]0;rsshabanov@MSK-01: ~/codeby-devops/exam/src[01;32mrsshabanov@MSK-01[00m:[01;34m~/codeby-devops/exam/src[00m$ minikube stop
[?2004lâœ‹  Stopping node "minikube"  ...
ðŸ›‘  Powering off "minikube" via SSH ...
ðŸ›‘  1 node stopped.
[?2004h]0;rsshabanov@MSK-01: ~/codeby-devops/exam/src[01;32mrsshabanov@MSK-01[00m:[01;34m~/codeby-devops/exam/src[00m$ minikube stop[K[Kart
[?2004lðŸ˜„  minikube v1.33.1 on Ubuntu 22.04
âœ¨  Using the docker driver based on existing profile
ðŸ‘  Starting "minikube" primary control-plane node in "minikube" cluster
ðŸšœ  Pulling base image v0.0.44 ...
ðŸ”„  Restarting existing docker container for "minikube" ...
ðŸ³  Preparing Kubernetes v1.30.0 on Docker 26.1.1 ...| WW[K[K/ WW[K[K- WW[K[K\ WW[K[K| WW[K[K/ WW[K[K- WW[K[K\ WW[K[K| WW[K[K/ WW[K[K- WW[K[K
ðŸ”Ž  Verifying Kubernetes components...
    â–ª Using image gcr.io/k8s-minikube/storage-provisioner:v5
ðŸŒŸ  Enabled addons: default-storageclass, storage-provisioner
ðŸ„  Done! kubectl is now configured to use "minikube" cluster and "default" namespace by default
[?2004h]0;rsshabanov@MSK-01: ~/codeby-devops/exam/src[01;32mrsshabanov@MSK-01[00m:[01;34m~/codeby-devops/exam/src[00m$ sudo nano Jenkinsfile 
[?2004l[sudo] password for rsshabanov: 
[?2004h[?1049h[22;0;0t[1;55r(B[m[4l[?7h[39;49m[?1h=[?1h=[?25l[39;49m(B[m[H[2J[53;96H(B[0;7m[ Reading... ](B[m[53;94H(B[0;7m[ Read 77 lines ](B[m[H(B[0;7m  GNU nano 6.2                                                                                     Jenkinsfile                                                                                              [1;203H(B[m[54d(B[0;7m^G(B[m Help[54;18H(B[0;7m^O(B[m Write Out     (B[0;7m^W(B[m Where Is[52G(B[0;7m^K(B[m Cut[54;69H(B[0;7m^T(B[m Execute[86G(B[0;7m^C(B[m Location[103G(B[0;7mM-U(B[m Undo[54;120H(B[0;7mM-A(B[m Set Mark     (B[0;7mM-](B[m To Bracket   (B[0;7mM-Q(B[m Previous     (B[0;7m^B(B[m Back[54;188H(B[0;7m^â—‚(B[m Prev Word[55d(B[0;7m^X(B[m Exit[55;18H(B[0;7m^R(B[m Read File     (B[0;7m^\(B[m Replace[52G(B[0;7m^U(B[m Paste[55;69H(B[0;7m^J(B[m Justify[86G(B[0;7m^/(B[m Go To Line    (B[0;7mM-E(B[m Redo[55;120H(B[0;7mM-6(B[m Copy[55;137H(B[0;7m^Q(B[m Where Was     (B[0;7mM-W(B[m Next[55;171H(B[0;7m^F(B[m Forward[188G(B[0;7m^â–¸(B[m Next Word[2dpipeline {[3;5Hagent any[5;5Henvironment {[6;9HappVersion = readFile('exam/src/VERSION').trim()[7;9HBECOME_PASSWORD = credentials('for_ansible')[8;5H}[10dstages {[11;9Hstage('Checkout') {[12;13Hsteps {[13;17Hgit branch: 'exam', url: '[94mhttps://github.com/Roma-uuu/codeby-devops.git'[14;13H[39m(B[m}[15;9H}[16dstage('Build') {[17;13Hsteps {[18;17Hdir('exam/src') {[19;21Hsh 'mvn clean package -Dcheckstyle.skip=true'[20;17H}[21;13H}[22;9H}[23dstage('Test Docker Access') {[24;13Hsteps {[25;17Hsh 'docker info'[26;13H}[27;9H}[28dstage('Build and Push Docker Image') {[29;13Hsteps {[30;17Hdir('exam/src') {[31;21Hscript {[32;25Hecho "Building Docker image with tag: ${appVersion}"[33;25HwithCredentials([usernamePassword(credentialsId: 'dockerhub-credentials', usernameVariable: 'DOCKERHUB_USERNAME', passwordVariable: 'DOCKERHUB_TOKEN')]) {[34;29Hsh """[35;29Hecho $DOCKERHUB_TOKEN | docker login -u $DOCKERHUB_USERNAME --password-stdin[36;29Hdocker build -t apkerigz/devops:${appVersion} .[37;29Hdocker push apkerigz/devops:${appVersion}[38;29H"""[39;25H}[40;21H}[41;17H}[42;13H}[43;9H}[44dstage('Deploy using Helm') {[45;13Hsteps {[46;17HwithCredentials([string(credentialsId: 'k8s-sa-token', variable: 'K8S_TOKEN')]) {[47;21Hdir('exam/src/mychart') {[48;25Hscript {[49;29Hecho "Deploying Helm chart with image tag: ${appVersion}"[50;29Hsh """[51;29Hhelm upgrade --install petclinic-app . \[52;33H--set image.repository=apkerigz/devops \[2d[?12l[?25h[?25l[1;112H(B[0;7m*[203G(B[m[2;53r[53;1H
[1;55r[52;33H--set image.tag=${appVersion} \[K[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;33H--kube-token=$K8S_TOKEN[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;29H"""[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;25H}[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;21H}[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;17H}[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;13H}[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;9H}[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;9Hstage('Run Ansible Playbook') {[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;13Hsteps {[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;17Hdir('exam/src') {[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;21Hscript {[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;25H// Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¸Ðµ ansible.cfg Ð´Ð»Ñ ÑƒÐºÐ°Ð·Ð°Ð½Ð¸Ñ Ð¿ÑƒÑ‚Ð¸ Ðº ÐºÐ¾Ð»Ð»ÐµÐºÑ†Ð¸ÑÐ¼[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;25Hsh '''[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;25Hecho "[defaults]" > ansible.cfg[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;25Hecho "collections_paths = /home/rsshabanov/.ansible/collections:/usr/share/ansible/collections" >> ansible.cfg[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;25H'''[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;25Hsh 'ansible-galaxy collection install kubernetes.core'[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;25Hsh "ansible-playbook -i inventory monitoring_playbook.yml --extra-vars 'ansible_become_pass=${BECOME_PASSWORD}'"[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;21H}[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;17H}[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;13H}[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;9H}[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;5H}[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;1H}[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[K[?12l[?25h[?25l[53;93H(B[0;7m[ Nothing was cut ](B[m[?12l[?25h[2d[?25l[53;112H[?12l[?25h[2d[?25l[53;112H[?12l[?25h[2d[?25l[53;112H[?12l[?25h[2d[?25l[53;112H[?12l[?25h[2d[?25l[53;112H[?12l[?25h[2d[?25l[53;112H[?12l[?25h[2d[?25l[53;112H[?12l[?25h[2d[?25l[53;112H[?12l[?25h[2d[?25l[53;112H[?12l[?25h[2d[?25l[53;112H[?12l[?25h[2d[?25l[53;112H[?12l[?25h[2d[?25l[53;112H[?12l[?25h[2d[?25l[2;9Hstatus_code: 200[4;5H- name: Add Grafana dashboard for logs and state monitoring via API[5;7Huri:[6durl: "http://{{ grafana_host_ip }}:{{ grafana_node_port }}/api/dashboards/db"[7;9Hmethod: POST[8;9Hheaders:[9;11HContent-Type: "application/json"[10;11HCookie: "{{ grafana_login_response.set_cookie }}"[11;9Hbody_format: json[12;9Hbody: |[13;11H{[14d "dashboard": {[15;15H"id": null,[16;15H"uid": "loki-logs",[17;15H"title": "Loki Logs & Application State",[18;15H"tags": ["logs", "loki", "prometheus"],[19;15H"timezone": "browser",[20;15H"schemaVersion": 16,[21;15H"version": 0,[22;15H"panels": [][23;13H},[24d"overwrite": true[25;11H}[26;9Hstatus_code: 200[53d[K[27d[?12l[?25h[?25l[?12l[?25h[4d[?25l[2;9H  {[K[3d "user": "{{ grafana_admin_user }}",[4;12H[1K "password": "{{ grafana_admin_password }}"[K[5;7H    }[6;9Hstatus_code: 200[K[7;7Hregister: grafana_login_response[8d[K[9;5H- name: Add or Update Prometheus as Grafana data source[10;7Huri:[K[11durl: "http://{{ grafana_host_ip }}:{{ grafana_node_port }}/api/datasources/name/Prometheus"[12;9Hmethod: PUT[13;9Hheaders:[14;11HContent-Type: "application/json"[15;11HCookie: "{{ grafana_login_response.set_cookie }}"[16;9Hbody_format: json[K[17;9Hbody: |[K[18;11H{[K[19d "name": "Prometheus",[K[20;13H"type": "prometheus",[K[21;13H"access": "proxy",[22;13H"url": "[94mhttp://prometheus-server.{{[39m(B[m prometheus_namespace }}.svc.cluster.local:80",[23;13H"isDefault": true[24;11H}[K[25;9Hstatus_code: 200[26d[K[27;5H- name: Add or Update Loki as Grafana data source[28;7Huri:[29durl: "http://{{ grafana_host_ip }}:{{ grafana_node_port }}/api/datasources/name/Loki"[30;9Hmethod: PUT[31;9Hheaders:[32;11HContent-Type: "application/json"[33;11HCookie: "{{ grafana_login_response.set_cookie }}"[34;9Hbody_format: json[35;9Hbody: |[36;11H{[37d "name": "Loki",[38;13H"type": "loki",[39;13H"access": "proxy",[40;13H"url": "[94mhttp://loki.{{[39m(B[m prometheus_namespace }}.svc.cluster.local:3100"[41;11H}[42;9Hstatus_code: 200[44;5H- name: Add Grafana dashboard for logs and state monitoring via API[45;7Huri:[46durl: "http://{{ grafana_host_ip }}:{{ grafana_node_port }}/api/dashboards/db"[47;9Hmethod: POST[48;9Hheaders:[49;11HContent-Type: "application/json"[50;11HCookie: "{{ grafana_login_response.set_cookie }}"[51;9Hbody_format: json[52;9Hbody: |[27d[?12l[?25h[?25l[?12l[?25h[9d[?25l[2;9Hvalues:[3;11HadminPassword: "{{ grafana_admin_password }}"[4;11Hservice:[K[5;11H  type: NodePort[6;9H    nodePort: "{{ grafana_node_port }}"[7d[K[8;5H- name: Wait for Grafana pod to be ready[9;5H  retries: 10[K[10;7Hdelay: 30[11;7Hkubernetes.core.k8s_info:[K[12;9Hkubeconfig: "{{ kubeconfig_path }}"[13;9Hkind: Pod[14;9Hnamespace: "{{ prometheus_namespace }}"[15;9Hlabel_selectors:[K[16;9H  - app.kubernetes.io/name=grafana[17;7Hregister: grafana_pods[18;7Huntil: >[19;9Hgrafana_pods.resources | length > 0 and[20;9Hgrafana_pods.resources[0].status.conditions is defined and[21;9Hgrafana_pods.resources[0].status.conditions[0].status == "True"[22d[K[23;5H- name: Wait for 30 seconds to ensure Grafana service is available[24;7Hwait_for:[25;9Htimeout: 30[K[27;13HGet Grafana session cookies for authentication[29;68Hlogin"[K[30;18HOST[31;9Hbody_format: json[32;9Hheaders:[K[33;13Hntent-Type: "application/json"[K[34;13H: |[K[35;9H  {[K[36d  "user": "{{ grafana_admin_user }}",[37;14Hpassword": "{{ grafana_admin_password }}"[38;11H}[K[39;9Hstatus_code: 200[K[40;7Hregister: grafana_login_response[K[41d[K[42;5H- name: Add or Update Prometheus as Grafana data source[43;7Huri:[44;5H    url: "http://{{ grafana_host_ip }}:{{ grafana_node_port }}/api/datasources/name/Prometheus"[45;7H  method: PUT[46;9Hheaders:[K[47;9H  Content-Type: "application/json"[48;9H  Cookie: "{{ grafana_login_response.set_cookie }}"[49;9Hbody_format: json[K[50;9Hbody: |[K[51;9H  {[K[52;9H    "name": "Prometheus",[27d[?12l[?25h[?25l[?12l[?25h[23d[?25l[?12l[?25h[8d[?25l[2;9Hcreate_namespace: false[3;9Hvalues:[K[4der:[K[5;13Hglobal:[K[6;13H  scrape_interval: 15s[K[7;13Hscrape_configs:[8;14H[1K - job_name: 'kubernetes-pods'[K[9;16H[1K kubernetes_sd_configs:[10;18H[1K - role: pod[11;16H[1K relabel_configs:[12;18H[1K - source_labels: [__meta_kubernetes_pod_label_app][13;20H[1K action: keep[14;20H[1K regex: petclinic-app[K[15;14H[1K - job_name: 'kubernetes-nodes'[16;16H[1K [16;27H_sd_configs:[K[17;18H[1K - role: node[18d[K[19;5H- name: Install Loki and Promtail for collecting logs[20;7Hkubernetes.core.helm:[K[21;9Hkubeconfig: "{{ kubeconfig_path }}"[K[22;9Hname: loki[23;5H    chart_ref: grafana/loki-stack[K[24;7H  release_namespace: "{{ prometheus_namespace }}"[25;9Hcreate_namespace: false[27;13HInstall Grafana[K[28;7Hkubernetes.core.helm:[29;9Hkubeconfig: "{{ kubeconfig_path }}"[K[30;9Hname: grafana[31;9Hchart_ref: grafana/grafana[32;9Hrelease_namespace: "{{ prometheus_namespace }}"[33;9Hcreate_namespace: false[K[34;9Hvalues:[35;11HadminPassword: "{{ grafana_admin_password }}"[36;11Hservice:[K[37;13Htype: NodePort[K[38;11H  nodePort: "{{ grafana_node_port }}"[39d[K[40;5H- name: Wait for Grafana pod to be ready[41;7Hretries: 10[42;5H  delay: 30[K[43;7Hkubernetes.core.k8s_info:[44;9Hkubeconfig: "{{ kubeconfig_path }}"[K[45;9Hkind: Pod[K[46;9Hnamespace: "{{ prometheus_namespace }}"[47;9Hlabel_selectors:[K[48;11H- app.kubernetes.io/name=grafana[K[49;7Hregister: grafana_pods[50;7Huntil: >[K[51;9Hgrafana_pods.resources | length > 0 and[52;9Hgrafana_pods.resources[0].status.conditions is defined and[27d[?12l[?25h[?25l[?12l[?25h[19d[?25l[2;5H- name: Create namespace for monitoring[3;7Hkubernetes.core.k8s:[4;9Hkubeconfig: "{{ kubeconfig_path }}"[5;9Hstate: present[6;9Hdefinition:[K[7;11HapiVersion: v1[K[8;11Hkind: Namespace[K[9;11Hmetadata:[K[10;13Hname: "{{ prometheus_namespace }}"[11d[K[12;5H- name: Add Helm repository for Prometheus[K[13;7Hkubernetes.core.helm_repository:[14;9Hname: prometheus-community[K[15;9Hrepo_url: [94mhttps://prometheus-community.github.io/helm-charts[16;9H[39m(B[mstate: present[K[17d[K[18;5H- name: Add Helm repository for Grafana and Loki[19;5H  kubernetes.core.helm_repository:[K[20;7H  name: grafana[K[21;9Hrepo_url: [94mhttps://grafana.github.io/helm-charts[22;9H[39m(B[mstate: present[23d[K[24;5H- name: Update Helm repositories[K[25;7Hcommand: helm repo updat[27;21HPrometheus for monitoring pods and nodes[30;15Hprometheus[31;20Hprometheus-community/prometheus[35;11Hserver:[K[36;11H  global:[37;13H  scrape_interval: 15s[38;13Hscrape_configs:[K[39;15H- job_name: 'kubernetes-pods'[40;16H[1K kubernetes_sd_configs:[K[41;18H[1K - role: pod[42;16H[1K relabel_configs:[43;18H[1K - source_labels: [__meta_kubernetes_pod_label_app][44;20H[1K action: keep[K[45;20H[1K regex: petclinic-app[46;14H[1K - job_name: 'kubernetes-nodes'[K[47;16H[1K kubernetes_sd_configs:[48;18H[1K - role: node[K[49d[K[50;5H- name: Install Loki and Promtail for collecting logs[51;7Hkubernetes.core.helm:[K[52;9Hkubeconfig: "{{ kubeconfig_path }}"[K[27d[?12l[?25h[?25l[?12l[?25h[24d[?25l[?12l[?25h[18d[?25l[?12l[?25h[12d[?25l[2;52r[2;1H[11T[1;55r[2;1H- name: Install Monitoring Stack (Prometheus, Loki, Grafana, and Dashboards)[3;3Hhosts: localhost[4;3Hbecome: yes[5;3Hvars:[6;5Hprometheus_namespace: monitoring[7;5Hgrafana_admin_user: "admin"   # Ð›Ð¾Ð³Ð¸Ð½ Ð´Ð»Ñ Grafana[8;5Hgrafana_admin_password: "admin"  # ÐŸÐ°Ñ€Ð¾Ð»ÑŒ Ð´Ð»Ñ Grafana[9;5Hgrafana_node_port: 32000[10;5Hkubeconfig_path: "/home/rsshabanov/codeby-devops/exam/src/kubeconfig-jenkins.yaml"[11;5Hgrafana_host_ip: "192.168.49.2"  # IP Minikube[12;3Htasks:[2d[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[53d(B[0;7mSave modified buffer?                                                                                                                                                                                       [54;1H Y(B[m Yes[K[55d(B[0;7m N(B[m No  [55;17H(B[0;7m^C(B[m Cancel[K[53;23H[?12l[?25h[?25l[54d(B[0;7m^G(B[m Help[54;52H(B[0;7mM-D(B[m DOS Format[54;103H(B[0;7mM-A(B[m Append[54;154H(B[0;7mM-B(B[m Backup File[55d(B[0;7m^C(B[m Cancel[17G         [55;52H(B[0;7mM-M(B[m Mac Format[55;103H(B[0;7mM-P(B[m Prepend[55;154H(B[0;7m^T(B[m Browse[53d(B[0;7mFile Name to Write: Jenkinsfile(B[m[?12l[?25h[?25l[53;95H[1K (B[0;7m[ Writing... ](B[m[K[1;112H(B[0;7m [203G(B[m[53;93H(B[0;7m[ Wrote 172 lines ](B[m[J[55d[?12l[?25h[55;1H[?1049l[23;0;0t[?1l>[?2004l[?2004h]0;rsshabanov@MSK-01: ~/codeby-devops/exam/src[01;32mrsshabanov@MSK-01[00m:[01;34m~/codeby-devops/exam/src[00m$ sudo nano Jenkinsfile 
[?2004l[?2004h[?1049h[22;0;0t[1;55r(B[m[4l[?7h[39;49m[?1h=[?1h=[?25l[39;49m(B[m[H[2J[53;96H(B[0;7m[ Reading... ](B[m[53;94H(B[0;7m[ Read 172 lines ](B[m[H(B[0;7m  GNU nano 6.2                                                                                     Jenkinsfile                                                                                              [1;203H(B[m[54d(B[0;7m^G(B[m Help[54;18H(B[0;7m^O(B[m Write Out     (B[0;7m^W(B[m Where Is[52G(B[0;7m^K(B[m Cut[54;69H(B[0;7m^T(B[m Execute[86G(B[0;7m^C(B[m Location[103G(B[0;7mM-U(B[m Undo[54;120H(B[0;7mM-A(B[m Set Mark     (B[0;7mM-](B[m To Bracket   (B[0;7mM-Q(B[m Previous     (B[0;7m^B(B[m Back[54;188H(B[0;7m^â—‚(B[m Prev Word[55d(B[0;7m^X(B[m Exit[55;18H(B[0;7m^R(B[m Read File     (B[0;7m^\(B[m Replace[52G(B[0;7m^U(B[m Paste[55;69H(B[0;7m^J(B[m Justify[86G(B[0;7m^/(B[m Go To Line    (B[0;7mM-E(B[m Redo[55;120H(B[0;7mM-6(B[m Copy[55;137H(B[0;7m^Q(B[m Where Was     (B[0;7mM-W(B[m Next[55;171H(B[0;7m^F(B[m Forward[188G(B[0;7m^â–¸(B[m Next Word[2d- name: Install Monitoring Stack (Prometheus, Loki, Grafana, and Dashboards)[3;3Hhosts: localhost[4;3Hbecome: yes[5;3Hvars:[6;5Hprometheus_namespace: monitoring[7;5Hgrafana_admin_user: "admin"   # Ð›Ð¾Ð³Ð¸Ð½ Ð´Ð»Ñ Grafana[8;5Hgrafana_admin_password: "admin"  # ÐŸÐ°Ñ€Ð¾Ð»ÑŒ Ð´Ð»Ñ Grafana[9;5Hgrafana_node_port: 32000[10;5Hkubeconfig_path: "/home/rsshabanov/codeby-devops/exam/src/kubeconfig-jenkins.yaml"[11;5Hgrafana_host_ip: "192.168.49.2"  # IP Minikube[12;3Htasks:[13;5H- name: Create namespace for monitoring[14;7Hkubernetes.core.k8s:[15;9Hkubeconfig: "{{ kubeconfig_path }}"[16;9Hstate: present[17;9Hdefinition:[18;11HapiVersion: v1[19;11Hkind: Namespace[20;11Hmetadata:[21;13Hname: "{{ prometheus_namespace }}"[23;5H- name: Add Helm repository for Prometheus[24;7Hkubernetes.core.helm_repository:[25;9Hname: prometheus-community[26;9Hrepo_url: [94mhttps://prometheus-community.github.io/helm-charts[27;9H[39m(B[mstate: present[29;5H- name: Add Helm repository for Grafana and Loki[30;7Hkubernetes.core.helm_repository:[31;9Hname: grafana[32;9Hrepo_url: [94mhttps://grafana.github.io/helm-charts[33;9H[39m(B[mstate: present[35;5H- name: Update Helm repositories[36;7Hcommand: helm repo update[38;5H- name: Install Prometheus for monitoring pods and nodes[39;7Hkubernetes.core.helm:[40;9Hkubeconfig: "{{ kubeconfig_path }}"[41;9Hname: prometheus[42;9Hchart_ref: prometheus-community/prometheus[43;9Hrelease_namespace: "{{ prometheus_namespace }}"[44;9Hcreate_namespace: false[45;9Hvalues:[46;11Hserver:[47;13Hglobal:[48;15Hscrape_interval: 15s[49;13Hscrape_configs:[50;15H- job_name: 'kubernetes-pods'[51;17Hkubernetes_sd_configs:[52;19H- role: pod[2d[?12l[?25h[?25l[53d[J[55d[?12l[?25h[55;1H[?1049l[23;0;0t[?1l>[?2004l[?2004h]0;rsshabanov@MSK-01: ~/codeby-devops/exam/src[01;32mrsshabanov@MSK-01[00m:[01;34m~/codeby-devops/exam/src[00m$ sudo nano Jenkinsfile 
[?2004l[?2004h[?1049h[22;0;0t[1;55r(B[m[4l[?7h[39;49m[?1h=[?1h=[?25l[39;49m(B[m[H[2J[53;96H(B[0;7m[ Reading... ](B[m[53;94H(B[0;7m[ Read 172 lines ](B[m[H(B[0;7m  GNU nano 6.2                                                                                     Jenkinsfile                                                                                              [1;203H(B[m[54d(B[0;7m^G(B[m Help[54;18H(B[0;7m^O(B[m Write Out     (B[0;7m^W(B[m Where Is[52G(B[0;7m^K(B[m Cut[54;69H(B[0;7m^T(B[m Execute[86G(B[0;7m^C(B[m Location[103G(B[0;7mM-U(B[m Undo[54;120H(B[0;7mM-A(B[m Set Mark     (B[0;7mM-](B[m To Bracket   (B[0;7mM-Q(B[m Previous     (B[0;7m^B(B[m Back[54;188H(B[0;7m^â—‚(B[m Prev Word[55d(B[0;7m^X(B[m Exit[55;18H(B[0;7m^R(B[m Read File     (B[0;7m^\(B[m Replace[52G(B[0;7m^U(B[m Paste[55;69H(B[0;7m^J(B[m Justify[86G(B[0;7m^/(B[m Go To Line    (B[0;7mM-E(B[m Redo[55;120H(B[0;7mM-6(B[m Copy[55;137H(B[0;7m^Q(B[m Where Was     (B[0;7mM-W(B[m Next[55;171H(B[0;7m^F(B[m Forward[188G(B[0;7m^â–¸(B[m Next Word[2d- name: Install Monitoring Stack (Prometheus, Loki, Grafana, and Dashboards)[3;3Hhosts: localhost[4;3Hbecome: yes[5;3Hvars:[6;5Hprometheus_namespace: monitoring[7;5Hgrafana_admin_user: "admin"   # Ð›Ð¾Ð³Ð¸Ð½ Ð´Ð»Ñ Grafana[8;5Hgrafana_admin_password: "admin"  # ÐŸÐ°Ñ€Ð¾Ð»ÑŒ Ð´Ð»Ñ Grafana[9;5Hgrafana_node_port: 32000[10;5Hkubeconfig_path: "/home/rsshabanov/codeby-devops/exam/src/kubeconfig-jenkins.yaml"[11;5Hgrafana_host_ip: "192.168.49.2"  # IP Minikube[12;3Htasks:[13;5H- name: Create namespace for monitoring[14;7Hkubernetes.core.k8s:[15;9Hkubeconfig: "{{ kubeconfig_path }}"[16;9Hstate: present[17;9Hdefinition:[18;11HapiVersion: v1[19;11Hkind: Namespace[20;11Hmetadata:[21;13Hname: "{{ prometheus_namespace }}"[23;5H- name: Add Helm repository for Prometheus[24;7Hkubernetes.core.helm_repository:[25;9Hname: prometheus-community[26;9Hrepo_url: [94mhttps://prometheus-community.github.io/helm-charts[27;9H[39m(B[mstate: present[29;5H- name: Add Helm repository for Grafana and Loki[30;7Hkubernetes.core.helm_repository:[31;9Hname: grafana[32;9Hrepo_url: [94mhttps://grafana.github.io/helm-charts[33;9H[39m(B[mstate: present[35;5H- name: Update Helm repositories[36;7Hcommand: helm repo update[38;5H- name: Install Prometheus for monitoring pods and nodes[39;7Hkubernetes.core.helm:[40;9Hkubeconfig: "{{ kubeconfig_path }}"[41;9Hname: prometheus[42;9Hchart_ref: prometheus-community/prometheus[43;9Hrelease_namespace: "{{ prometheus_namespace }}"[44;9Hcreate_namespace: false[45;9Hvalues:[46;11Hserver:[47;13Hglobal:[48;15Hscrape_interval: 15s[49;13Hscrape_configs:[50;15H- job_name: 'kubernetes-pods'[51;17Hkubernetes_sd_configs:[52;19H- role: pod[2d[?12l[?25h[?25l[1;112H(B[0;7m*[203G(B[m[2;53r[53;1H
[1;55r[52;17Hrelabel_configs:[K[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;19H- source_labels: [__meta_kubernetes_pod_label_app][2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;21Haction: keep[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;21Hregex: petclinic-app[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;15H- job_name: 'kubernetes-nodes'[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;17Hkubernetes_sd_configs:[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;19H- role: node[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;5H- name: Install Loki and Promtail for collecting logs[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;7Hkubernetes.core.helm:[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;9Hkubeconfig: "{{ kubeconfig_path }}"[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;9Hname: loki[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;9Hchart_ref: grafana/loki-stack[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;9Hrelease_namespace: "{{ prometheus_namespace }}"[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;9Hcreate_namespace: false[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;5H- name: Install Grafana[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;7Hkubernetes.core.helm:[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;9Hkubeconfig: "{{ kubeconfig_path }}"[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;9Hname: grafana[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;9Hchart_ref: grafana/grafana[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;9Hrelease_namespace: "{{ prometheus_namespace }}"[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;9Hcreate_namespace: false[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;9Hvalues:[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;11HadminPassword: "{{ grafana_admin_password }}"[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;11Hservice:[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;13Htype: NodePort[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;13HnodePort: "{{ grafana_node_port }}"[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;5H- name: Wait for Grafana pod to be ready[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;7Hretries: 10[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;7Hdelay: 30[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;7Hkubernetes.core.k8s_info:[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;9Hkubeconfig: "{{ kubeconfig_path }}"[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;9Hkind: Pod[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;9Hnamespace: "{{ prometheus_namespace }}"[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;9Hlabel_selectors:[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;11H- app.kubernetes.io/name=grafana[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;7Hregister: grafana_pods[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;7Huntil: >[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;9Hgrafana_pods.resources | length > 0 and[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;9Hgrafana_pods.resources[0].status.conditions is defined and[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;9Hgrafana_pods.resources[0].status.conditions[0].status == "True"[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;5H- name: Wait for 30 seconds to ensure Grafana service is available[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;7Hwait_for:[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;9Htimeout: 30[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;5H- name: Get Grafana session cookies for authentication[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;7Huri:[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;9Hurl: "http://{{ grafana_host_ip }}:{{ grafana_node_port }}/login"[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;9Hmethod: POST[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;9Hbody_format: json[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;9Hheaders:[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;11HContent-Type: "application/json"[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;9Hbody: |[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;11H{[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;13H"user": "{{ grafana_admin_user }}",[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;13H"password": "{{ grafana_admin_password }}"[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;11H}[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;9Hstatus_code: 200[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;7Hregister: grafana_login_response[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;5H- name: Add or Update Prometheus as Grafana data source[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;7Huri:[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;9Hurl: "http://{{ grafana_host_ip }}:{{ grafana_node_port }}/api/datasources/name/Prometheus"[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;9Hmethod: PUT[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;9Hheaders:[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;11HContent-Type: "application/json"[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;11HCookie: "{{ grafana_login_response.set_cookie }}"[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;9Hbody_format: json[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;9Hbody: |[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;11H{[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;13H"name": "Prometheus",[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;13H"type": "prometheus",[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;13H"access": "proxy",[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;13H"url": "[94mhttp://prometheus-server.{{[39m(B[m prometheus_namespace }}.svc.cluster.local:80",[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;13H"isDefault": true[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;11H}[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;9Hstatus_code: 200[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;5H- name: Add or Update Loki as Grafana data source[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;7Huri:[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;9Hurl: "http://{{ grafana_host_ip }}:{{ grafana_node_port }}/api/datasources/name/Loki"[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;9Hmethod: PUT[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;9Hheaders:[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;11HContent-Type: "application/json"[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;11HCookie: "{{ grafana_login_response.set_cookie }}"[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;9Hbody_format: json[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;9Hbody: |[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;11H{[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;13H"name": "Loki",[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;13H"type": "loki",[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;13H"access": "proxy",[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;13H"url": "[94mhttp://loki.{{[39m(B[m prometheus_namespace }}.svc.cluster.local:3100"[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;11H}[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;9Hstatus_code: 200[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;5H- name: Add Grafana dashboard for logs and state monitoring via API[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;7Huri:[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;9Hurl: "http://{{ grafana_host_ip }}:{{ grafana_node_port }}/api/dashboards/db"[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;9Hmethod: POST[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;9Hheaders:[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;11HContent-Type: "application/json"[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;11HCookie: "{{ grafana_login_response.set_cookie }}"[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;9Hbody_format: json[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;9Hbody: |[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;11H{[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;13H"dashboard": {[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;15H"id": null,[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;15H"uid": "loki-logs",[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;15H"title": "Loki Logs & Application State",[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;15H"tags": ["logs", "loki", "prometheus"],[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;15H"timezone": "browser",[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;15H"schemaVersion": 16,[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;15H"version": 0,[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;15H"panels": [][2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;13H},[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;13H"overwrite": true[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;11H}[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;9Hstatus_code: 200[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[K[?12l[?25h[?25l[53;93H(B[0;7m[ Nothing was cut ](B[m[?12l[?25h[2d[?25l[53;112H[?12l[?25h[2d[?25l[53;112H[?12l[?25h[2d[?25l[53;112H[?12l[?25h[2d[?25l[53;112H[?12l[?25h[2d[?25l[53;112H[?12l[?25h[2d[?25l[53;112H[?12l[?25h[2d[?25l[53;112H[?12l[?25h[2d[?25l[53;112H[?12l[?25h[2d[?25l[53;112H[?12l[?25h[2d[?25l[53;112H[?12l[?25h[2d[?25l[53;112H[?12l[?25h[2d[?25l[2;29H"""[3;25H}[4;21H}[5;17H}[6;13H}[7;9H}[8dstage('Run Ansible Playbook') {[9;13Hsteps {[10;17Hdir('exam/src') {[11;21Hscript {[12;25H// Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¸Ðµ ansible.cfg Ð´Ð»Ñ ÑƒÐºÐ°Ð·Ð°Ð½Ð¸Ñ Ð¿ÑƒÑ‚Ð¸ Ðº ÐºÐ¾Ð»Ð»ÐµÐºÑ†Ð¸ÑÐ¼[13;25Hsh '''[14;25Hecho "[defaults]" > ansible.cfg[15;25Hecho "collections_paths = /home/rsshabanov/.ansible/collections:/usr/share/ansible/collections" >> ansible.cfg[16;25H'''[18;25H// Ð£ÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐ° ÐºÐ¾Ð»Ð»ÐµÐºÑ†Ð¸Ð¸ Ð¸ Ð·Ð°Ð¿ÑƒÑÐº Ð¿Ð»ÐµÐ¹Ð±ÑƒÐºÐ° Ñ Ð¿ÐµÑ€ÐµÐ´Ð°Ñ‡ÐµÐ¹ sudo-Ð¿Ð°Ñ€Ð¾Ð»Ñ Ñ‡ÐµÑ€ÐµÐ· Ð¿ÐµÑ€ÐµÐ¼ÐµÐ½Ð½ÑƒÑŽ[19;25Hsh 'ansible-galaxy collection install kubernetes.core'[20;25Hsh "ansible-playbook -i inventory monitoring_playbook.yml --extra-vars 'ansible_become_pass=${BECOME_PASSWORD}'"[21;21H}[22;17H}[23;13H}[24;9H}[25;5H}[26d}[53d[K[27d[?12l[?25h[?25l[?12l[?25h[18d[?25l[2dpipeline {[K[3;5Hagent any[K[4d[K[5;5Henvironment {[6;9HappVersion = readFile('exam/src/VERSION').trim()[7;9HBECOME_PASSWORD = credentials('your-sudo-password-id')  // Ð£ÐºÐ°Ð¶Ð¸Ñ‚Ðµ ID Jenkins Credentials Ð´Ð»Ñ sudo Ð¿Ð°Ñ€Ð¾Ð»Ñ[8;5H}[K[9d[K[10;5Hstages {[K[11;9Hstage('Checkout') {[K[12;13Hsteps {[K[13;17Hgit branch: 'exam', url: '[94mhttps://github.com/Roma-uuu/codeby-devops.git'[14;13H[39m(B[m}[K[15;9H}[K[16dstage('Build') {[K[17;13Hsteps {[18;17Hdir('exam/src') {[K[19;21Hsh 'mvn clean package -Dcheckstyle.skip=true'[K[20;17H}[K[21;13H}[K[22;9H}[K[23dstage('Test Docker Access') {[24;9H    steps {[25;16H[1K sh 'docker info'[26;12H[1K }[27;9H}[28dstage('Build and Push Docker Image') {[29;13Hsteps {[30;17Hdir('exam/src') {[31;21Hscript {[32;25Hecho "Building Docker image with tag: ${appVersion}"[33;25HwithCredentials([usernamePassword(credentialsId: 'dockerhub-credentials', usernameVariable: 'DOCKERHUB_USERNAME', passwordVariable: 'DOCKERHUB_TOKEN')]) {[34;29Hsh """[35;29Hecho $DOCKERHUB_TOKEN | docker login -u $DOCKERHUB_USERNAME --password-stdin[36;29Hdocker build -t apkerigz/devops:${appVersion} .[37;29Hdocker push apkerigz/devops:${appVersion}[38;29H"""[39;25H}[40;21H}[41;17H}[42;13H}[43;9H}[44dstage('Deploy using Helm') {[45;13Hsteps {[46;17HwithCredentials([string(credentialsId: 'k8s-sa-token', variable: 'K8S_TOKEN')]) {[47;21Hdir('exam/src/mychart') {[48;25Hscript {[49;29Hecho "Deploying Helm chart with image tag: ${appVersion}"[50;29Hsh """[51;29Hhelm upgrade --install petclinic-app . \[52;33H--set image.repository=apkerigz/devops \[10d[?12l[?25h[?25l[?12l[?25h[5d[?25l[?12l[?25h[2d[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[53d(B[0;7mSave modified buffer?                                                                                                                                                                                       [54;1H Y(B[m Yes[K[55d(B[0;7m N(B[m No  [55;17H(B[0;7m^C(B[m Cancel[K[53;23H[?12l[?25h[?25l[J[55d[?12l[?25h[55;1H[?1049l[23;0;0t[?1l>[?2004l[?2004h]0;rsshabanov@MSK-01: ~/codeby-devops/exam/src[01;32mrsshabanov@MSK-01[00m:[01;34m~/codeby-devops/exam/src[00m$ sudo nano Jenkinsfile 
[?2004l[?2004h[?1049h[22;0;0t[1;55r(B[m[4l[?7h[39;49m[?1h=[?1h=[?25l[39;49m(B[m[H[2J[53;96H(B[0;7m[ Reading... ](B[m[53;94H(B[0;7m[ Read 172 lines ](B[m[H(B[0;7m  GNU nano 6.2                                                                                     Jenkinsfile                                                                                              [1;203H(B[m[54d(B[0;7m^G(B[m Help[54;18H(B[0;7m^O(B[m Write Out     (B[0;7m^W(B[m Where Is[52G(B[0;7m^K(B[m Cut[54;69H(B[0;7m^T(B[m Execute[86G(B[0;7m^C(B[m Location[103G(B[0;7mM-U(B[m Undo[54;120H(B[0;7mM-A(B[m Set Mark     (B[0;7mM-](B[m To Bracket   (B[0;7mM-Q(B[m Previous     (B[0;7m^B(B[m Back[54;188H(B[0;7m^â—‚(B[m Prev Word[55d(B[0;7m^X(B[m Exit[55;18H(B[0;7m^R(B[m Read File     (B[0;7m^\(B[m Replace[52G(B[0;7m^U(B[m Paste[55;69H(B[0;7m^J(B[m Justify[86G(B[0;7m^/(B[m Go To Line    (B[0;7mM-E(B[m Redo[55;120H(B[0;7mM-6(B[m Copy[55;137H(B[0;7m^Q(B[m Where Was     (B[0;7mM-W(B[m Next[55;171H(B[0;7m^F(B[m Forward[188G(B[0;7m^â–¸(B[m Next Word[2d- name: Install Monitoring Stack (Prometheus, Loki, Grafana, and Dashboards)[3;3Hhosts: localhost[4;3Hbecome: yes[5;3Hvars:[6;5Hprometheus_namespace: monitoring[7;5Hgrafana_admin_user: "admin"   # Ð›Ð¾Ð³Ð¸Ð½ Ð´Ð»Ñ Grafana[8;5Hgrafana_admin_password: "admin"  # ÐŸÐ°Ñ€Ð¾Ð»ÑŒ Ð´Ð»Ñ Grafana[9;5Hgrafana_node_port: 32000[10;5Hkubeconfig_path: "/home/rsshabanov/codeby-devops/exam/src/kubeconfig-jenkins.yaml"[11;5Hgrafana_host_ip: "192.168.49.2"  # IP Minikube[12;3Htasks:[13;5H- name: Create namespace for monitoring[14;7Hkubernetes.core.k8s:[15;9Hkubeconfig: "{{ kubeconfig_path }}"[16;9Hstate: present[17;9Hdefinition:[18;11HapiVersion: v1[19;11Hkind: Namespace[20;11Hmetadata:[21;13Hname: "{{ prometheus_namespace }}"[23;5H- name: Add Helm repository for Prometheus[24;7Hkubernetes.core.helm_repository:[25;9Hname: prometheus-community[26;9Hrepo_url: [94mhttps://prometheus-community.github.io/helm-charts[27;9H[39m(B[mstate: present[29;5H- name: Add Helm repository for Grafana and Loki[30;7Hkubernetes.core.helm_repository:[31;9Hname: grafana[32;9Hrepo_url: [94mhttps://grafana.github.io/helm-charts[33;9H[39m(B[mstate: present[35;5H- name: Update Helm repositories[36;7Hcommand: helm repo update[38;5H- name: Install Prometheus for monitoring pods and nodes[39;7Hkubernetes.core.helm:[40;9Hkubeconfig: "{{ kubeconfig_path }}"[41;9Hname: prometheus[42;9Hchart_ref: prometheus-community/prometheus[43;9Hrelease_namespace: "{{ prometheus_namespace }}"[44;9Hcreate_namespace: false[45;9Hvalues:[46;11Hserver:[47;13Hglobal:[48;15Hscrape_interval: 15s[49;13Hscrape_configs:[50;15H- job_name: 'kubernetes-pods'[51;17Hkubernetes_sd_configs:[52;19H- role: pod[2d[?12l[?25h[?25l[?12l[?25h[3d[?25l[?12l[?25h[4d[?25l[?12l[?25h[5d[?25l[?12l[?25h[6d[?25l[?12l[?25h[7d[?25l[?12l[?25h[8d[?25l[?12l[?25h[9d[?25l[?12l[?25h[A[?25l[2d[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[53d[K[2d[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[3d[?25l[?12l[?25h[4d[?25l[?12l[?25h[5d[?25l[?12l[?25h[6d[?25l[?12l[?25h[7d[?25l[?12l[?25h[8d[?25l[?12l[?25h[9d[?25l[?12l[?25h[10d[?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25hk[?25l[?12l[?25hu[?25l[?12l[?25hb[?25l[?12l[?25he[?25l[?12l[?25hc[?25l[?12l[?25ho[?25l[?12l[?25hn[?25l[?12l[?25hf[?25l[?12l[?25hi[?25l[?12l[?25hg[?25l[?12l[?25h_[?25l[?12l[?25hp[?25l[?12l[?25ha[?25l[?12l[?25ht[?25l[?12l[?25hh[?25l[?12l[?25h:[?25l[?12l[?25h [?25l[?12l[?25h"[?25l[?12l[?25h[A[?25l[?12l[?25h[A[?25l[?12l[?25h[A[?25l[?12l[?25h[A[?25l[?12l[?25h[5;8H[?25l[?12l[?25h[4;14H[?25l[?12l[?25h[3;19H[?25l[?12l[?25h[Anito[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[1;112H(B[0;7m*[203G(B[m[2;53r[53;1H
[1;55r[52;17Hrelabel_configs:[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;19H- source_labels: [__meta_kubernetes_pod_label_app][2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;21Haction: keep[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;21Hregex: petclinic-app[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;15H- job_name: 'kubernetes-nodes'[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;17Hkubernetes_sd_configs:[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;19H- role: node[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;5H- name: Install Loki and Promtail for collecting logs[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;7Hkubernetes.core.helm:[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;9Hkubeconfig: "{{ kubeconfig_path }}"[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;9Hname: loki[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;9Hchart_ref: grafana/loki-stack[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;9Hrelease_namespace: "{{ prometheus_namespace }}"[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;9Hcreate_namespace: false[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;5H- name: Install Grafana[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;7Hkubernetes.core.helm:[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;9Hkubeconfig: "{{ kubeconfig_path }}"[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;9Hname: grafana[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;9Hchart_ref: grafana/grafana[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;9Hrelease_namespace: "{{ prometheus_namespace }}"[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;9Hcreate_namespace: false[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;9Hvalues:[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;11HadminPassword: "{{ grafana_admin_password }}"[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;11Hservice:[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;13Htype: NodePort[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;13HnodePort: "{{ grafana_node_port }}"[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;5H- name: Wait for Grafana pod to be ready[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;7Hretries: 10[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;7Hdelay: 30[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;7Hkubernetes.core.k8s_info:[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;9Hkubeconfig: "{{ kubeconfig_path }}"[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;9Hkind: Pod[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;9Hnamespace: "{{ prometheus_namespace }}"[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;9Hlabel_selectors:[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;11H- app.kubernetes.io/name=grafana[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;7Hregister: grafana_pods[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;7Huntil: >[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;9Hgrafana_pods.resources | length > 0 and[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;9Hgrafana_pods.resources[0].status.conditions is defined and[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;9Hgrafana_pods.resources[0].status.conditions[0].status == "True"[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;5H- name: Wait for 30 seconds to ensure Grafana service is available[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;7Hwait_for:[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;9Htimeout: 30[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;5H- name: Get Grafana session cookies for authentication[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;7Huri:[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;9Hurl: "http://{{ grafana_host_ip }}:{{ grafana_node_port }}/login"[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;9Hmethod: POST[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;9Hbody_format: json[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;9Hheaders:[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;11HContent-Type: "application/json"[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;9Hbody: |[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;11H{[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;13H"user": "{{ grafana_admin_user }}",[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;13H"password": "{{ grafana_admin_password }}"[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;11H}[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;9Hstatus_code: 200[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;7Hregister: grafana_login_response[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;5H- name: Add or Update Prometheus as Grafana data source[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;7Huri:[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;9Hurl: "http://{{ grafana_host_ip }}:{{ grafana_node_port }}/api/datasources/name/Prometheus"[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;9Hmethod: PUT[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;9Hheaders:[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;11HContent-Type: "application/json"[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;11HCookie: "{{ grafana_login_response.set_cookie }}"[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;9Hbody_format: json[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;9Hbody: |[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;11H{[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;13H"name": "Prometheus",[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;13H"type": "prometheus",[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;13H"access": "proxy",[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;13H"url": "[94mhttp://prometheus-server.{{[39m(B[m prometheus_namespace }}.svc.cluster.local:80",[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;13H"isDefault": true[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;11H}[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;9Hstatus_code: 200[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;5H- name: Add or Update Loki as Grafana data source[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;7Huri:[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;9Hurl: "http://{{ grafana_host_ip }}:{{ grafana_node_port }}/api/datasources/name/Loki"[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;9Hmethod: PUT[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;9Hheaders:[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;11HContent-Type: "application/json"[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;11HCookie: "{{ grafana_login_response.set_cookie }}"[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;9Hbody_format: json[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;9Hbody: |[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;11H{[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;13H"name": "Loki",[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;13H"type": "loki",[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;13H"access": "proxy",[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;13H"url": "[94mhttp://loki.{{[39m(B[m prometheus_namespace }}.svc.cluster.local:3100"[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;11H}[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;9Hstatus_code: 200[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;5H- name: Add Grafana dashboard for logs and state monitoring via API[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;7Huri:[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;9Hurl: "http://{{ grafana_host_ip }}:{{ grafana_node_port }}/api/dashboards/db"[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;9Hmethod: POST[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;9Hheaders:[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;11HContent-Type: "application/json"[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;11HCookie: "{{ grafana_login_response.set_cookie }}"[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;9Hbody_format: json[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;9Hbody: |[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;11H{[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;13H"dashboard": {[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;15H"id": null,[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;15H"uid": "loki-logs",[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;15H"title": "Loki Logs & Application State",[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;15H"tags": ["logs", "loki", "prometheus"],[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;15H"timezone": "browser",[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;15H"schemaVersion": 16,[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;15H"version": 0,[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;15H"panels": [][2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;13H},[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;13H"overwrite": true[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;11H}[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;9Hstatus_code: 200[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[K[?12l[?25h[?25l[53;93H(B[0;7m[ Nothing was cut ](B[m[?12l[?25h[2d[?25l[53;112H[?12l[?25h[2d[?25l[53;112H[?12l[?25h[2d[?25l[53;112H[?12l[?25h[2d[?25l[53;112H[?12l[?25h[2d[?25l[53;112H[?12l[?25h[2d[?25l[53;112H[?12l[?25h[2d[?25l[53;112H[?12l[?25h[2d[?25l[53;112H[?12l[?25h[2d[?25l[2;29H"""[3;25H}[4;21H}[5;17H}[6;13H}[7;9H}[8dstage('Run Ansible Playbook') {[9;13Hsteps {[10;17Hdir('exam/src') {[11;21Hscript {[12;25H// Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¸Ðµ ansible.cfg Ð´Ð»Ñ ÑƒÐºÐ°Ð·Ð°Ð½Ð¸Ñ Ð¿ÑƒÑ‚Ð¸ Ðº ÐºÐ¾Ð»Ð»ÐµÐºÑ†Ð¸ÑÐ¼[13;25Hsh '''[14;25Hecho "[defaults]" > ansible.cfg[15;25Hecho "collections_paths = /home/rsshabanov/.ansible/collections:/usr/share/ansible/collections" >> ansible.cfg[16;25H'''[18;25H// Ð£ÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐ° ÐºÐ¾Ð»Ð»ÐµÐºÑ†Ð¸Ð¸ Ð¸ Ð·Ð°Ð¿ÑƒÑÐº Ð¿Ð»ÐµÐ¹Ð±ÑƒÐºÐ° Ñ Ð¿ÐµÑ€ÐµÐ´Ð°Ñ‡ÐµÐ¹ sudo-Ð¿Ð°Ñ€Ð¾Ð»Ñ Ñ‡ÐµÑ€ÐµÐ· Ð¿ÐµÑ€ÐµÐ¼ÐµÐ½Ð½ÑƒÑŽ[19;25Hsh 'ansible-galaxy collection install kubernetes.core'[20;25Hsh "ansible-playbook -i inventory monitoring_playbook.yml --extra-vars 'ansible_become_pass=${BECOME_PASSWORD}'"[21;21H}[22;17H}[23;13H}[24;9H}[25;5H}[26d}[53d[K[27d[?12l[?25h[?25l[?12l[?25h[18d[?25l[2dpipeline {[K[3;5Hagent any[K[4d[K[5;5Henvironment {[6;9HappVersion = readFile('exam/src/VERSION').trim()[7;9HBECOME_PASSWORD = credentials('your-sudo-password-id')  // Ð£ÐºÐ°Ð¶Ð¸Ñ‚Ðµ ID Jenkins Credentials Ð´Ð»Ñ sudo Ð¿Ð°Ñ€Ð¾Ð»Ñ[8;5H}[K[9d[K[10;5Hstages {[K[11;9Hstage('Checkout') {[K[12;13Hsteps {[K[13;17Hgit branch: 'exam', url: '[94mhttps://github.com/Roma-uuu/codeby-devops.git'[14;13H[39m(B[m}[K[15;9H}[K[16dstage('Build') {[K[17;13Hsteps {[18;17Hdir('exam/src') {[K[19;21Hsh 'mvn clean package -Dcheckstyle.skip=true'[K[20;17H}[K[21;13H}[K[22;9H}[K[23dstage('Test Docker Access') {[24;9H    steps {[25;16H[1K sh 'docker info'[26;12H[1K }[27;9H}[28dstage('Build and Push Docker Image') {[29;13Hsteps {[30;17Hdir('exam/src') {[31;21Hscript {[32;25Hecho "Building Docker image with tag: ${appVersion}"[33;25HwithCredentials([usernamePassword(credentialsId: 'dockerhub-credentials', usernameVariable: 'DOCKERHUB_USERNAME', passwordVariable: 'DOCKERHUB_TOKEN')]) {[34;29Hsh """[35;29Hecho $DOCKERHUB_TOKEN | docker login -u $DOCKERHUB_USERNAME --password-stdin[36;29Hdocker build -t apkerigz/devops:${appVersion} .[37;29Hdocker push apkerigz/devops:${appVersion}[38;29H"""[39;25H}[40;21H}[41;17H}[42;13H}[43;9H}[44dstage('Deploy using Helm') {[45;13Hsteps {[46;17HwithCredentials([string(credentialsId: 'k8s-sa-token', variable: 'K8S_TOKEN')]) {[47;21Hdir('exam/src/mychart') {[48;25Hscript {[49;29Hecho "Deploying Helm chart with image tag: ${appVersion}"[50;29Hsh """[51;29Hhelm upgrade --install petclinic-app . \[52;33H--set image.repository=apkerigz/devops \[10d[?12l[?25h[?25l[?12l[?25h[5d[?25l[?12l[?25h[2d[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[3d[?25l[?12l[?25h[4d[?25l[?12l[?25h[5d[?25l[?12l[?25h[6d[?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h[7d[?25l[?12l[?25hB[?25l[?12l[?25hE[?25l[?12l[?25hC[?25l[?12l[?25hO[?25l[?12l[?25hM[?25l[?12l[?25hE[?25l[?12l[?25h_[?25l[?12l[?25hP[?25l[?12l[?25hA[?25l[?12l[?25hS[?25l[?12l[?25hS[?25l[?12l[?25hW[?25l[?12l[?25hO[?25l[?12l[?25hR[?25l[?12l[?25hD[?25l[?12l[?25h [?25l[?12l[?25h=[?25l[?12l[?25h [?25l[?12l[?25hc[?25l[?12l[?25hr[?25l[?12l[?25he[?25l[?12l[?25hd[?25l[?12l[?25he[?25l[?12l[?25hn[?25l[?12l[?25ht[?25l[?12l[?25hi[?25l[?12l[?25ha[?25l[?12l[?25hl[?25l[?12l[?25hs[?25l[?12l[?25h([?25l[?12l[?25h'[?25l[?12l[?25hy[?25l[?12l[?25ho[?25l[?12l[?25hu[?25l[?12l[?25hr[?25l[?12l[?25h-[?25l[?12l[?25hs[?25l[?12l[?25hu[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25ho[?25l[?12l[?25hu[?25l[?12l[?25hr[?25l[?12l[?25h-[?25l[?12l[?25hs[?25l[?12l[?25hu[?25l[?12l[?25hd[?25l[?12l[?25ho[?25l[?12l[?25h-[?25l[?12l[?25hp[?25l[?12l[?25ha[?25l[?12l[?25hs[?25l[?12l[?25hs[?25l[?12l[?25hw[?25l[?12l[?25ho[?25l[?12l[?25hr[?25l[?12l[?25hd[?25l[?12l[?25h-[?25l[?12l[?25hi[?25l[?12l[?25hd[?25l[?12l[?25h[1P[?25l[?12l[?25h[1P[?25l[?12l[?25h[1P[?25l[?12l[?25h[1P[?25l[?12l[?25h[1P[?25l[?12l[?25h[1P[?25l[?12l[?25h[1P[?25l[?12l[?25h[1Ps[?25l[?12l[?25h[1P[?25l[?12l[?25h[1P[?25l[?12l[?25h[1P[?25l[?12l[?25h[1P[?25l[?12l[?25h[1P[?25l[?12l[?25h[1P[?25l[?12l[?25h[1P[?25l[?12l[?25h[1P[?25l[?12l[?25h[1P[?25l[?12l[?25h[1P[?25l[?12l[?25h[1P[?25l[?12l[?25h[1P[?25l[?12l[?25h[1P[?25l[?12l[?25hf')  // Ð£ÐºÐ°Ð¶Ð¸Ñ‚Ðµ ID Jenkins Credentials Ð´Ð»Ñ sudo Ð¿Ð°Ñ€Ð¾Ð»Ñ[7;41H[?25l[?12l[?25ho')  // Ð£ÐºÐ°Ð¶Ð¸Ñ‚Ðµ ID Jenkins Credentials Ð´Ð»Ñ sudo Ð¿Ð°Ñ€Ð¾Ð»Ñ[7;42H[?25l[?12l[?25hr')  // Ð£ÐºÐ°Ð¶Ð¸Ñ‚Ðµ ID Jenkins Credentials Ð´Ð»Ñ sudo Ð¿Ð°Ñ€Ð¾Ð»Ñ[7;43H[?25l[?12l[?25h_')  // Ð£ÐºÐ°Ð¶Ð¸Ñ‚Ðµ ID Jenkins Credentials Ð´Ð»Ñ sudo Ð¿Ð°Ñ€Ð¾Ð»Ñ[7;44H[?25l[?12l[?25ha')  // Ð£ÐºÐ°Ð¶Ð¸Ñ‚Ðµ ID Jenkins Credentials Ð´Ð»Ñ sudo Ð¿Ð°Ñ€Ð¾Ð»Ñ[7;45H[?25l[?12l[?25hn')  // Ð£ÐºÐ°Ð¶Ð¸Ñ‚Ðµ ID Jenkins Credentials Ð´Ð»Ñ sudo Ð¿Ð°Ñ€Ð¾Ð»Ñ[7;46H[?25l[?12l[?25hs')  // Ð£ÐºÐ°Ð¶Ð¸Ñ‚Ðµ ID Jenkins Credentials Ð´Ð»Ñ sudo Ð¿Ð°Ñ€Ð¾Ð»Ñ[7;47H[?25l[?12l[?25hi')  // Ð£ÐºÐ°Ð¶Ð¸Ñ‚Ðµ ID Jenkins Credentials Ð´Ð»Ñ sudo Ð¿Ð°Ñ€Ð¾Ð»Ñ[7;48H[?25l[?12l[?25hb')  // Ð£ÐºÐ°Ð¶Ð¸Ñ‚Ðµ ID Jenkins Credentials Ð´Ð»Ñ sudo Ð¿Ð°Ñ€Ð¾Ð»Ñ[7;49H[?25l[?12l[?25hl')  // Ð£ÐºÐ°Ð¶Ð¸Ñ‚Ðµ ID Jenkins Credentials Ð´Ð»Ñ sudo Ð¿Ð°Ñ€Ð¾Ð»Ñ[7;50H[?25l[?12l[?25he')  // Ð£ÐºÐ°Ð¶Ð¸Ñ‚Ðµ ID Jenkins Credentials Ð´Ð»Ñ sudo Ð¿Ð°Ñ€Ð¾Ð»Ñ[7;51H[?25l[?12l[?25h[8;6H[?25l[?12l[?25h[9d[?25l[?12l[?25h[10;13H[?25l[?12l[?25h[11;28H[?25l[?12l[?25h[12;20H[?25l[?12l[?25h[11;28H[?25l[?12l[?25h[10;13H[?25l[?12l[?25h[A[?25l[?12l[?25h[8;6H[?25l[?12l[?25h[7;51H[?25l[?12l[?25h[A[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h/exam/src/VERSION').trim()[6;33H[?25l[?12l[?25hhexam/src/VERSION').trim()[6;34H[?25l[?12l[?25hoexam/src/VERSION').trim()[6;35H[?25l[?12l[?25hmexam/src/VERSION').trim()[6;36H[?25l[?12l[?25heexam/src/VERSION').trim()[6;37H[?25l[?12l[?25h/exam/src/VERSION').trim()[6;38H[?25l[?12l[?25hrexam/src/VERSION').trim()[6;39H[?25l[?12l[?25hsexam/src/VERSION').trim()[6;40H[?25l[?12l[?25hssexam/src/VERSION').trim()[6;41H[?25l[?12l[?25hhexam/src/VERSION').trim()[6;42H[?25l[?12l[?25haexam/src/VERSION').trim()[6;43H[?25l[?12l[?25hbexam/src/VERSION').trim()[6;44H[?25l[?12l[?25haexam/src/VERSION').trim()[6;45H[?25l[?12l[?25hnexam/src/VERSION').trim()[6;46H[?25l[?12l[?25hoexam/src/VERSION').trim()[6;47H[?25l[?12l[?25hvexam/src/VERSION').trim()[6;48H[?25l[?12l[?25h/exam/src/VERSION').trim()[6;49H[?25l[?12l[?25hcexam/src/VERSION').trim()[6;50H[?25l[?12l[?25hoexam/src/VERSION').trim()[6;51H[?25l[?12l[?25hdexam/src/VERSION').trim()[6;52H[?25l[?12l[?25heexam/src/VERSION').trim()[6;53H[?25l[?12l[?25hbexam/src/VERSION').trim()[6;54H[?25l[?12l[?25hyexam/src/VERSION').trim()[6;55H[?25l[?12l[?25h-exam/src/VERSION').trim()[6;56H[?25l[?12l[?25hdexam/src/VERSION').trim()[6;57H[?25l[?12l[?25heexam/src/VERSION').trim()[6;58H[?25l[?12l[?25hvexam/src/VERSION').trim()[6;59H[?25l[?12l[?25hoexam/src/VERSION').trim()[6;60H[?25l[?12l[?25hpexam/src/VERSION').trim()[6;61H[?25l[?12l[?25hsexam/src/VERSION').trim()[6;62H[?25l[?12l[?25h/exam/src/VERSION').trim()[6;63H[?25l[53d(B[0;7mSave modified buffer?                                                                                                                                                                                       [54;1H Y(B[m Yes[K[55d(B[0;7m N(B[m No  [55;17H(B[0;7m^C(B[m Cancel[K[53;23H[?12l[?25h[?25l[54d(B[0;7m^G(B[m Help[54;52H(B[0;7mM-D(B[m DOS Format[54;103H(B[0;7mM-A(B[m Append[54;154H(B[0;7mM-B(B[m Backup File[55d(B[0;7m^C(B[m Cancel[17G         [55;52H(B[0;7mM-M(B[m Mac Format[55;103H(B[0;7mM-P(B[m Prepend[55;154H(B[0;7m^T(B[m Browse[53d(B[0;7mFile Name to Write: Jenkinsfile(B[m[?12l[?25h[?25l[53;95H[1K (B[0;7m[ Writing... ](B[m[K[1;112H(B[0;7m [203G(B[m[53;94H(B[0;7m[ Wrote 78 lines ](B[m[J[55d[?12l[?25h[55;1H[?1049l[23;0;0t[?1l>[?2004l[?2004h]0;rsshabanov@MSK-01: ~/codeby-devops/exam/src[01;32mrsshabanov@MSK-01[00m:[01;34m~/codeby-devops/exam/src[00m$ sudo nano monitoring_playbook.yml 
[?2004l[?2004h[?1049h[22;0;0t[1;55r(B[m[4l[?7h[39;49m[?1h=[?1h=[?25l[39;49m(B[m[H[2J[53;96H(B[0;7m[ Reading... ](B[m[53;94H(B[0;7m[ Read 157 lines ](B[m[H(B[0;7m  GNU nano 6.2                                                                               monitoring_playbook.yml                                                                                        [1;203H(B[m[54d(B[0;7m^G(B[m Help[54;18H(B[0;7m^O(B[m Write Out     (B[0;7m^W(B[m Where Is[52G(B[0;7m^K(B[m Cut[54;69H(B[0;7m^T(B[m Execute[86G(B[0;7m^C(B[m Location[103G(B[0;7mM-U(B[m Undo[54;120H(B[0;7mM-A(B[m Set Mark     (B[0;7mM-](B[m To Bracket   (B[0;7mM-Q(B[m Previous     (B[0;7m^B(B[m Back[54;188H(B[0;7m^â—‚(B[m Prev Word[55d(B[0;7m^X(B[m Exit[55;18H(B[0;7m^R(B[m Read File     (B[0;7m^\(B[m Replace[52G(B[0;7m^U(B[m Paste[55;69H(B[0;7m^J(B[m Justify[86G(B[0;7m^/(B[m Go To Line    (B[0;7mM-E(B[m Redo[55;120H(B[0;7mM-6(B[m Copy[55;137H(B[0;7m^Q(B[m Where Was     (B[0;7mM-W(B[m Next[55;171H(B[0;7m^F(B[m Forward[188G(B[0;7m^â–¸(B[m Next Word[2d(B[0;1m[33m- (B[0m[92mname[39m: (B[mInstall Monitoring Stack (Prometheus, (B[mLoki, (B[mGrafana, (B[mand Dashboards)[3;3H[92mhosts[39m: (B[mlocalhost[4;3H[92mbecome[39m: [95myes[5;3H[92mvars[39m:[6;5H[92mprometheus_namespace[39m: (B[mmonitoring[7;5H[92mgrafana_admin_user[39m: [95m"admin"[8;5H[92mgrafana_admin_password[39m: [95m"admin"[9;5H[92mgrafana_node_port[39m: [95m32000[10;5H[92mkubeconfig_path[39m: [95m"/home/rsshabanov/codeby-devops/exam/src/kubeconfig-jenkins.yaml"[11;5H[92mgrafana_host_ip[39m: [95m"192.168.49.2"[12;3H[92mtasks[39m:[13d(B[0;1m[33m    - (B[0m[92mname[39m: (B[mCreate namespace for monitoring[14;7H[92mkubernetes.core.k8s[39m:[15;9H[92mkubeconfig[39m: [95m"[33m{{[95m kubeconfig_path [33m}}[95m"[16;9H[92mstate[39m: (B[mpresent[17;9H[92mdefinition[39m:[18;11H[92mapiVersion[39m: (B[mv1[19;11H[92mkind[39m: (B[mNamespace[20;11H[92mmetadata[39m:[21;13H[92mname[39m: [95m"[33m{{[95m prometheus_namespace [33m}}[95m"[23d(B[0;1m[33m    - (B[0m[92mname[39m: (B[mAdd Helm repository for Prometheus[24;7H[92mkubernetes.core.helm_repository[39m:[25;9H[92mname[39m: (B[mprometheus-community[26;9H[92mrepo_url[39m: (B[mhttps://prometheus-community.github.io/helm-charts[27;9H[92mstate[39m: (B[mpresent[29d(B[0;1m[33m    - (B[0m[92mname[39m: (B[mAdd Helm repository for Grafana and Loki[30;7H[92mkubernetes.core.helm_repository[39m:[31;9H[92mname[39m: (B[mgrafana[32;9H[92mrepo_url[39m: (B[mhttps://grafana.github.io/helm-charts[33;9H[92mstate[39m: (B[mpresent[35d(B[0;1m[33m    - (B[0m[92mname[39m: (B[mUpdate Helm repositories[36;7H[92mcommand[39m: (B[mhelm repo update[38d(B[0;1m[33m    - (B[0m[92mname[39m: (B[mInstall Prometheus[39;7H[92mkubernetes.core.helm[39m:[40;9H[92mkubeconfig[39m: [95m"[33m{{[95m kubeconfig_path [33m}}[95m"[41;9H[92mname[39m: (B[mprometheus[42;9H[92mchart_ref[39m: (B[mprometheus-community/prometheus[43;9H[92mrelease_namespace[39m: [95m"[33m{{[95m prometheus_namespace [33m}}[95m"[44;9H[92mcreate_namespace[39m: [95mfalse[46d(B[0;1m[33m    - (B[0m[92mname[39m: (B[mInstall Loki and Promtail[47;7H[92mkubernetes.core.helm[39m:[48;9H[92mkubeconfig[39m: [95m"[33m{{[95m kubeconfig_path [33m}}[95m"[49;9H[92mname[39m: (B[mloki[50;9H[92mchart_ref[39m: (B[mgrafana/loki-stack[51;9H[92mrelease_namespace[39m: [95m"[33m{{[95m prometheus_namespace [33m}}[95m"[52;9H[92mcreate_namespace[39m: [95mfalse[2d[39m(B[m[?12l[?25h[?25l[1;118H(B[0;7m*[203G(B[m[2;53r[53;1H
[1;55r[52;1H[K[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;1H(B[0;1m[33m    - (B[0m[92mname[39m: (B[mInstall Grafana[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;7H[92mkubernetes.core.helm[39m:[2d(B[m[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;9H[92mkubeconfig[39m: [95m"[33m{{[95m kubeconfig_path [33m}}[95m"[2d[39m(B[m[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;9H[92mname[39m: (B[mgrafana[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;9H[92mchart_ref[39m: (B[mgrafana/grafana[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;9H[92mrelease_namespace[39m: [95m"[33m{{[95m prometheus_namespace [33m}}[95m"[2d[39m(B[m[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;9H[92mcreate_namespace[39m: [95mfalse[2d[39m(B[m[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;9H[92mvalues[39m:[2d(B[m[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;11H[92madminPassword[39m: [95m"[33m{{[95m grafana_admin_password [33m}}[95m"[2d[39m(B[m[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;11H[92mservice[39m:[2d(B[m[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;13H[92mtype[39m: (B[mNodePort[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;13H[92mnodePort[39m: [95m"[33m{{[95m grafana_node_port [33m}}[95m"[2d[39m(B[m[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;1H(B[0;1m[33m    - (B[0m[92mname[39m: (B[mWait for Grafana pod to be ready[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;7H[92mretries[39m: [95m10[2d[39m(B[m[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;7H[92mdelay[39m: [95m30[2d[39m(B[m[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;7H[92mkubernetes.core.k8s_info[39m:[2d(B[m[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;9H[92mkubeconfig[39m: [95m"[33m{{[95m kubeconfig_path [33m}}[95m"[2d[39m(B[m[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;9H[92mkind[39m: (B[mPod[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;9H[92mnamespace[39m: [95m"[33m{{[95m prometheus_namespace [33m}}[95m"[2d[39m(B[m[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;9H[92mlabel_selectors[39m:[2d(B[m[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;10H(B[0;1m[33m[1K - [39m(B[mapp.kubernetes.io/name=grafana[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;7H[92mregister[39m: (B[mgrafana_pods[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;7H[92muntil[39m:(B[0;1m[38;5;38m >[2d[39m(B[m[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;9Hgrafana_pods.resources | length > 0 and[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;9Hgrafana_pods.resources[33m[[39m(B[m0[33m][39m(B[m.status.conditions is defined and[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;9Hgrafana_pods.resources[33m[[39m(B[m0[33m][39m(B[m.status.conditions[33m[[39m(B[m0[33m][39m(B[m.status == [95m"True"[2d[39m(B[m[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;1H(B[0;1m[33m    - (B[0m[92mname[39m: (B[mWait for 30 seconds to ensure Grafana service is available[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;7H[92mwait_for[39m:[2d(B[m[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;9H[92mtimeout[39m: [95m30[2d[39m(B[m[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;1H(B[0;1m[33m    - (B[0m[92mname[39m: (B[mGet Grafana session cookies[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;7H[92muri[39m:[2d(B[m[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;9H[92murl[39m: [95m"http://[33m{{[95m grafana_host_ip [33m}}[95m:[33m{{[95m grafana_node_port [33m}}[95m/login"[2d[39m(B[m[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;9H[92mmethod[39m: (B[mPOST[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;9H[92mbody_format[39m: (B[mjson[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;9H[92mheaders[39m:[2d(B[m[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;11H[92mContent-Type[39m: [95m"application/json"[2d[39m(B[m[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;9H[92mbody[39m:(B[0;1m[38;5;38m |[2d[39m(B[m[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;11H[33m{[2d[39m(B[m[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;13H[95m"user"[39m: [95m"[33m{{[95m grafana_admin_user [33m}}[95m"[39m,[2d(B[m[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;13H[95m"password"[39m: [95m"[33m{{[95m grafana_admin_password [33m}}[95m"[2d[39m(B[m[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;11H[33m}[2d[39m(B[m[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;9H[92mstatus_code[39m: [95m200[2d[39m(B[m[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;7H[92mregister[39m: (B[mgrafana_login_response[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;1H(B[0;1m[33m    - (B[0m[92mname[39m: (B[mAdd Prometheus as Grafana data source[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;7H[92muri[39m:[2d(B[m[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;9H[92murl[39m: [95m"http://[33m{{[95m grafana_host_ip [33m}}[95m:[33m{{[95m grafana_node_port [33m}}[95m/api/datasources"[2d[39m(B[m[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;9H[92mmethod[39m: (B[mPOST[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;9H[92mheaders[39m:[2d(B[m[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;11H[92mContent-Type[39m: [95m"application/json"[2d[39m(B[m[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;11H[92mCookie[39m: [95m"[33m{{[95m grafana_login_response.set_cookie [33m}}[95m"[2d[39m(B[m[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;9H[92mbody_format[39m: (B[mjson[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;9H[92mbody[39m:(B[0;1m[38;5;38m |[2d[39m(B[m[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;11H[33m{[2d[39m(B[m[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;13H[95m"name"[39m: [95m"Prometheus"[39m,[2d(B[m[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;13H[95m"type"[39m: [95m"prometheus"[39m,[2d(B[m[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;13H[95m"access"[39m: [95m"proxy"[39m,[2d(B[m[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;13H[95m"url"[39m: [95m"http://prometheus-server.[33m{{[95m prometheus_namespace [33m}}[95m.svc.cluster.local:80"[39m,[2d(B[m[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;13H[95m"isDefault"[39m: [95mtrue[2d[39m(B[m[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;11H[33m}[2d[39m(B[m[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;9H[92mstatus_code[39m: [95m200[2d[39m(B[m[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;1H(B[0;1m[33m    - (B[0m[92mname[39m: (B[mAdd Loki as Grafana data source[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;7H[92muri[39m:[2d(B[m[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;9H[92murl[39m: [95m"http://[33m{{[95m grafana_host_ip [33m}}[95m:[33m{{[95m grafana_node_port [33m}}[95m/api/datasources"[2d[39m(B[m[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;9H[92mmethod[39m: (B[mPOST[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;9H[92mheaders[39m:[2d(B[m[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;11H[92mContent-Type[39m: [95m"application/json"[2d[39m(B[m[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;11H[92mCookie[39m: [95m"[33m{{[95m grafana_login_response.set_cookie [33m}}[95m"[2d[39m(B[m[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;9H[92mbody_format[39m: (B[mjson[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;9H[92mbody[39m:(B[0;1m[38;5;38m |[2d[39m(B[m[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;11H[33m{[2d[39m(B[m[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;13H[95m"name"[39m: [95m"Loki"[39m,[2d(B[m[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;13H[95m"type"[39m: [95m"loki"[39m,[2d(B[m[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;13H[95m"access"[39m: [95m"proxy"[39m,[2d(B[m[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;13H[95m"url"[39m: [95m"http://loki.[33m{{[95m prometheus_namespace [33m}}[95m.svc.cluster.local:3100"[2d[39m(B[m[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;11H[33m}[2d[39m(B[m[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;9H[92mstatus_code[39m: [95m200[2d[39m(B[m[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;1H(B[0;1m[33m    - (B[0m[92mname[39m: (B[mAdd Grafana dashboard for logs and state monitoring[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;7H[92muri[39m:[2d(B[m[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;9H[92murl[39m: [95m"http://[33m{{[95m grafana_host_ip [33m}}[95m:[33m{{[95m grafana_node_port [33m}}[95m/api/dashboards/db"[2d[39m(B[m[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;9H[92mmethod[39m: (B[mPOST[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;9H[92mheaders[39m:[2d(B[m[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;11H[92mContent-Type[39m: [95m"application/json"[2d[39m(B[m[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;11H[92mCookie[39m: [95m"[33m{{[95m grafana_login_response.set_cookie [33m}}[95m"[2d[39m(B[m[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;9H[92mbody_format[39m: (B[mjson[2d[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;9H[92mbody[39m:(B[0;1m[38;5;38m |[2d[39m(B[m[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;11H[33m{[2d[39m(B[m[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;13H[95m"dashboard"[39m: [33m{[2d[39m(B[m[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;15H[95m"id"[39m: (B[mnull,[2d(B[m[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;15H[95m"uid"[39m: [95m"loki-logs"[39m,[2d(B[m[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;15H[95m"title"[39m: [95m"Loki Logs & Application State"[39m,[2d(B[m[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;15H[95m"tags"[39m: [33m[[95m"logs"[39m, [95m"loki"[39m, [95m"prometheus"[33m][39m,[2d(B[m[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;15H[95m"timezone"[39m: [95m"browser"[39m,[2d(B[m[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;15H[95m"schemaVersion"[39m: (B[m16,[2d(B[m[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;15H[95m"version"[39m: (B[m0,[2d(B[m[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;15H[95m"panels"[39m: [33m[][2d[39m(B[m[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;13H[33m}[39m,[2d(B[m[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;13H[95m"overwrite"[39m: [95mtrue[2d[39m(B[m[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;11H[33m}[2d[39m(B[m[?12l[?25h[?25l[2;53r[53;1H
[1;55r[52;9H[92mstatus_code[39m: [95m200[2d[39m(B[m[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[2;53r[53;1H
[1;55r[2;1H[?12l[?25h[?25l[K[?12l[?25h[?25l[53;93H(B[0;7m[ Nothing was cut ](B[m[?12l[?25h[2d[?25l[53;112H[?12l[?25h[2d[?25l[53;112H[?12l[?25h[2d[?25l[53;112H[?12l[?25h[2d[?25l[53;112H[?12l[?25h[2d[?25l[53;112H[?12l[?25h[2d[?25l[53;112H[?12l[?25h[2d[?25l[53;112H[?12l[?25h[2d[?25l[53;112H[?12l[?25h[2d[?25l[53;112H[?12l[?25h[2d[?25l[53;112H[?12l[?25h[2d[?25l[53;112H[?12l[?25h[2d[?25l[53;112H[?12l[?25h[2d[?25l[53;112H[?12l[?25h[2d[?25l[53;112H[?12l[?25h[2d[?25l[2;9H[92mstatus_code[39m: [95m200[4d(B[0;1m[33m    - (B[0m[92mname[39m: (B[mAdd Grafana dashboard for logs and state monitoring via API[5;7H[92muri[39m:[6d[92murl[39m: [95m"http://[33m{{[95m grafana_host_ip [33m}}[95m:[33m{{[95m grafana_node_port [33m}}[95m/api/dashboards/db"[7;9H[92mmethod[39m: (B[mPOST[8;9H[92mheaders[39m:[9;11H[92mContent-Type[39m: [95m"application/json"[10;11H[92mCookie[39m: [95m"[33m{{[95m grafana_login_response.set_cookie [33m}}[95m"[11;9H[92mbody_format[39m: (B[mjson[12;9H[92mbody[39m:(B[0;1m[38;5;38m |[13;11H(B[0m[33m{[14;13H[95m"dashboard"[39m: [33m{[15;15H[95m"id"[39m: (B[mnull,[16;15H[95m"uid"[39m: [95m"loki-logs"[39m,[17;15H[95m"title"[39m: [95m"Loki Logs & Application State"[39m,[18;15H[95m"tags"[39m: [33m[[95m"logs"[39m, [95m"loki"[39m, [95m"prometheus"[33m][39m,[19;15H[95m"timezone"[39m: [95m"browser"[39m,[20;15H[95m"schemaVersion"[39m: (B[m16,[21;15H[95m"version"[39m: (B[m0,[22;15H[95m"panels"[39m: [33m[][23;13H}[39m,[24d[95m"overwrite"[39m: [95mtrue[25;11H[33m}[26;9H[92mstatus_code[39m: [95m200[53d[39m(B[m[K[27d[?12l[?25h[?25l[?12l[?25h[4d[?25l[2;9H  [33m{[39m(B[m[K[3d [95m"user"[39m: [95m"[33m{{[95m grafana_admin_user [33m}}[95m"[39m,[4;12H(B[m[1K [95m"password"[39m: [95m"[33m{{[95m grafana_admin_password [33m}}[95m"[39m(B[m[K[5;7H    [33m}[6;9H[92mstatus_code[39m: [95m200[39m(B[m[K[7;7H[92mregister[39m: (B[mgrafana_login_response[8d[K[9d(B[0;1m[33m    - (B[0m[92mname[39m: (B[mAdd or Update Prometheus as Grafana data source[10;7H[92muri[39m:(B[m[K[11d[92murl[39m: [95m"http://[33m{{[95m grafana_host_ip [33m}}[95m:[33m{{[95m grafana_node_port [33m}}[95m/api/datasources/name/Prometheus"[12;9H[92mmethod[39m: (B[mPUT[13;9H[92mheaders[39m:[14;11H[92mContent-Type[39m: [95m"application/json"[15;11H[92mCookie[39m: [95m"[33m{{[95m grafana_login_response.set_cookie [33m}}[95m"[16;9H[92mbody_format[39m: (B[mjson[K[17;9H[92mbody[39m:(B[0;1m[38;5;38m |[39m(B[m[K[18;11H[33m{[39m(B[m[K[19d [95m"name"[39m: [95m"Prometheus"[39m,(B[m[K[20;13H[95m"type"[39m: [95m"prometheus"[39m,(B[m[K[21;13H[95m"access"[39m: [95m"proxy"[39m,[22;13H[95m"url"[39m: [95m"http://prometheus-server.[33m{{[95m prometheus_namespace [33m}}[95m.svc.cluster.local:80"[39m,[23;13H[95m"isDefault"[39m: [95mtrue[24;11H[33m}[39m(B[m[K[25;9H[92mstatus_code[39m: [95m200[26d[39m(B[m[K[27d(B[0;1m[33m    - (B[0m[92mname[39m: (B[mAdd Loki as Grafana data source via Grafana API[28;7H[92muri[39m:[29d[92murl[39m: [95m"http://[33m{{[95m grafana_host_ip [33m}}[95m:[33m{{[95m grafana_node_port [33m}}[95m/api/datasources/name/Loki"[30;9H[92mmethod[39m: (B[mPUT[31;9H[92mheaders[39m:[32;11H[92mContent-Type[39m: [95m"application/json"[33;11H[92mCookie[39m: [95m"[33m{{[95m grafana_login_response.set_cookie [33m}}[95m"[34;9H[92mbody_format[39m: (B[mjson[35;9H[92mbody[39m:(B[0;1m[38;5;38m |[36;11H(B[0m[33m{[37;13H[95m"name"[39m: [95m"Loki"[39m,[38;13H[95m"type"[39m: [95m"loki"[39m,[39;13H[95m"access"[39m: [95m"proxy"[39m,[40;13H[95m"url"[39m: [95m"http://loki.[33m{{[95m prometheus_namespace [33m}}[95m.svc.cluster.local:3100"[41;11H[33m}[42;9H[92mstatus_code[39m: [95m200[44d(B[0;1m[33m    - (B[0m[92mname[39m: (B[mAdd Grafana dashboard for logs and state monitoring via API[45;7H[92muri[39m:[46d[92murl[39m: [95m"http://[33m{{[95m grafana_host_ip [33m}}[95m:[33m{{[95m grafana_node_port [33m}}[95m/api/dashboards/db"[47;9H[92mmethod[39m: (B[mPOST[48;9H[92mheaders[39m:[49;11H[92mContent-Type[39m: [95m"application/json"[50;11H[92mCookie[39m: [95m"[33m{{[95m grafana_login_response.set_cookie [33m}}[95m"[51;9H[92mbody_format[39m: (B[mjson[52;9H[92mbody[39m:(B[0;1m[38;5;38m |[27d[39m(B[m[?12l[?25h[?25l[?12l[?25h[9d[?25l[2;9H[92mvalues[39m:[3;11H[92madminPassword[39m: [95m"[33m{{[95m grafana_admin_password [33m}}[95m"[4;11H[92mservice[39m:(B[m[K[5;11H  [92mtype[39m: (B[mNodePort[6;9H    [92mnodePort[39m: [95m"[33m{{[95m grafana_node_port [33m}}[95m"[7d[39m(B[m[K[8d(B[0;1m[33m    - (B[0m[92mname[39m: (B[mWait for Grafana pod to be ready[9;6H[1K [92mretries[39m: [95m10[39m(B[m[K[10;7H[92mdelay[39m: [95m30[11;7H[92mkubernetes.core.k8s_info[39m:(B[m[K[12;9H[92mkubeconfig[39m: [95m"[33m{{[95m kubeconfig_path [33m}}[95m"[13;9H[92mkind[39m: (B[mPod[14;9H[92mnamespace[39m: [95m"[33m{{[95m prometheus_namespace [33m}}[95m"[15;9H[92mlabel_selectors[39m:(B[m[K[16;10H(B[0;1m[33m[1K - [39m(B[mapp.kubernetes.io/name=grafana[17;7H[92mregister[39m: (B[mgrafana_pods[18;7H[92muntil[39m:(B[0;1m[38;5;38m >[19;9H[39m(B[mgrafana_pods.resources | length > 0 and[20;9Hgrafana_pods.resources[33m[[39m(B[m0[33m][39m(B[m.status.conditions is defined and[21;9Hgrafana_pods.resources[33m[[39m(B[m0[33m][39m(B[m.status.conditions[33m[[39m(B[m0[33m][39m(B[m.status == [95m"True"[22d[39m(B[m[K[23d(B[0;1m[33m    - (B[0m[92mname[39m: (B[mWait for 30 seconds to ensure Grafana service is available[24;7H[92mwait_for[39m:[25;9H[92mtimeout[39m: [95m30[39m(B[m[K[27;13HGet Grafana session cookies for authentication[K[29;68H[95mlogin"[39m(B[m[K[30;18HOST[31;9H[92mbody_format[39m: (B[mjson[32;9H[92mheaders[39m:(B[m[K[33;13H[92mntent-Type[39m: [95m"application/json"[39m(B[m[K[34;13H:(B[0;1m[38;5;38m |[39m(B[m[K[35;9H  [33m{[39m(B[m[K[36d  [95m"user"[39m: [95m"[33m{{[95m grafana_admin_user [33m}}[95m"[39m,[37;14H[95mpassword"[39m: [95m"[33m{{[95m grafana_admin_password [33m}}[95m"[38;11H[33m}[39m(B[m[K[39;9H[92mstatus_code[39m: [95m200[39m(B[m[K[40;7H[92mregister[39m: (B[mgrafana_login_response[K[41d[K[42d(B[0;1m[33m    - (B[0m[92mname[39m: (B[mAdd or Update Prometheus as Grafana data source[43;7H[92muri[39m:[44;8H(B[m[1K [92murl[39m: [95m"http://[33m{{[95m grafana_host_ip [33m}}[95m:[33m{{[95m grafana_node_port [33m}}[95m/api/datasources/name/Prometheus"[45;7H[39m(B[m  [92mmethod[39m: (B[mPUT[46;9H[92mheaders[39m:(B[m[K[47;9H  [92mContent-Type[39m: [95m"application/json"[48;9H[39m(B[m  [92mCookie[39m: [95m"[33m{{[95m grafana_login_response.set_cookie [33m}}[95m"[49;9H[92mbody_format[39m: (B[mjson[K[50;9H[92mbody[39m:(B[0;1m[38;5;38m |[39m(B[m[K[51;9H  [33m{[39m(B[m[K[52;9H    [95m"name"[39m: [95m"Prometheus"[39m,[27d(B[m[?12l[?25h[?25l[?12l[?25h[23d[?25l[?12l[?25h[8d[?25l[2;9H[92mcreate_namespace[39m: [95mfalse[3;9H[92mvalues[39m:(B[m[K[4d[92mer[39m:(B[m[K[5;13H[92mglobal[39m:(B[m[K[6;13H  [92mscrape_interval[39m: (B[m15s[K[7;13H[92mscrape_configs[39m:[8;14H(B[0;1m[33m[1K - (B[0m[92mjob_name[39m: [95m'kubernetes-pods'[39m(B[m[K[9;16H[1K [92mkubernetes_sd_configs[39m:[10;18H(B[0;1m[33m[1K - (B[0m[92mrole[39m: (B[mpod[11;16H[1K [92mrelabel_configs[39m:[12;18H(B[0;1m[33m[1K - (B[0m[92msource_labels[39m: [33m[[39m(B[m__meta_kubernetes_pod_label_app[33m][13;20H[39m(B[m[1K [92maction[39m: (B[mkeep[14;20H[1K [92mregex[39m: (B[mpetclinic-app[K[15;14H(B[0;1m[33m[1K - (B[0m[92mjob_name[39m: [95m'kubernetes-nodes'[16;16H[39m(B[m[1K [92mkubernetes_sd_configs[39m:(B[m[K[17;18H(B[0;1m[33m[1K - (B[0m[92mrole[39m: (B[mnode[18d[K[19d(B[0;1m[33m    - (B[0m[92mname[39m: (B[mInstall Loki and Promtail for collecting logs[20;7H[92mkubernetes.core.helm[39m:(B[m[K[21;9H[92mkubeconfig[39m: [95m"[33m{{[95m kubeconfig_path [33m}}[95m"[39m(B[m[K[22;9H[92mname[39m: (B[mloki[23;8H[1K [92mchart_ref[39m: (B[mgrafana/loki-stack[K[24;7H  [92mrelease_namespace[39m: [95m"[33m{{[95m prometheus_namespace [33m}}[95m"[25;9H[92mcreate_namespace[39m: [95mfalse[27;13H[39m(B[mInstall Grafana[K[28;7H[92mkubernetes.core.helm[39m:[29;9H[92mkubeconfig[39m: [95m"[33m{{[95m kubeconfig_path[43G"[39m(B[m[K[30;9H[92mname[39m: (B[mgrafana[31;9H[92mchart_ref[39m: (B[mgrafana/grafana[32;9H[92mrelease_namespace[39m: [95m"[33m{{[95m prometheus_namespace [33m}}[95m"[33;9H[92mcreate_namespace[39m: [95mfalse[39m(B[m[K[34;9H[92mvalues[39m:[35;11H[92madminPassword[39m: [95m"[33m{{[95m grafana_admin_password [33m}}[95m"[36;11H[92mservice[39m:(B[m[K[37;13H[92mtype[39m: (B[mNodePort[K[38;11H  [92mnodePort[39m: [95m"[33m{{[95m grafana_node_port [33m}}[95m"[39d[39m(B[m[K[40d(B[0;1m[33m    - (B[0m[92mname[39m: (B[mWait for Grafana pod to be ready[41;7H[92mretries[39m: [95m10[42;6H[39m(B[m[1K [92mdelay[39m: [95m30[39m(B[m[K[43;7H[92mkubernetes.core.k8s_info[39m:[44;9H[92mkubeconfig[39m: [95m"[33m{{[95m kubeconfig_path[43G"[39m(B[m[K[45;9H[92mkind[39m: (B[mPod[K[46;9H[92mnamespace[39m: [95m"[33m{{[95m prometheus_namespace [33m}}[95m"[47;9H[92mlabel_selectors[39m:(B[m[K[48;10H(B[0;1m[33m[1K - [39m(B[mapp.kubernetes.io/name=grafana[K[49;7H[92mregister[39m: (B[mgrafana_pods[50;7H[92muntil[39m:(B[0;1m[38;5;38m >[39m(B[m[K[51;9Hgrafana_pods.resources | length > 0 and[52;9Hgrafana_pods.resources[33m[[39m(B[m0[33m][39m(B[m.status.conditions is defined and[27d[?12l[?25h[?25l[?12l[?25h[19d[?25l[2d(B[0;1m[33m    - (B[0m[92mname[39m: (B[mCreate namespace for monitoring[3;7H[92mkubernetes.core.k8s[39m:[4;9H[92mkubeconfig[39m: [95m"[33m{{[95m kubeconfig_path [33m}}[95m"[5;9H[92mstate[39m: (B[mpresent[6;9H[92mdefinition[39m:(B[m[K[7;11H[92mapiVersion[39m: (B[mv1[K[8;10H[1K [92mkind[39m: (B[mNamespace[K[9;11H[92mmetadata[39m:(B[m[K[10;12H[1K [92mname[39m: [95m"[33m{{[95m prometheus_namespace [33m}}[95m"[11d[39m(B[m[K[12;5H(B[0;1m[33m- (B[0m[92mname[39m: (B[mAdd Helm repository for Prometheus[K[13;7H[92mkubernetes.core.helm_repository[39m:[14;9H[92mname[39m: (B[mprometheus-community[K[15;8H[1K [92mrepo_url[39m: (B[mhttps://prometheus-community.github.io/helm-charts[16;9H[92mstate[39m: (B[mpresent[K[17d[K[18d(B[0;1m[33m    - (B[0m[92mname[39m: (B[mAdd Helm repository for Grafana and Loki[19;6H[1K [92mkubernetes.core.helm_repository[39m:(B[m[K[20;7H  [92mname[39m: (B[mgrafana[K[21;9H[92mrepo_url[39m: (B[mhttps://grafana.github.io/helm-charts[22;9H[92mstate[39m: (B[mpresent[23d[K[24d(B[0;1m[33m    - (B[0m[92mname[39m: (B[mUpdate Helm repositories[K[25;7H[92mcommand[39m: (B[mhelm repo update[27;21HPrometheus for monitoring pods and nodes[30;15Hprometheus[31;20Hprometheus-community/prometheus[35;11H[92mserver[39m:(B[m[K[36;11H  [92mglobal[39m:[37;13H(B[m  [92mscrape_interval[39m: (B[m15s[38;13H[92mscrape_configs[39m:(B[m[K[39;14H(B[0;1m[33m[1K - (B[0m[92mjob_name[39m: [95m'kubernetes-pods'[40;16H[39m(B[m[1K [92mkubernetes_sd_configs[39m:(B[m[K[41;18H(B[0;1m[33m[1K - (B[0m[92mrole[39m: (B[mpod[42;16H[1K [92mrelabel_configs[39m:[43;18H(B[0;1m[33m[1K - (B[0m[92msource_labels[39m: [33m[[39m(B[m__meta_kubernetes_pod_label_app[33m][44;20H[39m(B[m[1K [92maction[39m: (B[mkeep[K[45;20H[1K [92mregex[39m: (B[mpetclinic-app[46;14H(B[0;1m[33m[1K - (B[0m[92mjob_name[39m: [95m'kubernetes-nodes'[39m(B[m[K[47;16H[1K [92mkubernetes_sd_configs[39m:[48;18H(B[0;1m[33m[1K - (B[0m[92mrole[39m: (B[mnode[K[49d[K[50d(B[0;1m[33m    - (B[0m[92mname[39m: (B[mInstall Loki and Promtail for collecting logs[51;7H[92mkubernetes.core.helm[39m:(B[m[K[52;9H[92mkubeconfig[39m: [95m"[33m{{[95m kubeconfig_path [33m}}[95m"[39m(B[m[K[27d[?12l[?25h[?25l[?12l[?25h[24d[?25l[?12l[?25h[18d[?25l[?12l[?25h[12d[?25l[2;52r[2;1H[13T[1;55r[2;1H(B[0;1m[38;5;38m---[3d[33m- (B[0m[92mname[39m: (B[mInstall Monitoring Stack (Prometheus, (B[mLoki, (B[mGrafana, (B[mand Dashboards)[4;3H[92mhosts[39m: (B[mlocalhost[5;3H[92mbecome[39m: [95myes[6;3H[92mvars[39m:[7;5H[92mprometheus_namespace[39m: (B[mmonitoring[8;5H[92mgrafana_admin_user[39m: [95m"admin"[39m(B[m  (B[0m[3m[36m # Ð›Ð¾Ð³Ð¸Ð½ Ð´Ð»Ñ Grafana[9;5H(B[0m[23m[92mgrafana_admin_password[39m: [95m"admin"[39m(B[m (B[0m[3m[36m # ÐŸÐ°Ñ€Ð¾Ð»ÑŒ Ð´Ð»Ñ Grafana[10;5H(B[0m[23m[92mgrafana_node_port[39m: [95m32000[11;5H[92mkubeconfig_path[39m: [95m"/home/rsshabanov/codeby-devops/exam/src/kubeconfig-jenkins.yaml"[12;5H[92mgrafana_host_ip[39m: [95m"192.168.49.2"[39m(B[m (B[0m[3m[36m # IP Minikube[14;3H(B[0m[23m[92mtasks[39m:(B[m[?12l[?25h[?25l[?12l[?25h[2d[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[53d(B[0;7mSave modified buffer?                                                                                                                                                                                       [54;1H Y(B[m Yes[K[55d(B[0;7m N(B[m No  [55;17H(B[0;7m^C(B[m Cancel[K[53;23H[?